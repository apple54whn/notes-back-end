---
title: 2 Object Orientation-5 èŒƒå‹
date: 2020-12-14 23:04:17
permalink: /pages/7aa44d/
categories:
  - Java
  - Core
tags:
  -
---

# Generic èŒƒå‹

## ä¸ºä»€ä¹ˆè¦æœ‰æ³›å‹

- æ³›å‹ï¼šç±»ä¼¼æ ‡ç­¾ã€‚ä¾‹å¦‚ï¼šä¸­è¯åº—ï¼Œæ¯ä¸ªæŠ½å±‰å¤–é¢è´´ç€æ ‡ç­¾ï¼›åƒåœ¾åˆ†ç±»ï¼

- æ³›å‹çš„**è®¾è®¡èƒŒæ™¯**ï¼š

  é›†åˆå®¹å™¨ç±»åœ¨è®¾è®¡é˜¶æ®µã€å£°æ˜é˜¶æ®µä¸èƒ½ç¡®å®šè¿™ä¸ªå®¹å™¨åˆ°åº•å®é™…å­˜çš„æ˜¯ä»€ä¹ˆç±»å‹çš„å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨ JDK1.5 ä¹‹å‰åªèƒ½æŠŠå…ƒç´ ç±»å‹è®¾è®¡ä¸º`Object`ï¼ŒJDK1.5 ä¹‹åä½¿ç”¨æ³›å‹æ¥è§£å†³ã€‚å› ä¸ºè¿™ä¸ªæ—¶å€™é™¤äº†å…ƒç´ çš„ç±»å‹ä¸ç¡®å®šï¼Œå…¶ä»–çš„éƒ¨åˆ†æ˜¯ç¡®å®šçš„ï¼Œä¾‹å¦‚å…³äºè¿™ä¸ªå…ƒç´ å¦‚ä½•ä¿å­˜ï¼Œå¦‚ä½•ç®¡ç†ç­‰æ˜¯ç¡®å®šçš„ï¼Œå› æ­¤æ­¤æ—¶æŠŠ**å…ƒç´ çš„ç±»å‹è®¾è®¡æˆä¸€ä¸ªå‚æ•°**ï¼Œè¿™ä¸ª**ç±»å‹å‚æ•°å«åšæ³›å‹**ã€‚ `Collection<E>`ï¼Œ`List<E>`ï¼Œ`ArrayList<E>` è¿™ä¸ª`<E>`å°±æ˜¯ç±»å‹å‚æ•°ï¼Œå³æ³›å‹ã€‚

- æ³›å‹çš„æ¦‚å¿µï¼šæ‰€è°“æ³›å‹ï¼Œå°±æ˜¯å…è®¸åœ¨**å®šä¹‰ç±»ã€æ¥å£æ—¶é€šè¿‡ä¸€ä¸ªæ ‡è¯†è¡¨ç¤ºç±»ä¸­æŸä¸ªå±æ€§çš„ç±»å‹æˆ–è€…æ˜¯æŸä¸ªæ–¹æ³•çš„è¿”å›å€¼åŠå‚æ•°ç±»å‹**ã€‚è¿™ä¸ªç±»å‹å‚æ•°å°†åœ¨**ä½¿ç”¨æ—¶**ï¼ˆä¾‹å¦‚ï¼Œ ç»§æ‰¿æˆ–å®ç°è¿™ä¸ªæ¥å£ï¼Œç”¨è¿™ä¸ªç±»å‹å£°æ˜å˜é‡ã€åˆ›å»ºå¯¹è±¡æ—¶ï¼‰**ç¡®å®š**ï¼ˆå³ä¼ å…¥å®é™…çš„ç±»å‹å‚æ•°ï¼Œä¹Ÿç§°ä¸ºç±»å‹å®å‚ï¼‰ã€‚

  ä» JDK1.5 ä»¥åï¼ŒJava å¼•å…¥äº†â€œå‚æ•°åŒ–ç±»å‹(Parameterized type)â€çš„æ¦‚å¿µï¼Œ å…è®¸æˆ‘ä»¬åœ¨åˆ›å»ºé›†åˆæ—¶å†æŒ‡å®šé›†åˆå…ƒç´ çš„ç±»å‹ï¼Œæ­£å¦‚ï¼š`List<String>`ï¼Œè¿™è¡¨æ˜è¯¥`List`åªèƒ½ä¿å­˜å­—ç¬¦ä¸²ç±»å‹çš„å¯¹è±¡ã€‚JDK1.5 æ”¹å†™äº†é›†åˆæ¡†æ¶ä¸­çš„å…¨éƒ¨æ¥å£å’Œç±»ï¼Œä¸ºè¿™äº›æ¥å£ã€ç±»å¢åŠ äº†æ³›å‹æ”¯æŒï¼Œ ä»è€Œå¯ä»¥åœ¨å£°æ˜é›†åˆå˜é‡ã€åˆ›å»ºé›†åˆå¯¹è±¡æ—¶ä¼ å…¥ç±»å‹å®å‚ã€‚

- é‚£ä¹ˆä¸ºä»€ä¹ˆè¦æœ‰æ³›å‹ï¼Ÿæ³›å‹çš„å¥½å¤„ï¼Ÿ

  - è§£å†³å…ƒç´ **å­˜å‚¨**çš„**ç±»å‹ä¸å®‰å…¨**é—®é¢˜ï¼Œå¥½æ¯”å•†å“ã€è¯å“æ ‡ç­¾ï¼Œä¸ä¼šå¼„é”™ã€‚åœ¨è®¾è®¡ API æ—¶å¯ä»¥æŒ‡å®šç±»æˆ–æ–¹æ³•æ”¯æŒæ³›å‹ï¼Œè¿™æ ·ä½¿ç”¨ API çš„æ—¶å€™ä¹Ÿå˜å¾—æ›´ä¸ºç®€æ´ï¼Œå¹¶å¾—åˆ°äº†**ç¼–è¯‘æ—¶æœŸçš„è¯­æ³•æ£€æŸ¥**ã€‚
  - è§£å†³**è·å–**æ•°æ®å…ƒç´ æ—¶ï¼Œéœ€è¦**ç±»å‹å¼ºåˆ¶è½¬æ¢**çš„é—®é¢˜ï¼Œæœ‰å¯èƒ½å¼ºè½¬å¼•å‘**è¿è¡Œæ—¶**`ClassCastException`ã€‚ä¸ç”¨æ¯å›æ‹¿å•†å“ã€è¯å“éƒ½è¦è¾¨åˆ«ã€‚

> TIPSï¼šæ³›å‹æ˜¯æ•°æ®ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ç±»åä¸æ³›å‹åˆå¹¶ä¸€èµ·çœ‹åšæ•°æ®ç±»å‹ã€‚

## é›†åˆä¸­ä½¿ç”¨æ³›å‹

ç•¥ ğŸ‘»

## è‡ªå®šä¹‰æ³›å‹ ğŸ”¥

æ³¨æ„ï¼š

- æ³›å‹ç±»å¯èƒ½æœ‰å¤šä¸ªå‚æ•°ï¼Œæ­¤æ—¶åº”å°†å¤šä¸ªå‚æ•°ä¸€èµ·æ”¾åœ¨å°–æ‹¬å·å†…ã€‚æ¯”å¦‚`<E1,E2,E3>`

- `E`æˆ–å…¶ä»–åªèƒ½æ˜¯**ç±»**ï¼Œä¸èƒ½ç”¨åŸºæœ¬æ•°æ®ç±»å‹å¡«å……ï¼Œä½†å¯ä»¥ä½¿ç”¨**åŒ…è£…ç±»**å¡«å……ã€‚

- æ„é€ å™¨ä¸ç”¨å¸¦`E`æˆ–å…¶ä»–

- **æ³›å‹ä¸åŒçš„å¼•ç”¨ä¸èƒ½ç›¸äº’èµ‹å€¼**

- åœ¨ç±»/æ¥å£ä¸Šå£°æ˜çš„æ³›å‹ï¼Œåœ¨æœ¬ç±»æˆ–æœ¬æ¥å£ä¸­å³ä»£è¡¨æŸç§ç±»å‹ï¼Œå¯ä»¥ä½œä¸º**éé™æ€å±æ€§çš„ç±»å‹ã€éé™æ€æ–¹æ³•çš„å‚æ•°ç±»å‹ã€éé™æ€æ–¹æ³•çš„è¿”å›å€¼ç±»å‹**ã€‚ä½†**åœ¨é™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨ç±»ï¼ˆä½¿ç”¨ç±»ï¼ï¼‰çš„æ³›å‹**ã€‚å› ä¸ºç±»æ³›å‹æ˜¯åœ¨åˆ›å»ºå¯¹è±¡æ—¶ç¡®å®šï¼Œæ™šäº static

- å¼‚å¸¸ç±»ä¸èƒ½æ˜¯æ³›å‹çš„ï¼›ä¸èƒ½åœ¨ try-catch ä¸­ä½¿ç”¨æ³›å‹å®šä¹‰

- ä¸èƒ½ä½¿ç”¨`new E[]`ã€‚ä½†æ˜¯å¯ä»¥`E[] elements = (E[])new Object[capacity]`ï¼Œå‚è€ƒ`ArrayList`æºç ä¸­å£°æ˜`Object[] elementData`ï¼Œè€Œéæ³›å‹å‚æ•°ç±»å‹æ•°ç»„

- **çˆ¶ç±»æœ‰æ³›å‹ï¼Œå­ç±»å¯ä»¥é€‰æ‹©ä¿ç•™æ³›å‹ä¹Ÿå¯ä»¥é€‰æ‹©æŒ‡å®šæ³›å‹ç±»å‹**

  - å­ç±»ä¸ä¿ç•™çˆ¶ç±»çš„æ³›å‹ï¼šæŒ‰éœ€å®ç°
    - æ²¡æœ‰ç±»å‹æ“¦é™¤
    - å…·ä½“ç±»å‹
  - å­ç±»ä¿ç•™çˆ¶ç±»çš„æ³›å‹ï¼šæ³›å‹å­ç±»
    - å…¨éƒ¨ä¿ç•™
    - éƒ¨åˆ†ä¿ç•™

  ç»“è®ºï¼šå­ç±»å¿…é¡»æ˜¯â€œå¯ŒäºŒä»£â€ï¼Œ**å­ç±»é™¤äº†æŒ‡å®šæˆ–ä¿ç•™çˆ¶ç±»çš„æ³›å‹ï¼Œè¿˜å¯ä»¥å¢åŠ è‡ªå·±çš„æ³›å‹**

  ```java
  class Father<T1, T2> {}

  // å­ç±»ä¸ä¿ç•™çˆ¶ç±»çš„æ³›å‹
  // 1)æ²¡æœ‰ç±»å‹ æ“¦é™¤
  class Son1 extends Father {/*ç­‰ä»·äºclass Son extends Father<Object,Object>{}*/}
  // 2)å…·ä½“ç±»å‹
  class Son2 extends Father<Integer, String> { }

  // å­ç±»ä¿ç•™çˆ¶ç±»çš„æ³›å‹
  // 1)å…¨éƒ¨ä¿ç•™
  class Son3<T1, T2> extends Father<T1, T2> { }
  // 2)éƒ¨åˆ†ä¿ç•™
  class Son4<T2> extends Father<Integer, T2> { }
  ```

  ```java
  class Father<T1, T2> {}
  // å­ç±»ä¸ä¿ç•™çˆ¶ç±»çš„æ³›å‹
  // 1)æ²¡æœ‰ç±»å‹ æ“¦é™¤
  class Son<A, B> extends Father{/*ç­‰ä»·äºclass Son extends Father<Object,Object>{ }*/}
  // 2)å…·ä½“ç±»å‹
  class Son2<A, B> extends Father<Integer, String> { }

  // å­ç±»ä¿ç•™çˆ¶ç±»çš„æ³›å‹
  // 1)å…¨éƒ¨ä¿ç•™
  class Son3<T1, T2, A, B> extends Father<T1, T2> { }
  // 2)éƒ¨åˆ†ä¿ç•™
  class Son4<T2, A, B> extends Father<Integer, T2> { }
  ```

### è‡ªå®šä¹‰æ³›å‹ç±»

- åœ¨**åˆ›å»ºå¯¹è±¡æ—¶**å°±ç¡®å®šæ³›å‹çš„ç±»å‹ã€‚

```java
public class MyGenericClass<E> {//æ²¡æœ‰Eç±»å‹ï¼Œåœ¨è¿™é‡Œä»£è¡¨ æœªçŸ¥çš„ä¸€ç§æ•°æ®ç±»å‹ æœªæ¥ä¼ é€’ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆç±»å‹
    private E e;

    public MyGenericClass() {
    }

    public MyGenericClass(E e) {
        this.e = e;
    }

    public void setE(E e) {
        this.e = e;
    }

    public E getE() {
        return e;
    }
}
```

```java
MyGenericClass<String> my = new MyGenericClass<>(); //åˆ›å»ºå¯¹è±¡æ—¶å°±ç¡®å®šæ³›å‹çš„ç±»å‹
```

### è‡ªå®šä¹‰æ³›å‹æ¥å£

- **å®ç°æ¥å£æ—¶**ç¡®å®šæ³›å‹çš„ç±»å‹ï¼›
- å§‹ç»ˆä¸ç¡®å®šæ³›å‹ï¼Œç›´åˆ°**åˆ›å»ºå¯¹è±¡æ—¶**ç¡®å®šæ³›å‹çš„ç±»å‹

```java
public interface MyGenericInterface<E>{

  public abstract void add(E e);

	public abstract E getE();
}
```

```java
public class MyImp1 implements MyGenericInterface<String> { //å®ç°æ¥å£æ—¶ç¡®å®šæ³›å‹çš„ç±»å‹
    @Override
    public void add(String e) { /*çœç•¥...*/ }

    @Override
    public String getE() { /*çœç•¥...*/ }
}
```

```java
public class MyImp2<E> implements MyGenericInterface<E> { //å§‹ç»ˆä¸ç¡®å®šæ³›å‹
    @Override
    public void add(E e) { /*çœç•¥...*/ }

	@Override
    public E getE() { /*çœç•¥...*/ }
}
MyImp2<String>  my = new MyImp2<>();  //ç›´åˆ°åˆ›å»ºå¯¹è±¡æ—¶ç¡®å®šæ³›å‹çš„ç±»å‹
my.add("aa");
```

### è‡ªå®šä¹‰æ³›å‹æ–¹æ³• ğŸ”¥

- æ–¹æ³•å¯ä»¥è¢«æ³›å‹åŒ–ï¼Œ**æ— è®ºæ–¹æ³•æ‰€å±çš„ç±»æ˜¯å¦ä¸ºæ³›å‹ç±»**

- åœ¨æ³›å‹æ–¹æ³•ä¸­å¯ä»¥å®šä¹‰æ³›å‹å‚æ•°ï¼Œåœ¨**è°ƒç”¨æ–¹æ³•ä¼ é€’æ•°æ®æ—¶**ç¡®å®šæ³›å‹çš„ç±»å‹
- **æ³›å‹æ–¹æ³•å¯ä»¥å£°æ˜ä¸ºé™æ€çš„ï¼ˆä¸åŒäºä½¿ç”¨ç±»çš„æ³›å‹ï¼‰**ã€‚åŸå› ï¼šæ³›å‹å‚æ•°æ˜¯åœ¨è°ƒç”¨æ–¹æ³•æ—¶ç¡®å®šçš„ã€‚å¹¶éåœ¨å®ä¾‹åŒ–ç±»æ—¶ç¡®å®š

```java
// ä¿®é¥°ç¬¦ <ä»£è¡¨æ³›å‹çš„å˜é‡> è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å‚æ•°){  } //æ ¼å¼
public class LinearSearch {

    /**
     * @param data   è¦æŸ¥æ‰¾çš„æ•°æ®é›†
     * @param target ç›®æ ‡æ•°æ®
     * @return index
     */
    public static <E> int search(E[] data, E target) {
        for (int i = 0; i < data.length; i++) {
            // å¯¹è±¡ç±»å‹ç¬”è®°ä½¿ç”¨ equalï¼Œé™¤éå°±æ˜¯æ¯”è¾ƒåœ°å€å€¼ã€‚è‹¥æ˜¯è‡ªå®šä¹‰çš„ç±»æ¯”è¾ƒï¼Œéœ€è¦è‡ªå·±é‡å†™ equals æ–¹æ³•
            if (data[i].equals(target))
                return i;
        }
        return -1;
    }


    public static void main(String[] args) {
        Integer[] arr = {1, 3, 2, 5, 7, 4, 3, 11};
        //è°ƒç”¨æ–¹æ³•ä¼ é€’æ•°æ®æ—¶ç¡®å®šæ³›å‹çš„ç±»å‹
        int search = LinearSearch.search(arr, 3);
        System.out.println(search);


        String[] strArr = {"conanan", "conan", "zhangsan"};
        //è°ƒç”¨æ–¹æ³•ä¼ é€’æ•°æ®æ—¶ç¡®å®šæ³›å‹çš„ç±»å‹
        int conan = LinearSearch.search(strArr, "conan");
        System.out.println(conan);
    }
}
```

## æ³›å‹åœ¨ç»§æ‰¿æ–¹é¢çš„ä½“ç°

- å¦‚æœ `B` æ˜¯ `A` çš„ä¸€ä¸ªå­ç±»å‹ï¼ˆå­ç±»æˆ–è€…å­æ¥å£ï¼‰ï¼Œè€Œ `G` æ˜¯å…·æœ‰æ³›å‹å£°æ˜çš„ç±»æˆ–æ¥å£ï¼Œ`G<B>`å¹¶ä¸æ˜¯`G<A>`çš„å­ç±»å‹

  ç±»`A`æ˜¯ç±»`B`çš„çˆ¶ç±»ï¼Œ`A<G>`æ˜¯`B<G>`çš„çˆ¶ç±»

  ```java
  List<Object> list1 = null;
  List<String> list2 = null;
  list1 = list2; // ç¼–è¯‘å¤±è´¥ã€‚add æ—¶æ•°æ®ä¸å®‰å…¨

  Object a = null;
  String b = null;
  a = b;// æˆåŠŸ
  ```

## æ³›å‹é€šé…ç¬¦

- å½“**ä½¿ç”¨æ³›å‹ç±»æˆ–è€…æ¥å£**æ—¶ï¼Œ**ä¼ é€’çš„æ•°æ®ä¸­**ï¼Œ**æ³›å‹ç±»å‹ä¸ç¡®å®š**ï¼Œå¯ä»¥é€šè¿‡é€šé…ç¬¦`?`è¡¨ç¤ºã€‚ä½†æ˜¯ä¸€æ—¦ä½¿ç”¨æ³›å‹çš„é€šé…ç¬¦åï¼Œåªèƒ½ä½¿ç”¨`Object`ç±»ä¸­çš„å…±æ€§æ–¹æ³•ã€‚é›†åˆä¸­å…ƒç´ è‡ªèº«æ–¹æ³•æ— æ³•ä½¿ç”¨ï¼Œæ­¤æ—¶**åªèƒ½è¯»å–æ•°æ®ï¼Œä¸èƒ½æ·»åŠ æ•°æ®ï¼ˆé™¤äº† null ï¼‰**ã€‚

- ç±»`A`æ˜¯ç±»`B`çš„çˆ¶ç±»ï¼Œ`G<A>`å’Œ`G<B>`æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼ŒäºŒè€…å…±åŒçš„çˆ¶ç±»

- ä½¿ç”¨æ–¹å¼ï¼šä¸èƒ½åˆ›å»ºå¯¹è±¡æ—¶ä½¿ç”¨ï¼Œåªèƒ½**ä½œä¸ºæ–¹æ³•çš„å‚æ•°ä½¿ç”¨**

  ```java
  public static void main(String[] args) {
    Collection<Intger> list1 = new ArrayList<Integer>();
    getElement(list1);
    Collection<String> list2 = new ArrayList<String>();
    getElement(list2);
  }
  public static void getElement(Collection<?> coll){}//ï¼Ÿä»£è¡¨å¯ä»¥æ¥æ”¶ä»»æ„ç±»å‹
  ```

- æ³¨æ„

  ```java
  //æ³¨æ„ç‚¹1:ç¼–è¯‘é”™è¯¯:ä¸èƒ½ç”¨åœ¨æ³›å‹æ–¹æ³•å£°æ˜ä¸Šï¼Œè¿”å›å€¼ç±»å‹å‰é¢<>ä¸èƒ½ä½¿ç”¨?
  public static <?> void test(ArrayList<?> list){
  }
  ```

  ```java
  //æ³¨æ„ç‚¹2:ç¼–è¯‘é”™è¯¯:ä¸èƒ½ç”¨åœ¨æ³›å‹ç±»çš„å£°æ˜ä¸Š
  class GenericTypeClass<?>{
  }
  ```

  ```java
  //æ³¨æ„ç‚¹3:ç¼–è¯‘é”™è¯¯:ä¸èƒ½ç”¨åœ¨åˆ›å»ºå¯¹è±¡ä¸Šï¼Œå³è¾¹å±äºåˆ›å»ºé›†åˆå¯¹è±¡
  ArrayList<?> list2 = new ArrayList<?>();
  ```

* **é€šé…ç¬¦é«˜çº§ä½¿ç”¨â€”â€”å—é™æ³›å‹**

  - ä¹‹å‰è®¾ç½®æ³›å‹çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯å¯ä»¥ä»»æ„è®¾ç½®çš„ï¼Œåªè¦æ˜¯ç±»å°±å¯ä»¥è®¾ç½®ã€‚ä½†æ˜¯åœ¨ JAVA çš„æ³›å‹ä¸­å¯ä»¥æŒ‡å®šä¸€ä¸ªæ³›å‹çš„**ä¸Šé™**å’Œ**ä¸‹é™**ã€‚

  - **æ³›å‹çš„ä¸Šé™**ï¼š

    - **æ ¼å¼**ï¼š `ç±»å‹åç§° <? extends ç±» > å¯¹è±¡åç§°`
    - **æ„ä¹‰**ï¼šåªèƒ½æ¥æ”¶è¯¥ç±»å‹åŠå…¶å­ç±»

    **æ³›å‹çš„ä¸‹é™**ï¼š

    - **æ ¼å¼**ï¼š `ç±»å‹åç§° <? super ç±» > å¯¹è±¡åç§°`
    - **æ„ä¹‰**ï¼šåªèƒ½æ¥æ”¶è¯¥ç±»å‹åŠå…¶çˆ¶ç±»å‹

    ```java
    //ç°å·²çŸ¥Objectç±»ï¼ŒString ç±»ï¼ŒNumberç±»ï¼ŒIntegerç±»ï¼Œå…¶ä¸­Numberæ˜¯Integerçš„çˆ¶ç±»
    public static void main(String[] args) {
        Collection<Integer> list1 = new ArrayList<Integer>();
        Collection<String> list2 = new ArrayList<String>();
        Collection<Number> list3 = new ArrayList<Number>();
        Collection<Object> list4 = new ArrayList<Object>();

        getElement1(list1);
        getElement1(list2);//æŠ¥é”™
        getElement1(list3);
        getElement1(list4);//æŠ¥é”™

        getElement2(list1);//æŠ¥é”™
        getElement2(list2);//æŠ¥é”™
        getElement2(list3);
        getElement2(list4);

    }
    public static void getElement1(Collection<? extends Number> coll){}
    public static void getElement2(Collection<? super Number> coll){}
    ```

## ç”¨å¤„

#### Mybatis-Plus çš„é€šç”¨ Mapper

```java
public interface BaseMapper<T> extends Mapper<T> {

    /**
     * æ’å…¥ä¸€æ¡è®°å½•
     *
     * @param entity å®ä½“å¯¹è±¡
     */
    int insert(T entity);

  	//......
}
```

```java
public class UserDao implements BaseMapper<User> {
}
```
