---
title: list—顺序双向链表
date: 2021-02-25 21:52:00
permalink: /pages/1a3932/
categories:
  - Redis
  - 基础
tags:
  -
---

# list

## 介绍

- 数据存储需求：存储多个数据，并对数据进入存储空间的**顺序**进行区分
- 需要的存储结构：一个存储空间保存多个数据，且通过数据可以体现**进入顺序**
- list 类型：保存多个数据，底层使用**双向链表**存储结构实现

## lpush / rpush 🔥

添加/修改数据，返回 list 长度

```
lpush key value1 [value2] ......
rpush key value1 [value2] ......
```

示例

```
127.0.0.1:6379> lpush list1 a b
(integer) 2
127.0.0.1:6379> lpush list1 c
(integer) 3
```

## lrange / lindex / llen

获取数据

```bash
lrange key start stop -- [左闭右闭]，start为0，stop为-1时查询全部。-1 0 则是 empty。0 -2 则是0 -1减掉后面的1个
lindex key index
llen key
```

示例

```bash
127.0.0.1:6379> lrange list1 0 -1
1) "c"
2) "b"
3) "a"

127.0.0.1:6379> lrange list1 -1 0
(empty array)

127.0.0.1:6379> lrange list1 0 -2
1) "c"
2) "b"
```

```bash
127.0.0.1:6379> lindex list1 0
"c"
127.0.0.1:6379> lindex list1 1
"b"
127.0.0.1:6379> lindex list1 2
"a"
127.0.0.1:6379> lindex list1 3
(nil)
```

```bash
127.0.0.1:6379> llen list1
(integer) 3
```

## lpop / rpop 🔥

**移除并返回数据**

```
lpop key
rpop key
```

示例

```bash
127.0.0.1:6379> lpush list2 a b c
(integer) 3
127.0.0.1:6379> lrange list2 0 -1
1) "c"
2) "b"
3) "a"
127.0.0.1:6379> lpop list2
"c"
127.0.0.1:6379> lpop list2
"b"
127.0.0.1:6379> lpop list2
"a"
127.0.0.1:6379> lpop list2
(nil)
```

## blpop / brpop 阻塞版

**规定时间内有则直接获取并移除数据，否则等 timeout**后停止等待

```
blpop key1 [key ...] timeout
brpop key1 [key ...] timeout
brpoplpush source destination timeout -- 待办
```

## lrem 删除任意数据

移除指定数据

```
lrem key count value
```

示例

```bash
127.0.0.1:6379> rpush 001 a b c d e
(integer) 5

127.0.0.1:6379> lrange 001 0 -1
1) "a"
2) "b"
3) "c"
4) "d"
5) "e"

127.0.0.1:6379> lrem 001 1 c
(integer) 1

127.0.0.1:6379> lrange 001 0 -1
1) "a"
2) "b"
3) "d"
4) "e"


127.0.0.1:6379> rpush 001 a b c a a c a
(integer) 11

127.0.0.1:6379> lrange 001 0 -1
 1) "a"
 2) "b"
 3) "d"
 4) "e"
 5) "a"
 6) "b"
 7) "c"
 8) "a"
 9) "a"
10) "c"
11) "a"

127.0.0.1:6379> lrem 001 10 a
(integer) 5

127.0.0.1:6379> lrange 001 0 -1
1) "b"
2) "d"
3) "e"
4) "b"
5) "c"
6) "c"
```



## 注意事项

- list 中保存的**数据都是 string 类型**的，数据总容量是有限的，最多 232 - 1 个元素 (4294967295)。
- list 具有**索引**的概念（lrem），但是操作数据时**通常以队列的形式进行入队出队操作**，或**以栈的形式进行入栈出栈操作**
- 获取全部数据操作**结束索引设置为-1**
- list 可以对数据进行**分页**操作，通常**第一页的信息来自于 list**，**第 2 页及更多的信息通过数据库的形式加载**



## 【场景】朋友圈点赞顺序列表

<img src="../images/image-20210225222400165.png" alt="image-20210225222400165" style="zoom:50%;" />

操作参考 lrem

## 【场景】微博关注列表

twitter、新浪微博、腾讯微博中个人用户的关注列表需要按照用户的关注顺序进行展示，粉丝列表需要将**最近关注的粉丝在前面**

`lpush` `lrange`

## 【场景】最新的新闻或资讯

新闻、资讯类网站如何将最新的新闻或资讯按照发生的时间顺序展示?

`lpush` `lrange`

## 【场景】日志消息队列

企业运营过程中，分布式系统将产生出大量的运营数据，如何**保障多台服务器操作日志的统一顺序输出**

`lpush` `lrange`，但是实际不是使用 ELK 技术栈吗？
