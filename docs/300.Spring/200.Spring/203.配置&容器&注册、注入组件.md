---
title: 3 é…ç½®&å®¹å™¨&æ³¨å†Œã€æ³¨å…¥ç»„ä»¶
date: 2020-12-16 01:25:37
permalink: /pages/78f510/
categories:
  - Spring
  - Spring
tags:
  - 
---
# é…ç½® & å®¹å™¨ & æ³¨å†Œã€æ³¨å…¥ç»„ä»¶

## é¢å‘å¯¹è±¡ä¸­åº”å¯¹å˜åŒ–çš„æ–¹æ¡ˆ ğŸ”¥

### ç­–ç•¥æ¨¡å¼ ğŸ”¥

åˆ¶å®šä¸€ä¸ª Interfaceï¼Œç”¨å¤šä¸ªç±»å®ç°è¯¥ Interface

å¸¸è§„é…ç½®ï¼škey: valueï¼›XML é…ç½®ï¼šç±»/å¯¹è±¡

*   @Autowired çš„ byName åˆ‡æ¢ Beanï¼ˆä¸æ¨èï¼‰
*   @Qualifier åˆ¶å®š name çš„ Beanï¼ˆå¯ä»¥ï¼Œä¹Ÿä¸æ¨èï¼Œå› ä¸ºæ˜¯ä¸»åŠ¨æ³¨å…¥ï¼Œä¾èµ–çš„åº”è¯¥æ— éœ€å…³ç³»å…·ä½“å®ç°ï¼ç”±è¢«ä¾èµ–æ–¹å†³å®šï¼‰
*   æœ‰é€‰æ‹©çš„åªæ³¨å…¥ä¸€ä¸ª Beanï¼ˆå…¶ä»–æ³¨é‡Šæ‰ï¼‰
*   `@Primary`é¦–å…ˆæ³¨å…¥ï¼Œ**æ¨è**
*   `@Conditional`ç­‰ï¼Œ**æ¨è**
*   `@Profile`



### å¯é…ç½®å±æ€§ ğŸ”¥

ä¸€ä¸ªç±»ï¼Œä½¿ç”¨**å±æ€§ï¼ˆå¯è¯»å–é…ç½®ï¼‰æ¥è§£å†³å˜åŒ–**ã€‚å¦‚ JDBC çš„ url ç­‰ã€‚ç›¸æ¯”ç¬¬ä¸€ä¸ªæ–¹æ³•ä¸çµæ´»ï¼ˆåªèƒ½ä¿®æ”¹é…ç½®ï¼Œä¸èƒ½ä¿®æ”¹ç±»ï¼Œå½“è¦å¢åˆ å±æ€§æ—¶å°±å¿…é¡»ä¿®æ”¹ç±»äº†ï¼‰ï¼Œå½“ç„¶å¯ä»¥å®ç°ä¸€ä¸ª Interface æ¥ç»¼åˆä½¿ç”¨ã€‚

*   é…ç½®æ–‡ä»¶é›†ä¸­æ€§
*   æ¸…æ™°ï¼Œæ²¡æœ‰ä¸šåŠ¡é€»è¾‘



æ ¹æ®éœ€è¦é€‰æ‹©ä¸Šè¿°ä¸¤ç§æ–¹æ¡ˆï¼Œä¸€èˆ¬å¯ä»¥ç»¼åˆä½¿ç”¨ï¼



## @Configuration é…ç½®ç±» ğŸ”¥

### @Configuration åŠå…¶ä½œç”¨ ğŸ”¥

ç”¨äº**æŒ‡å®šå½“å‰ç±»æ˜¯ä¸€ä¸ª Spring é…ç½®ç±»**ï¼Œå…¶åº•å±‚è¿˜æ˜¯`@Componet`ï¼Œå½“åˆ›å»ºå®¹å™¨æ—¶ä¼šä»è¯¥ç±»ä¸ŠåŠ è½½æ³¨è§£ã€‚å½“**é…ç½®ç±»**ä½œä¸º AnnotationConfigApplicationContext æ„é€ å™¨çš„**å‚æ•°**æ—¶ï¼Œè¯¥æ³¨è§£å¯ä»¥ä¸å†™ï¼ˆä¸æ¨èï¼‰

- `value`ç”¨äºæŒ‡å®šé…ç½®ç±»çš„å­—èŠ‚ç ï¼Œä¸€èˆ¬ä¸ç”¨

ä½œç”¨ï¼šä¿æŒä»£ç çš„ç›¸å¯¹ç¨³å®šï¼Œæ‰èƒ½é€æ­¥å®ç° OCPã€‚ä½†æ˜¯ä»£ç ä¸­æ€»ä¼šå­˜åœ¨ä¸ç¨³å®šï¼Œéœ€è¦**éš”ç¦»è¿™äº›ä¸ç¨³å®šå› ç´ ï¼ˆé‡‡ç”¨é…ç½®ç±»ã€é…ç½®æ–‡ä»¶ç­‰æ–¹å¼ï¼‰**ï¼Œ**ä¿è¯å…¶ä»–çš„ä»£ç æ˜¯ç¨³å®šçš„**ã€‚å³å¯¹è±¡çš„å®ä¾‹åŒ–åº”è¯¥å’Œå…¶ä»–åˆ†å¼€ï¼

*   é…ç½®æ–‡ä»¶çš„**é›†ä¸­æ€§**
*   é…ç½®æ–‡ä»¶**æ¸…æ™°ï¼ˆä½†æ˜¯å¤šäº†åä¹Ÿä¸æ¸…æ™°ï¼‰ï¼Œæ²¡æœ‰ä¸šåŠ¡é€»è¾‘**



### å¸¸ç”¨æ–¹å¼â€”é…ç½®ç±» + é…ç½®æ–‡ä»¶ ğŸ”¥

**å¯é…ç½®å±æ€§æ–¹å¼è§£å†³é¢å‘å¯¹è±¡ä¸­å˜åŒ–**

#### @Value

ç”¨äºæ³¨å…¥åŸºæœ¬ç±»å‹å’ŒStringæ•°æ®

- `value`æŒ‡å®šæ•°æ®çš„å€¼ã€‚
    - åŸºæœ¬ç±»å‹å’ŒString

    - ä½¿ç”¨SpELï¼ˆå†™æ³•ï¼š`#{è¡¨è¾¾å¼}`ï¼‰

    - `${}`ç»“åˆ`@PropertySource`å¯å–å‡ºé…ç½®æ–‡ä»¶å¦‚ properties æˆ– yml ä¸­çš„å€¼ï¼ˆ**ä¹Ÿå­˜åœ¨äºè¿è¡Œç¯å¢ƒå˜é‡é‡Œé¢**ï¼‰

```java
@RestController
public class HelloController {

    @Value("${dog[0].name}")//æ•°ç»„æˆ–é›†åˆä¸­ä¿å­˜å¯¹è±¡
    private String name;

    @RequestMapping("/hello")
    public String hello(){
        return "hello spring boot "+name;
    }
}

```



#### @PropertySource

é‡å¤æ³¨è§£ï¼Œç”¨äº**æŒ‡å®špropertiesæ–‡ä»¶çš„ä½ç½®**

- `value`æŒ‡å®šæ–‡ä»¶çš„**åç§°å’Œè·¯å¾„**æ•°ç»„ã€‚å…³é”®å­—ï¼š**classpath**ï¼Œè¡¨ç¤ºç±»è·¯å¾„ä¸‹

```java
/**
 * å°†é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„æ¯ä¸€ä¸ªå±æ€§çš„å€¼ï¼Œæ˜ å°„åˆ°è¿™ä¸ªç»„ä»¶ä¸­
 * @ConfigurationPropertiesï¼šå‘Šè¯‰SpringBootå°†æœ¬ç±»ä¸­çš„æ‰€æœ‰å±æ€§å’Œé…ç½®æ–‡ä»¶ä¸­ç›¸å…³çš„é…ç½®è¿›è¡Œç»‘å®šï¼›
 *      prefix = "person"ï¼šé…ç½®æ–‡ä»¶ä¸­å“ªä¸ªä¸‹é¢çš„æ‰€æœ‰å±æ€§è¿›è¡Œä¸€ä¸€æ˜ å°„
 *
 * åªæœ‰è¿™ä¸ªç»„ä»¶æ˜¯å®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œæ‰èƒ½å®¹å™¨æä¾›çš„@ConfigurationPropertiesåŠŸèƒ½ï¼›
 */
@PropertySource(value = {"classpath:person.properties"})
@Component
@ConfigurationProperties(prefix = "person")
public class Person {

    private String lastName;
    private Integer age;
    private Boolean boss;

```



#### @ConfigurationProperties

Spring Boot ç‰¹æœ‰ï¼Œç”¨äºæ‰¹é‡æ³¨å…¥é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§ï¼Œå¯é…åˆ @PropertySource ä½¿ç”¨

é€šè¿‡æ³¨è§£ @ConfigurationProperties(prefix="é…ç½®æ–‡ä»¶ä¸­çš„keyçš„å‰ç¼€") å¯ä»¥å°†é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®è‡ªåŠ¨ä¸å®ä½“è¿›è¡Œæ˜ å°„ï¼Œ**éœ€è¦æä¾› setter æ–¹æ³•**

```java
@Component
@RestController
@ConfigurationProperties(prefix = "teacher")
public class HelloController {

    private String name;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @RequestMapping("/hello")
    public String hello(){
        return "hello spring boot "+name;
    }
}

```

`@ConfigurationProperties`æŠ¥é”™ Not registered via @EnableConfigurationProperties or marked as Spring componentï¼Œæ·»åŠ äº†`@Component`æ³¨è§£åè§£å†³äº†

è‹¥å‡ºç°ä»¥ä¸‹æç¤ºï¼Œéœ€è¦é…ç½®æ–‡ä»¶æ‰§è¡Œå™¨ï¼Œå¹¶åœ¨ç±»ä¸­å®šä¹‰å¥½å±æ€§å’Œ set æ–¹æ³•åï¼Œå¦‚æœåœ¨é…ç½®æ–‡ä»¶ä¸­ç¼–å†™é…ç½®ä¼šæœ‰æç¤ºï¼

```xml
<!--é…ç½®æ–‡ä»¶æ‰§è¡Œå™¨é…ç½®-->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-configuration-processor</artifactId>
    <optional>true</optional>
</dependency>

```

**@Value å’Œ @ConfigurationProperties æ¯”è¾ƒ**

|                      | @ConfigurationProperties | @Value     |
| -------------------- | ------------------------ | ---------- |
| åŠŸèƒ½                 | æ‰¹é‡æ³¨å…¥é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§ | ä¸€ä¸ªä¸ªæŒ‡å®š |
| æ¾æ•£ç»‘å®šï¼ˆæ¾æ•£è¯­æ³•ï¼‰ | æ”¯æŒ                     | ä¸æ”¯æŒ     |
| SpEL                 | ä¸æ”¯æŒ                   | æ”¯æŒ       |
| JSR303 æ•°æ®æ ¡éªŒ      | æ”¯æŒ                     | ä¸æ”¯æŒ     |
| å¤æ‚ç±»å‹å°è£…         | æ”¯æŒ                     | ä¸æ”¯æŒ     |

- **æ¾æ•£è¯­æ³•ç»‘å®š**ï¼šlast_name = last-name = lastName ä»–ä»¬å–çš„å€¼éƒ½æ˜¯ç›¸åŒçš„
- é…ç½®æ–‡ä»¶ yml è¿˜æ˜¯ properties ä»–ä»¬éƒ½èƒ½è·å–åˆ°å€¼ï¼Œæ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿ
    - è‹¥æˆ‘ä»¬åªæ˜¯åœ¨æŸä¸ªä¸šåŠ¡é€»è¾‘ä¸­éœ€è¦**è·å–**ä¸€ä¸‹**é…ç½®æ–‡ä»¶**ä¸­çš„**æŸé¡¹å€¼**ï¼Œä½¿ç”¨@Valueï¼›
    - è‹¥æˆ‘ä»¬ä¸“é—¨ç¼–å†™äº†ä¸€ä¸ª javaBean æ¥å’Œé…ç½®æ–‡ä»¶**æ˜ å°„**ï¼Œæˆ‘ä»¬å°±ç›´æ¥ä½¿ç”¨@ConfigurationProperties





#### ç¤ºä¾‹

application.yml

```yml
person.nickName: wangcai
```

Person.Class

```java
@Data
public class Person {

    @Value("å¼ ä¸‰")
    private String name;

    /**
     * SpEL
     */
    @Value("#{20-2}")
    private Long age;

    /**
     * ä½¿ç”¨ @PropertySource é…åˆ ${} è·å–é…ç½®æ–‡ä»¶ä¸­çš„å€¼ï¼ˆä¹Ÿå­˜åœ¨äºè¿è¡Œç¯å¢ƒå˜é‡ Environment ä¸­ï¼‰
     */
    @Value("${person.nickName}")
    private String nickName;
}
```

AssignmentConfig1.Class

```java
@Configuration
@PropertySource({"classpath:/application.yml"})
public class AssignmentConfig1 {

    @Bean
    public Person person(){
        return new Person();
    }

}
```

AssignmentConfig1Test.Class

```java
public class AssignmentConfig1Test {

    private ApplicationContext context;

    @BeforeEach
    public void init(){
        context = new AnnotationConfigApplicationContext(AssignmentConfig1.class);
        System.out.println("å®¹å™¨åˆ›å»ºå®Œæˆ");
    }


    @Test
    public void test(){

        Person person = context.getBean(Person.class);
        System.out.println(person);

        Environment environment = context.getEnvironment();
        String nickName = environment.getProperty("person.nickName");
        System.out.println(nickName);

    }
}
```

è‹¥æ˜¯é…ç½®æ•°æ®åº“è¿æ¥ï¼Œå¯ä»¥é‡‡ç”¨è¯¥æ–¹å¼æ¥è§£è€¦ ipã€port ç­‰å˜åŒ–ï¼å°±æ˜¯ä½¿ç”¨è¯¥æ€æƒ³ï¼









### @Configuration å’Œ @Bean

- @ImportResourceï¼š**å¯¼å…¥ Spring çš„é…ç½®æ–‡ä»¶**ï¼Œå¦‚ beans.xmlï¼ŒåŠ è½½ beanï¼Œè®©é…ç½®æ–‡ä»¶é‡Œé¢çš„å†…å®¹ç”Ÿæ•ˆ

    - Spring Boot é‡Œé¢æ²¡æœ‰ Spring çš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬è‡ªå·±ç¼–å†™çš„é…ç½®æ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è‡ªåŠ¨è¯†åˆ«ï¼›

        æƒ³è®© Spring çš„é…ç½®æ–‡ä»¶ç”Ÿæ•ˆï¼ŒåŠ è½½è¿›æ¥ï¼›@ImportResource æ ‡æ³¨åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸Š

    ```xml
    <bean id="helloService" class="com.cuzz.springboot.service.HelloService"></bean>
    ```

    ```java
    @ImportResource(locations = {"classpath:beans.xml"})
    @SpringBootApplication
    public class SpringbootApplication {
    
    	public static void main(String[] args) {
    		SpringApplication.run(SpringbootApplication.class, args);
    	}
    }
    
    ```

- è¿˜æ˜¯**å†™é…ç½®ç±»å§**ï¼åˆ©ç”¨@Configuration å’Œ@Bean

    ```java
    @Configuration
    public class MyAppConfig {
        // å°†æ–¹æ³•çš„è¿”å›å€¼æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼›å®¹å™¨ä¸­è¿™ä¸ªç»„ä»¶é»˜è®¤çš„idå°±æ˜¯æ–¹æ³•å
        @Bean
        public HelloService helloService02(){
            System.out.println("é…ç½®ç±»@Beanç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶äº†...");
            return new HelloService();
        }
    }
    
    ```





### æµ‹è¯•æ­¥éª¤

1.  Maven ä¾èµ–

    ```xml
    <dependencies>
        <!--context é»˜è®¤ä¼ é€’ä¾èµ– coreã€beansã€expressionã€aop ç­‰-->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>5.2.6.RELEASE</version>
        </dependency>
    
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <version>1.18.12</version>
        </dependency>
    
    	<!-- junit5 ä½¿ç”¨æŸ¥çœ‹ Github ç¤ºä¾‹ -->    
        <!-- https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api -->
        <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter</artifactId>
            <version>5.6.2</version>
            <scope>test</scope>
        </dependency>
    </dependencies>
    ```

2.  æ­¤æ—¶ä½¿ç”¨ Maven æ¥ç¼–è¯‘ä¼šè­¦å‘Š Java ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨ POM.mxl ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼ˆSpring Boot å°±æ˜¯æ·»åŠ çš„è¿™ç§ï¼‰ã€‚

    å¯æŸ¥çœ‹ [Maven æ–‡æ¡£](http://maven.apache.org/plugins/maven-compiler-plugin/examples/set-compiler-source-and-target.html)é…ç½®

    ```xml
    <properties>
        <java.version>1.8</java.version>
        <maven.compiler.source>${java.version}</maven.compiler.source>
        <maven.compiler.target>${java.version}</maven.compiler.target>
        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <resource.delimiter>@</resource.delimiter>
    </properties>
    ```

3.  POJO

    ```java
    @Data
    @NoArgsConstructor
    @AllArgsConstructor
    public class Person {
    
        private String name;
        private Integer age;
    
    }
    ```

4.  é…ç½®ç±»

    ```java
    // é…ç½®ç±»==é…ç½®æ–‡ä»¶
    @Configuration// //å‘Šè¯‰Springè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚è¯¥ç±»ä¸º å®¹å™¨æ„é€ å™¨å‚æ•°æ—¶ï¼Œå¯çœç•¥è¯¥æ³¨è§£ï¼ˆä¸æ¨èï¼‰
    // æ¯æ¬¡æµ‹è¯•æ—¶è®°å¾—å°†å…¶ä»– @Configuration æ³¨é‡Šæ‰ï¼Œæˆ–ç€æ³¨é‡Šæ‰ @ComponentScan
    public class IocConfig1 {
    
        @Bean
        public Person person(){
            return new Person("person",1);
        }
    
        @Bean
        @Primary
        public Person person2(){
            return new Person("person2",2);
        }
    
    }
    ```

5.  æµ‹è¯•ç±»

    ```java
    public class IocConfig1Test {
    
    
        @Test
        public void test(){
            ApplicationContext context = new AnnotationConfigApplicationContext(IocConfig1.class);
    
            // æ ¹æ® bean åç§°è·å–ã€‚æœ‰å¤šä¸ªæ—¶å–ç¬¬ä¸€ä¸ªï¼ˆä½¿ç”¨@Primaryä¹Ÿæ²¡ç”¨ï¼Œæš‚æ—¶å°±è¿™æ ·ï¼‰
            Person person1 = (Person) context.getBean("person");
            System.out.println(person1);
    
            // æ ¹æ® bean ç±»å‹ï¼ˆåŒ…æ‹¬å­ç±»ã€å®ç°ç±»ï¼‰è·å–ã€‚
            // åªè¦å®¹å™¨ä¸­æœ‰å”¯ä¸€ä¸€ä¸ª Bean å¯¹è±¡ç±»å‹å’Œè¦æ³¨å…¥çš„å˜é‡ç±»å‹åŒ¹é…ï¼Œå°±æ³¨å…¥æˆåŠŸï¼Œä¸€ä¸ªéƒ½æ²¡æœ‰åˆ™æŠ¥é”™
            // å¦‚æœæœ‰å¤šä¸ªç±»å‹åŒ¹é…åˆ°ï¼Œåˆ™æŠ¥é”™ã€‚å¯ä»¥ä½¿ç”¨ @Primary æ¥æŒ‡å®š
            Person person2 = context.getBean(Person.class);
            System.out.println(person2);
    
            // æ ¹æ® bean åç§°å’Œç±»å‹è·å–
            Person person3 = context.getBean("person", Person.class);
            System.out.println(person3);
    
            // è·å–æ‰€æœ‰è¯¥ç±»å‹çš„ bean
            Map<String, Person> beansOfType = context.getBeansOfType(Person.class);
            beansOfType.forEach((name,person)->{
                System.out.println(name+":"+person);
            });
    
            // è·å–æ‰€æœ‰è¯¥ç±»å‹çš„ bean åç§°
            String[] beanNamesForType = context.getBeanNamesForType(Person.class);
            System.out.println(Arrays.toString(beanNamesForType));
    
    
            // è·å–å®¹å™¨ä¸­æ‰€æœ‰ bean åç§°
            String[] beanDefinitionNames = context.getBeanDefinitionNames();
            System.out.println(Arrays.toString(beanDefinitionNames));
    
        }
    }
    ```

    



## å®¹å™¨æ¥å£åŠå…¶å®ç°ç±»

### æ¥å£åŠå®ç°ç±»

* `BeanFactory`é¡¶å±‚å®¹å™¨æ¥å£ã€‚åˆ›å»ºå¯¹è±¡é‡‡ç”¨**å»¶è¿ŸåŠ è½½**æ–¹å¼ï¼ˆä½•æ—¶ä½¿ç”¨ä½•æ—¶åˆ›å»ºï¼Œå¤šä¾‹é€‚ç”¨ï¼‰
* `ApplicationContext`å®¹å™¨æ¥å£ã€‚åˆ›å»ºå¯¹è±¡é‡‡ç”¨**ç«‹å³åŠ è½½**æ–¹å¼ï¼ˆ**è¯»å®Œé…ç½®æ–‡ä»¶**ï¼Œ**é»˜è®¤æƒ…å†µä¸‹å°±åˆ›å»º(å¯ä¿®æ”¹)**ï¼Œå•ä¾‹é€‚ç”¨ï¼‰
    * `ClassPathXmlApplicationContext`ï¼ŒåŸºäºxmlé…ç½®çš„å®ç°ç±»ã€‚åªèƒ½åŠ è½½**ç±»è·¯å¾„**ä¸‹çš„é…ç½®æ–‡ä»¶
    * `FileSystemXmlApplicationContext`ï¼ŒåŸºäºxmlé…ç½®çš„å®ç°ç±»ã€‚å¯ä»¥åŠ è½½**ç£ç›˜ä»»æ„è·¯å¾„**çš„é…ç½®æ–‡ä»¶ï¼ˆéœ€æœ‰è®¿é—®æƒé™ï¼‰
    * `AnnotationConfigApplicationContext`ï¼ŒåŸºäºæ³¨è§£é…ç½®çš„å®ç°ç±»ã€‚è¯»å–**æ³¨è§£**åˆ›å»ºå®¹å™¨



### å¸¸ç”¨æ–¹æ³•

::: tip

è·å–å®¹å™¨æ—¶ä½¿ç”¨ `AnnotationConfigApplicationContext(æœ‰@Configuration æ³¨è§£çš„ç±».class)`æ¥åˆ›å»º`ApplicationContext`å¯¹è±¡ã€‚ç”±äºæœ¬èº«ä¹Ÿæ˜¯`@Component`ï¼Œæ‰€ä»¥æŒ‡å®š@ComponentScanæ—¶å¯ä»¥è·³è¿‡æ­¤ç±»ï¼ˆäº†è§£ï¼‰

:::

* `String[] getBeanDefinitionNames()`ï¼šæŸ¥è¯¢è¿™ä¸ªIoCå®¹å™¨ä¸­æ‰€æœ‰Beançš„åç§°
* `String[] getBeanNamesForType(Class c)`ï¼šæŸ¥è¯¢è¿™ä¸ªIoCå®¹å™¨ä¸­æŒ‡å®šç±»å‹çš„Beançš„åç§°
* `Map<String, Class >getBeansOfType(Class c)`ï¼šæŸ¥è¯¢è¿™ä¸ªIoCå®¹å™¨ä¸­æ‰€æœ‰Beançš„åç§°ã€å’ŒBeanå¯¹è±¡
* `Object getBean([String beanName] [,Class c])`







## æ³¨å†Œç»„ä»¶â€”åŒ…æ‰«æ & æ³¨è§£ğŸ”¥

::: tip

é€‚ç”¨äºè‡ªå·±å†™çš„ç±»

:::

### @ComponentScans

ç”¨äºå¤šä¸ª`@ComponentScan`ã€‚å±æ€§æœ‰`value`æ•°ç»„ï¼Œå¯ä»¥åŒ…å«å¤šä¸ª` @ComponentScan`ã€‚Java 8 åä½¿ç”¨ä¸‹é¢çš„



### @ComponentScan  ğŸ”¥

åœ¨JDK8ä¹‹åæ˜¯é‡å¤æ³¨è§£ï¼Œç›´æ¥å†™å¤šä¸ªï¼Œä¸å†ä½¿ç”¨ä¸Šè¾¹é‚£ä¸ª

æ‰«æè§„åˆ™ï¼š

*   æŒ‡å®š value æˆ– bashPackages å³Springåœ¨**åˆå§‹åŒ–å®¹å™¨**æ—¶**è¦æ‰«æçš„åŒ…**ï¼Œå°†æ‰«æï¼ˆä¸ä¸€å®šå°±æ³¨å…¥å®¹å™¨ï¼‰è¯¥åŒ…åŠå…¶å­åŒ…ä¸‹çš„**æ‰€æœ‰ç±»**ï¼Œç„¶åæ ¹æ®è§„åˆ™**æ’é™¤**

*   ä¸æŒ‡å®šåˆ™æ‰«**æé…ç½®ç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…ä¸‹çš„æ‰€æœ‰ç±»**ï¼Œç„¶åæ ¹æ®è§„åˆ™æ’é™¤ã€‚

*   **é»˜è®¤åŒ…æ‹¬ @Componet åŠå…¶æ´¾ç”Ÿç±»ï¼Œå¦‚ @Componetã€@Controllerã€@Serviceã€@Repositoryã€@Configuration ç­‰**

å±æ€§ï¼š

* `value`æˆ–`basePackages`éƒ½æ˜¯ç”¨äºæŒ‡å®šè¦æ‰«æçš„åŒ…ï¼Œéƒ½æ˜¯æ•°ç»„ç±»å‹

* `excludeFilters`æŒ‡å®šæ‰«æçš„æ—¶å€™æŒ‰ç…§ä»€ä¹ˆè§„åˆ™æ’é™¤é‚£äº›ç»„ä»¶

* `includeFilters`æŒ‡å®šæ‰«æçš„æ—¶å€™åªéœ€è¦åŒ…å«å“ªäº›ç»„ä»¶

    å€¼ä¸º`Filter[]`ï¼Œä½¿ç”¨`@Filter`æ³¨è§£ï¼Œå±æ€§æœ‰`type`ï¼ˆå¦‚ä¸‹ï¼‰ã€`classes`ï¼ˆClassç±»å‹ï¼‰

    * `FilterType.ANNOTATION`ï¼šæŒ‰ç…§å¸¦æœ‰çš„**æ³¨è§£ç±»å‹**
    * `FilterType.ASSIGNABLE_TYPE`ï¼šæŒ‰ç…§**ç»™å®šçš„å…·ä½“ç±»å‹**
    * `FilterType.ASPECTJ`ï¼šä½¿ç”¨ASPECTJè¡¨è¾¾å¼
    * `FilterType.REGEX`ï¼šä½¿ç”¨æ­£åˆ™æŒ‡å®š
    * `FilterType.CUSTOM`ï¼šä½¿ç”¨è‡ªå®šä¹‰è§„åˆ™ï¼Œéœ€è¦è‡ªå®šä¹‰`TypeFilter`çš„å®ç°ç±»ï¼Œé‡å†™`match`æ–¹æ³•

* `useDefaultFilters`åœ¨**ä½¿ç”¨æŒ‡å®šçš„è§„åˆ™æ—¶**éœ€è¦å°†è¿™ä¸ªå€¼è®¾ç½®ä¸º`false`ã€‚é»˜è®¤ä¸º`true`

    *   è‹¥è¯¥å€¼ä¸º`true`ï¼Œåˆ™æ‰«æè¯¥äº”ä¸ªæ³¨è§£å¹¶åŒ¹é…ä¸Šè¿°è§„åˆ™ã€‚ä¸€èˆ¬ä¸ä¼šè¿™æ ·åšï¼ˆå¾ˆå‚»é€¼ï¼‰

    *   è‹¥è¯¥å€¼ä¸º`false`ï¼Œåˆ™**ä»…**éœ€åŒ¹é…ä¸Šè¿°è§„åˆ™

::: æ³¨æ„

*   `@Componet`æ³¨è§£æ˜¯ä¸Šè¿°å››ä¸ªæ³¨è§£çš„åº•å±‚å®ç°ï¼Œè‹¥`exclude`ååˆ™å››ä¸ªæ³¨è§£éƒ½ä¸ä¼šæ‰«æåˆ°

*   `includeFilters` å’Œ `excludeFilters` ä¼šå…±åŒä½œç”¨ï¼Œå¿…é¡»éƒ½æ»¡è¶³ï¼ˆä¸”ä»¥ `excludeFilters` ä¸ºå‡†ï¼‰
*   ä¸Šè¿°æ‰«æçš„ç±»å‹æŒ‡çš„éƒ½æ˜¯**è¯¥ç±»åŠå…¶å­ç±»**ï¼Œ**è¯¥æ³¨è§£åŠå…¶å­æ³¨è§£**

:::



### è‡ªå®šä¹‰ FilterType  ğŸ”¥

```java
/**
 * è‡ªå®šä¹‰ TypeFilter
 */
public class MyTypeFilter implements TypeFilter {
    /**
     *
     * @param metadataReader è¯»å–åˆ°çš„å½“å‰æ­£åœ¨æ‰«æçš„ç±»çš„ä¿¡æ¯
     * @param metadataReaderFactory å¯ä»¥è·å–åˆ°å…¶ä»–ä»»ä½•ç±»ä¿¡æ¯çš„
     * @return boolean
     * @throws IOException
     */
    @Override
    public boolean match(MetadataReader metadataReader, MetadataReaderFactory metadataReaderFactory) throws IOException {
        //è·å–å½“å‰ç±»æ³¨è§£çš„ä¿¡æ¯
        AnnotationMetadata annotationMetadata = metadataReader.getAnnotationMetadata();
        //è·å–å½“å‰æ­£åœ¨æ‰«æçš„ç±»çš„ç±»ä¿¡æ¯
        ClassMetadata classMetadata = metadataReader.getClassMetadata();
        //è·å–å½“å‰ç±»èµ„æºï¼ˆç±»çš„è·¯å¾„ï¼‰
        Resource resource = metadataReader.getResource();

        String className = classMetadata.getClassName();
        if (className.endsWith("er")){
            System.out.println("er --->"+className);
            return true;
        } else {
            System.out.println("not er --->"+className);
            return false;
        }
    }
}
```

```java
/**
 * åŒ…æ‰«æ + æ³¨è§£ã€‚å®é™…ä¸­ä¹Ÿä¸ä¼šè¿™æ ·å†™ï¼Œå¤ªä¹±ã€‚å¯èƒ½åªç”¨ç®€å•çš„ï¼Œæˆ–åªä½¿ç”¨è‡ªå®šä¹‰Filter
 */
// é…ç½®ç±»==é…ç½®æ–‡ä»¶
@Configuration// å‘Šè¯‰Springè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚è¯¥ç±»ä¸º å®¹å™¨æ„é€ å™¨å‚æ•°æ—¶ï¼Œå¯çœç•¥è¯¥æ³¨è§£ï¼ˆä¸æ¨èï¼‰
// æ¯æ¬¡æµ‹è¯•æ—¶è®°å¾—å°†å…¶ä»– @Configuration æ³¨é‡Šæ‰ï¼Œæˆ–ç€æ³¨é‡Šæ‰ @ComponentScan
@ComponentScan(
        value = "top.conanan",
        includeFilters = {
                @ComponentScan.Filter(type = FilterType.ANNOTATION, classes = {Controller.class}),
                // Student æ²¡æœ‰æ·»åŠ ä»»ä½•æ³¨è§£ï¼Œä¹Ÿè¢«æ³¨å†Œåˆ°å®¹å™¨ä¸­äº†
                @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE, classes = {Student.class}),
                // CUSTOM è‡ªå®šä¹‰ Filter
                @ComponentScan.Filter(type = FilterType.CUSTOM, classes = {MyTypeFilter.class})
        },
        excludeFilters = {
                @ComponentScan.Filter(type = FilterType.ANNOTATION, classes = {Service.class})
        },
        useDefaultFilters = false)
// includeFilters å’Œ excludeFilters ä¼šå…±åŒä½œç”¨ï¼Œå¿…é¡»éƒ½æ»¡è¶³ï¼ˆä¸”ä»¥ excludeFilters ä¸ºå‡†ï¼‰
public class IocConfig2 {
}
```





### Stereotype Annotations ğŸ”¥

stereotype annotationsï¼šæ¨¡å¼æ³¨è§£

- `@Component`ï¼šç”¨äº**æŠŠå½“å‰ç±»å¯¹è±¡å­˜å…¥Spirngå®¹å™¨ä¸­**ã€‚

    æ³¨è§£åœ¨å®ç°ç±»ä¸Šä¸æŒ‡å®š value ä¼šè‡ªåŠ¨æŒ‡å®š valueã€‚ä¸”æ³¨å†Œçš„æ˜¯**å¯¹è±¡**ï¼Œæ‰€ä»¥æŠ½è±¡ç±»æˆ–æ¥å£æ— æ³•è¢«æ³¨å†Œï¼Œéƒ½æ˜¯å®**ç°ç±»æ‰èƒ½è¢«æ³¨å†Œ**

    - å±æ€§ï¼š`value`ï¼šç”¨äºæŒ‡å®š bean çš„ idã€‚ä¸å†™æ—¶é»˜è®¤ä¸º**å½“å‰ç±»åï¼Œä¸”é¦–å­—æ¯å°å†™**

- `@Controller`**æˆ–**`@RestController`ï¼šè¡¨ç°å±‚

- `@Service`ï¼šä¸šåŠ¡å±‚ï¼Œæ ‡æ³¨åœ¨å®ç°ç±»ä¸Šï¼Œä¸€èˆ¬ä¸šåŠ¡ä»£ç ä¸éœ€è¦æ¥å£ï¼å…¶ä»–ä¼šå˜åŒ–çš„åº”è¯¥ä½¿ç”¨æ¥å£ï¼Œå¦‚**é‡‡ç”¨ç­–ç•¥æ¨¡å¼æ—¶**ï¼

- `@Repository`ï¼šæŒä¹…å±‚

    ä»¥ä¸Šä¸‰ä¸ªæ³¨è§£çš„ä½œç”¨å’Œå±æ€§ä¸`@Componet`ä¸€è‡´ï¼Œä¸”åº•å±‚å°±æ˜¯`@Componet`ï¼Œæ˜¯Springæä¾›æ˜ç¡®çš„ä¸‰å±‚æ¶æ„ä½¿ç”¨çš„æ³¨è§£ï¼Œä½¿ä¸‰å±‚å¯¹è±¡æ›´åŠ æ¸…æ™°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨`@Scope`ã€`@Conditional`æ³¨è§£ï¼Œè¯¦è§æ³¨å†Œç»„ä»¶â€”Beanç« èŠ‚ï¼š




## æ³¨å†Œç»„ä»¶â€”@Bean ğŸ”¥

::: tip

é€‚ç”¨äºç¬¬ä¸‰æ–¹åŒ…

:::

### @Bean ğŸ”¥

ç”¨äºæŠŠå½“å‰**æ–¹æ³•çš„è¿”å›å€¼**ä½œä¸ºbeanå¯¹è±¡**æ³¨å†Œå­˜å…¥Springå®¹å™¨**ä¸­ã€‚è¯¥æ³¨è§£**åªèƒ½å†™åœ¨æ–¹æ³•ä¸Š**

* `value`æˆ–`name`ç”¨äºæŒ‡å®š **bean çš„ id**ã€‚æ²¡å†™åˆ™é»˜è®¤ä¸º**å½“å‰æ–¹æ³•çš„åç§°ï¼ˆå»é™¤getterã€setter çš„å±æ€§ï¼‰**
* ç»†èŠ‚ï¼šå½“æˆ‘ä»¬ä½¿ç”¨æ³¨è§£é…ç½®æ–¹æ³•æ—¶ï¼Œå¦‚æœ**æ–¹æ³•æœ‰å‚æ•°**ï¼ŒSpringæ¡†æ¶ä¼šå»å®¹å™¨ä¸­æŸ¥æ‰¾æœ‰æ²¡æœ‰å¯ç”¨çš„beanå¯¹è±¡ã€‚æŸ¥æ‰¾çš„æ–¹å¼å’Œ`@Autowired`æ³¨è§£çš„ä½œç”¨æ˜¯ä¸€æ ·çš„

**ç›¸æ¯”æ¨¡å¼æ³¨è§£ï¼Œè¯¥æ–¹å¼å¯ä»¥æ“ä½œå¯¹è±¡ä¸­çš„å±æ€§ï¼ˆå³ç»™å±æ€§èµ‹å€¼ï¼‰ï¼Œå¯é€šè¿‡æ„é€ å™¨ã€setter ç­‰æ–¹å¼**





### @Scope & @Lazy ğŸ”¥

ç”¨äºæŒ‡å®šbeançš„ä½œç”¨èŒƒå›´ã€‚ä¹Ÿå¯ä»¥æ”¾ç½®æ³¨è§£åœ¨å®šä¹‰çš„4ä¸ªç»„ä»¶ä¸Šï¼ˆé™¤è¿‡ @Configurationï¼Œå› ä¸ºæ²¡ä½œç”¨ï¼‰

`value`æŒ‡å®šèŒƒå›´çš„å–å€¼ã€‚å¸¸ç”¨æœ‰ï¼š

- `singleton`ï¼š**å•ä¾‹**ã€é»˜è®¤ã€‘ï¼Œä¸€ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹ï¼Œ**IoCå®¹å™¨å¯åŠ¨æ—¶åˆ™ä¼šè‡ªåŠ¨åˆ›å»ºå¯¹è±¡å¹¶æ”¾å…¥å®¹å™¨**ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æ­¤æ—¶ä¹Ÿä¼š**æ³¨å…¥**ç»„ä»¶ï¼ŒåŸå› æ˜¯ Bean çš„å®ä¾‹åŒ–éœ€è¦æ‰€æœ‰å±æ€§éƒ½å®ä¾‹åŒ–

    `@Lazy`ï¼šæ‡’åŠ è½½ï¼Œ**åªé’ˆå¯¹å•ä¾‹å¯¹è±¡**çš„åˆ›å»ºæ—¶é—´ï¼Œå˜ä¸ºè·å–å¯¹è±¡æ—¶æ‰åˆ›å»ºï¼ˆåªåˆ›å»ºä¸€æ¬¡ï¼‰ï¼Œä½†è¿˜æ˜¯å•ä¾‹ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‹¥è¯¥å¯¹è±¡è¢«ä¸€ä¸ªé lazy å¯¹è±¡å¼•ç”¨äº†ï¼ˆåŒ…å«è¯¥å±æ€§ï¼‰ï¼Œåˆ™è¯¥å¯¹è±¡çš„ lazy ä¸èµ·ä½œç”¨ï¼å› ä¸ºé lazy å¯¹è±¡å®ä¾‹åŒ–æ—¶éœ€è¦æ‰€å±æ€§éƒ½å®ä¾‹åŒ–äº†ã€‚

    å¯ç”¨äºæ‰€æœ‰ Beanï¼Œä¸å•å•æ˜¯`@Bean`ï¼Œè¿˜æœ‰å„ç§`@Componet`ç­‰ç­‰

- `prototype`ï¼š**å¤šä¾‹**ï¼ŒIoCå®¹å™¨å¯åŠ¨æ—¶ä¸ä¼šåˆ›å»ºå¯¹è±¡ï¼Œ**åªæœ‰æ¯æ¬¡è·å–å¯¹è±¡æ—¶ï¼Œæ‰ä¼šé‡æ–°åˆ›å»ºå¯¹è±¡å®ä¾‹**

- `request`ï¼šWEB é¡¹ç›®ä¸­ï¼ŒSpring ä¸º**æ¯ä¸ªè¯·æ±‚**åˆ›å»ºä¸€ä¸ªbeanå®ä¾‹

- `session`ï¼šWEB é¡¹ç›®ä¸­ï¼ŒSpring ä¸º**æ¯ä¸ªä¼šè¯**åˆ›å»ºä¸€ä¸ªbeanå®ä¾‹

- `global-session`ï¼šä½œç”¨äº**é›†ç¾¤(Portlet)ç¯å¢ƒçš„å…¨å±€ä¼šè¯èŒƒå›´**ï¼Œå½“ä¸æ˜¯é›†ç¾¤(Portlet)ç¯å¢ƒæ—¶ï¼Œå®ƒå°±æ˜¯session

```java
/**
 * åŒ…æ‰«æ + æ³¨è§£
 */
// é…ç½®ç±»==é…ç½®æ–‡ä»¶
@Configuration// å‘Šè¯‰Springè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚è¯¥ç±»ä¸º å®¹å™¨æ„é€ å™¨å‚æ•°æ—¶ï¼Œå¯çœç•¥è¯¥æ³¨è§£ï¼ˆä¸æ¨èï¼‰
// æ¯æ¬¡æµ‹è¯•æ—¶è®°å¾—å°†å…¶ä»– @Configuration æ³¨é‡Šæ‰ï¼Œæˆ–ç€æ³¨é‡Šæ‰ @ComponentScan
public class IocConfig2 {

    @Bean
    @Scope("prototype")
    public Person person() {
        System.out.println("ç»™å®¹å™¨ä¸­æ·»åŠ  Bean person");
        return new Person("lisi",2);
    }
}
```





### @Primary ğŸ”¥

åœ¨Beanå¯¹è±¡æ·»åŠ æ­¤æ³¨è§£ï¼Œåˆ™**é¦–å…ˆæ³¨å…¥**è¿™ä¸ªBeanã€‚è‹¥`@Qualifier`æŒ‡å®šäº†ï¼Œåˆ™è¿™ä¸ªæ³¨è§£å¤±æ•ˆ





### @Conditional + Condition æ¥å£ ğŸ”¥

**æ¡ä»¶åˆ¤æ–­**ï¼Œ**æ»¡è¶³**å½“å‰æ¡ä»¶ï¼Œ**è¿™ä¸ª Bean æ‰èƒ½è¢«æ³¨å†Œåˆ°å®¹å™¨ä¸­**ã€‚**Spring Bootä¸­ä½¿ç”¨éå¸¸å¤š**

å¯ä»¥æ ‡åœ¨**ç±»**ï¼šæ»¡è¶³æ¡ä»¶åˆ™ç±»ä¸­æ‰€æœ‰ Bean æ‰ä¼šæ³¨å†Œ

å¯ä»¥æ ‡åœ¨**æ–¹æ³•**ï¼šåªé™åˆ¶è¿™ä¸ªæ–¹æ³•çš„ Bean

* `value`ä¸ºå®ç°äº†`Condition`æ¥å£çš„å®ç°ç±»æ•°ç»„ï¼Œå®ç°ç±»éœ€é‡å†™`matches`æ–¹æ³•

    ```java
    /**
     * Condition
     */
    // é…ç½®ç±»==é…ç½®æ–‡ä»¶
    @Configuration// å‘Šè¯‰Springè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚è¯¥ç±»ä¸º å®¹å™¨æ„é€ å™¨å‚æ•°æ—¶ï¼Œå¯çœç•¥è¯¥æ³¨è§£ï¼ˆä¸æ¨èï¼‰
    // æ¯æ¬¡æµ‹è¯•æ—¶è®°å¾—å°†å…¶ä»– @Configuration æ³¨é‡Šæ‰ï¼Œæˆ–ç€æ³¨é‡Šæ‰ @ComponentScan
    public class IocConfig3 {
    
        @Bean("mac-person")
        @Conditional(MacCondition.class)
        public Person person(){
            return new Person("mac",18);
        }
    
        //å¯ä»¥æ ‡åœ¨ç±»ï¼ˆæ»¡è¶³æ¡ä»¶åˆ™ç±»ä¸­æ‰€æœ‰Beanæ‰ä¼šæ³¨å†Œï¼‰å’Œæ–¹æ³•ï¼ˆåªé™åˆ¶è¿™ä¸ªæ–¹æ³•çš„Beanï¼‰ä¸Š
        @Conditional(LinuxCondition.class)
        @Bean("linus-person")
        public Person person02(){
            return new Person("linus", 48);
        }
    }
    ```

    ```java
    public class LinuxCondition implements Condition {
        /**
         *
         * @param context åˆ¤æ–­æ¡ä»¶èƒ½ä½¿ç”¨çš„ä¸Šä¸‹æ–‡ï¼ˆç¯å¢ƒï¼‰
         * @param metadata æ³¨é‡Šä¿¡æ¯
         * @return boolean
         */
        @Override
        public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
            //1ã€èƒ½è·å–åˆ°iocä½¿ç”¨çš„beanfactory
            ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();
            //2ã€è·å–ç±»åŠ è½½å™¨
            ClassLoader classLoader = context.getClassLoader();
            //3ã€è·å–å½“å‰ç¯å¢ƒä¿¡æ¯
            Environment environment = context.getEnvironment();
            //4ã€è·å–åˆ°beanå®šä¹‰çš„æ³¨å†Œç±»
            BeanDefinitionRegistry registry = context.getRegistry();
            //å¯ä»¥åˆ¤æ–­å®¹å™¨ä¸­çš„beanæ³¨å†Œæƒ…å†µï¼Œä¹Ÿå¯ä»¥ç»™å®¹å™¨ä¸­æ³¨å†Œbean
            boolean definition = registry.containsBeanDefinition("person");
    
            // ä¹Ÿå¯ä»¥ç›´æ¥è·å– application.yml ç­‰ä¸­çš„é…ç½®
            String property = environment.getProperty("os.name");
            System.out.println("os.name:"+property);
            return Objects.requireNonNull(property).contains("linux");
        }
    }
    ```

    ```java
    public class MacCondition implements Condition {
        /**
         *
         * @param context åˆ¤æ–­æ¡ä»¶èƒ½ä½¿ç”¨çš„ä¸Šä¸‹æ–‡ï¼ˆç¯å¢ƒï¼‰
         * @param metadata æ³¨é‡Šä¿¡æ¯
         * @return boolean
         */
        @Override
        public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
    
            //1ã€èƒ½è·å–åˆ°iocä½¿ç”¨çš„beanfactory
            ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();
            //2ã€è·å–ç±»åŠ è½½å™¨
            ClassLoader classLoader = context.getClassLoader();
            //3ã€è·å–å½“å‰ç¯å¢ƒä¿¡æ¯
            Environment environment = context.getEnvironment();
            //4ã€è·å–åˆ°beanå®šä¹‰çš„æ³¨å†Œç±»
            BeanDefinitionRegistry registry = context.getRegistry();
            //å¯ä»¥åˆ¤æ–­å®¹å™¨ä¸­çš„beanæ³¨å†Œæƒ…å†µï¼Œä¹Ÿå¯ä»¥ç»™å®¹å™¨ä¸­æ³¨å†Œbean
            boolean definition = registry.containsBeanDefinition("person");
    
            // ä¹Ÿå¯ä»¥ç›´æ¥è·å– application.yml ç­‰ä¸­çš„é…ç½®
            String property = environment.getProperty("os.name");
            System.out.println("os.name:"+property);
            return Objects.requireNonNull(property).contains("Mac");
        }
    }
    ```

    ```java
    public class IocConfig3Test {
    
        private ApplicationContext context;
    
        @BeforeEach
        public void init(){
            context = new AnnotationConfigApplicationContext(IocConfig3.class);
            System.out.println("å®¹å™¨åˆ›å»ºå®Œæˆ");
        }
    
        @Test
        public void test(){
        }
    
        @AfterEach
        public void destroy(){
    
            System.out.println("======è·å–å®¹å™¨ä¸­æ‰€æœ‰ Person bean åç§°=====");
            String[] beanNamesForType = context.getBeanNamesForType(Person.class);
            for (String s : beanNamesForType) {
                System.out.println(s);
            }
        }
    }
    ```



::: tip

Mac ä¸‹æ— æ³•é€šè¿‡ IDEA çš„ VM options æ¥åˆ‡æ¢ OS

:::



### @Conditional æ´¾ç”Ÿæ³¨è§£ ğŸ”¥

Springæ³¨è§£ç‰ˆåŸç”Ÿçš„@Conditionalä½œç”¨

ä½œç”¨ï¼šå¿…é¡»æ˜¯@Conditional**æŒ‡å®šçš„æ¡ä»¶æˆç«‹**ï¼Œæ‰ç»™å®¹å™¨ä¸­**æ·»åŠ ç»„ä»¶**ï¼Œ**é…ç½®ç±»**é‡Œé¢çš„æ‰€æœ‰å†…å®¹æ‰**ç”Ÿæ•ˆ**

| @Conditionalæ‰©å±•æ³¨è§£            | ä½œç”¨ï¼ˆåˆ¤æ–­æ˜¯å¦æ»¡è¶³å½“å‰æŒ‡å®šæ¡ä»¶ï¼‰                             |
| ------------------------------- | ------------------------------------------------------------ |
| @ConditionalOnJava              | ç³»ç»Ÿçš„ JVM ç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚                                  |
| @ConditionalOnBean              | å®¹å™¨ä¸­å­˜åœ¨æŒ‡å®šBean                                           |
| @ConditionalOnMissingBean       | å®¹å™¨ä¸­ä¸å­˜åœ¨æŒ‡å®šBean                                         |
| @ConditionalOnExpression        | æ»¡è¶³SpELè¡¨è¾¾å¼                                               |
| @ConditionalOnClass             | ç³»ç»Ÿä¸­æœ‰æŒ‡å®šçš„ç±»                                             |
| @ConditionalOnMissingClass      | ç³»ç»Ÿä¸­æ²¡æœ‰æŒ‡å®šçš„ç±»                                           |
| @ConditionalOnSingleCandidate   | å®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªæŒ‡å®šçš„Beanï¼Œæˆ–è€…æœ‰å¤šä¸ªï¼Œä½†æ˜¯è¿™ä¸ªBeanæ˜¯é¦–é€‰Bean |
| @ConditionalOnProperty          | ç³»ç»Ÿä¸­æŒ‡å®šçš„å±æ€§æ˜¯å¦æœ‰æŒ‡å®šçš„å€¼                               |
| @ConditionalOnResource          | **ç±»è·¯å¾„**ä¸‹æ˜¯å¦å­˜åœ¨æŒ‡å®šèµ„æºæ–‡ä»¶                             |
| @ConditionalOnWebApplication    | å½“å‰æ˜¯webç¯å¢ƒ                                                |
| @ConditionalOnNotWebApplication | å½“å‰ä¸æ˜¯webç¯å¢ƒ                                              |
| @ConditionalOnJndi              | JNDIå­˜åœ¨æ—¶æŸ¥æ‰¾æŒ‡å®šçš„ä½ç½®                                     |

**@ConditionalOnProperty**

```java
/**
 * ConditionalOnProperty
 */
// é…ç½®ç±»==é…ç½®æ–‡ä»¶
@Configuration// å‘Šè¯‰Springè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚è¯¥ç±»ä¸º å®¹å™¨æ„é€ å™¨å‚æ•°æ—¶ï¼Œå¯çœç•¥è¯¥æ³¨è§£ï¼ˆä¸æ¨èï¼‰
// æ¯æ¬¡æµ‹è¯•æ—¶è®°å¾—å°†å…¶ä»– @Configuration æ³¨é‡Šæ‰ï¼Œæˆ–ç€æ³¨é‡Šæ‰ @ComponentScan
public class IocConfig3 {

    // matchIfMissing é»˜è®¤ä¸º falseï¼Œæ”¹ä¸º true åï¼Œè‹¥ç³»ç»Ÿä¸­æ²¡æœ‰ os.name å±æ€§ï¼ˆä¸æ˜¯æ²¡æœ‰å€¼ï¼‰ï¼Œåˆ™é»˜è®¤æ³¨å…¥è¯¥ bean
    @Bean("mac-person")
    @ConditionalOnProperty(value="os.name", havingValue="Mac", matchIfMissing = true)
    public Person person(){
        return new Person("mac",18);
    }

    @ConditionalOnProperty(value="os.name", havingValue="linux")
    @Bean("linus-person")
    public Person person02(){
        return new Person("linus", 48);
    }
}
```






### @Profile ğŸ”¥

æŒ‡å®š**ç»„ä»¶**åœ¨å“ªä¸ªç¯å¢ƒçš„æƒ…å†µä¸‹æ‰èƒ½è¢«æ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼Œä¸æŒ‡å®šï¼Œä»»ä½•ç¯å¢ƒä¸‹éƒ½èƒ½æ³¨å†Œè¿™ä¸ªç»„ä»¶

* åŠ äº†ç¯å¢ƒæ ‡è¯†çš„**bean**ï¼Œåªæœ‰è¿™ä¸ªç¯å¢ƒè¢«æ¿€æ´»çš„æ—¶å€™æ‰èƒ½æ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚é»˜è®¤ä¸å†™æ˜¯defaultç¯å¢ƒï¼Œå³æ²¡æœ‰æ ‡æ³¨ç¯å¢ƒæ ‡è¯†çš„beanç»„ä»¶åœ¨ä»»ä½•ç¯å¢ƒä¸‹éƒ½å°†è¢«æ³¨å†Œåˆ°å®¹å™¨ä¸­

* å†™åœ¨**é…ç½®ç±»ä¸Š**ï¼Œåªæœ‰æ˜¯æŒ‡å®šçš„ç¯å¢ƒçš„æ—¶å€™ï¼Œæ•´ä¸ªé…ç½®ç±»é‡Œé¢çš„æ‰€æœ‰é…ç½®æ‰èƒ½å¼€å§‹ç”Ÿæ•ˆ

* å†™åœ¨**æ–¹æ³•**ä¸Šï¼Œåªé™å®šæ–¹æ³•è¿”å›çš„ Bean

    application.ymlï¼ˆç›®å‰è§£æåªèƒ½è¿™æ ·å†™ï¼Œç¼©è¿‘æ–¹å¼è·å–ä¸åˆ°ï¼‰

    ```yml
    db.url: jdbc:mysql://localhost:3306/test
    db.driverClass: com.mysql.cj.jdbc.Driver
    db.username: root
    db.password: 123456
    ```

    DataSourceConfig.Class

    ```java
    @Configuration
    @PropertySource("classpath:/application.yml")
    public class DataSourceConfig implements EmbeddedValueResolverAware {
    
        private StringValueResolver resolver;
    
        private String url;
    
        @Value("${db.username}")
        private String username;
    
        @Value("${db.driverClass}")
        private String driverClass;
    
        @Bean("hikariDataSource")
        @Profile({"prod"})
        public DataSource dataSourceProd(@Value("${db.password}") String password){
    
            HikariConfig config = new HikariConfig();
            url = resolver.resolveStringValue("${db.url}");
            config.setJdbcUrl(url);
            // config.setDriverClassName(driverClass);// è‡ªåŠ¨æ£€æµ‹
            config.setUsername(username);
            config.setPassword(password);
            return new HikariDataSource(config);
        }
    
    
        @Bean("druidDataSource")
        @Profile({"dev"})
        public DataSource dataSourceDev(@Value("${db.password}") String password){
            DruidDataSource druidDataSource = new DruidDataSource();
            url = resolver.resolveStringValue("${db.url}");
            druidDataSource.setUrl(url);
            // druidDataSource.setDriverClassName(driverClass);// è‡ªåŠ¨æ£€æµ‹
            druidDataSource.setUsername(username);
            druidDataSource.setPassword(password);
            return druidDataSource;
        }
    
        @Override
        public void setEmbeddedValueResolver(StringValueResolver resolver) {
            this.resolver = resolver;
        }
    }
    ```

ä½¿ç”¨ï¼ˆä¸¤ç§ï¼‰ï¼š

* è¿è¡Œæ—¶ä½¿ç”¨å‘½ä»¤è¡ŒåŠ¨æ€å‚æ•°ï¼šè™šæ‹Ÿæœºå‚æ•°ä½ç½®å†™ä¸Š`-Dspring.profiles.active=test`ã€‚Mac ä¸‹è¿˜æ˜¯å¤±è´¥ ğŸ˜£

* ä»£ç çš„æ–¹å¼æ¿€æ´»æŸç§ç¯å¢ƒ

    ```java
    public class ProfileTest {
    
        private AnnotationConfigApplicationContext context;
    
        @BeforeEach
        public void init(){
            // context = new AnnotationConfigApplicationContext(DataSourceConfig.class);
            context = new AnnotationConfigApplicationContext();
            // å¦‚ä¸‹å°±æ˜¯æœ‰å‚æ„é€ çš„å†…éƒ¨å®ç°ï¼Œå¤šäº†ç¯å¢ƒè®¾ç½®
            context.getEnvironment().setActiveProfiles("prod","test");// è®¾ç½®éœ€è¦æ¿€æ´»çš„ç¯å¢ƒ
            context.register(DataSourceConfig.class);// æ³¨å†Œä¸»é…ç½®ç±»
            context.refresh();// å¯åŠ¨åˆ·æ–°å®¹å™¨
            System.out.println("å®¹å™¨åˆ›å»ºå®Œæˆ");
        }
    
        @Test
        public void test1(){
        }
    
        @AfterEach
        public void destroy(){
            // è·å–å®¹å™¨ä¸­æ‰€æœ‰ bean åç§°
            System.out.println("======è·å–å®¹å™¨ä¸­æ‰€æœ‰ bean åç§°=====");
            String[] beanDefinitionNames = context.getBeanDefinitionNames();
            for (String beanDefinitionName : beanDefinitionNames) {
                System.out.println(beanDefinitionName);
            }
            System.out.println("======è·å–å®¹å™¨ä¸­æ‰€æœ‰ bean åç§°=====");
    
        }
    }
    ```







## æ³¨å†Œç»„ä»¶â€”@Import ğŸ”¥

::: tip

ç”¨äº**å¿«é€Ÿå¯¼å…¥å…¶ä»–é…ç½®ç±»ï¼ˆä¸åƒ@Beanåªèƒ½ä¸€ä¸ªä¸ªå¯¼å…¥ï¼‰**ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸º**ç›´æ¥å¯¼å…¥ç¬¬ä¸‰æ–¹ç»„ä»¶**ï¼Œåªèƒ½æ ‡æ³¨åœ¨ç±»ã€æ¥å£ã€æšä¸¾ç±»ä¸Š

:::

### Class

`value`ç”¨äºæŒ‡å®šå…¶ä»–é…ç½®ç±»çš„**Class**ï¼Œæ˜¯æ•°ç»„ï¼Œè¢«å¯¼å…¥çš„å…¶ä»–é…ç½®ç±»ä¹Ÿä¸ç”¨åŠ ä»»ä½•æ³¨è§£ï¼Œåªæ˜¯ä¸€ä¸ªæ™®é€šç±»

*   æ³¨å†Œçš„**Beançš„idä¸ºç»„ä»¶çš„å…¨ç±»å**
*   **è‹¥æ˜¯é…ç½®ç±»åˆ™è¿˜ä¼šæ³¨å†Œé…ç½®ç±»é…ç½®çš„Bean**ï¼ˆidä¸ºæŒ‡å®šçš„æˆ–æ–¹æ³•åï¼‰

```java
@Import({Color.class,Red.class,MyImportSelector.class,MyImportBeanDefinitionRegistrar.class})
//@Importå¯¼å…¥ç»„ä»¶ï¼Œidé»˜è®¤æ˜¯ç»„ä»¶çš„å…¨ç±»å
public class IOCConfig {}
```



### ImportSelector ğŸ”¥

`ImportSelector`æ¥å£ï¼šè¿”å›éœ€è¦å¯¼å…¥çš„ç»„ä»¶çš„å…¨ç±»åæ•°ç»„ï¼Œéœ€è¦è‡ªå®šä¹‰ç±»å®ç°è¯¥æ¥å£ã€‚**Springbootä¸­ä½¿ç”¨å¾ˆå¤š**ğŸ”¥

*   æ³¨å†Œçš„**Beançš„idä¸ºç»„ä»¶çš„å…¨ç±»å**

```java
/**
 * è‡ªå®šä¹‰é€»è¾‘è¿”å›éœ€è¦å¯¼å…¥çš„ç»„ä»¶
 */
public class MyImportSelector implements ImportSelector {
    /**
     *
     * @param importingClassMetadata å½“å‰æ ‡æ³¨@Importæ³¨è§£çš„ç±»çš„å…¶ä»–æ‰€æœ‰æ³¨è§£
     * @return è¦å¯¼å…¥åˆ°å®¹å™¨ä¸­çš„ç»„ä»¶å…¨ç±»å
     */
    @Override
    public String[] selectImports(AnnotationMetadata importingClassMetadata) {
        return new String[]{"top.conanan.bean.Yello",Blue.class.getName()};
    }

  	/**
  	 * TODO
  	 */
    @Override
    public Predicate<String> getExclusionFilter() {
        return null;
    }
}
```



### ImportBeanDefinitionRegistrar

`ImportBeanDefinitionRegistrar`æ¥å£ï¼Œæ‰‹åŠ¨æ³¨å†ŒBeanåˆ°å®¹å™¨ä¸­ï¼Œéœ€è¦è‡ªå®šä¹‰ç±»å®ç°è¯¥æ¥å£ã€‚**å¯ä»¥æŒ‡å®š bean åç§°**

```java
public class MyImportBeanDefinitionRegistrar implements ImportBeanDefinitionRegistrar {
    /**
     * æŠŠæ‰€æœ‰éœ€è¦æ·»åŠ åˆ°å®¹å™¨ä¸­çš„beanï¼›è°ƒç”¨BeanDefinitionRegistry.registerBeanDefinitionæ‰‹å·¥æ³¨å†Œè¿›æ¥
     *
     * @param importingClassMetadata å½“å‰æ ‡æ³¨@Importæ³¨è§£çš„ç±»çš„æ‰€æœ‰æ³¨è§£ä¿¡æ¯
     * @param registry BeanDefinitionæ³¨å†Œç±»
     * @param importBeanNameGenerator TODO
     */
    @Override
    public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry, BeanNameGenerator importBeanNameGenerator) {
        // æ³¨æ„ Bean åç§°
        boolean definition1 = registry.containsBeanDefinition("top.conanan.bean.Red");
        boolean definition2 = registry.containsBeanDefinition("top.conanan.bean.Yello");
        boolean definition3 = registry.containsBeanDefinition("top.conanan.bean.Blue");

        System.out.println(""+definition1+definition2+definition3);
        if (definition1 && definition2 && definition3){
            // æŒ‡å®š Bean çš„å®šä¹‰ä¿¡æ¯ï¼šBean çš„ç±»å‹ï¼ŒBean ...
            RootBeanDefinition rootBeanDefinition = new RootBeanDefinition(RainBow.class);
            // å¯ä»¥æŒ‡å®š bean åç§°
            registry.registerBeanDefinition("rainBow",rootBeanDefinition);
        }
    }
}
```



## æ³¨å†Œç»„ä»¶â€”FactoryBean ğŸ”¥

ä¸`@Import`**è°ƒç”¨æ— å‚æ„é€ åˆ›å»ºBean**ä¸åŒçš„æ˜¯ï¼Œå®ƒ**åˆ©ç”¨å·¥å‚è·å–Bean**ã€‚å¤šç”¨äº**æ•´åˆSpringå’Œå…¶ä»–æ¡†æ¶**çš„åº•å±‚ä»£ç 

ä¸èƒ½åœ¨ ColorFactoryBean ç±»ä¸Šä½¿ç”¨ @Component æ³¨è§£ï¼Œæ²¡ç”¨ï¼ï¼ï¼

```java
/**
 * åˆ›å»ºä¸€ä¸ªSpringå®šä¹‰çš„FactoryBeanï¼ŒèŒƒå‹ä»£è¡¨è¦åˆ›å»ºçš„å¯¹è±¡ç±»å‹
 */
public class ColorFactoryBean implements FactoryBean<Color> {
    /**
     * è¿”å›ä¸€ä¸ªColorå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šæ·»åŠ åˆ°å®¹å™¨ä¸­
     *
     * @return è¿”å›ä¸€ä¸ªColorå¯¹è±¡
     * @throws Exception
     */
    @Override
    public Color getObject() throws Exception {
        System.out.println("ColorFactoryBean...getObject...");
        return new Color();
    }

    @Override
    public Class<?> getObjectType() {
        return Color.class;
    }

    /**
     * æ§åˆ¶ Bean æ˜¯å¦ä¸ºå•ä¾‹
     * * trueï¼šè¿™ä¸ªbeanæ˜¯å•å®ä¾‹ï¼Œåœ¨å®¹å™¨ä¸­ä¿å­˜ä¸€ä»½
     * * falseï¼šå¤šå®ä¾‹ï¼Œæ¯æ¬¡è·å–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„beanï¼›
     */
    @Override
    public boolean isSingleton() {
        return true;
    }
}
```

```java
/**
 * FactoryBean
 */
// é…ç½®ç±»==é…ç½®æ–‡ä»¶
@Configuration// å‘Šè¯‰Springè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚è¯¥ç±»ä¸º å®¹å™¨æ„é€ å™¨å‚æ•°æ—¶ï¼Œå¯çœç•¥è¯¥æ³¨è§£ï¼ˆä¸æ¨èï¼‰ã€‚
// æ¯æ¬¡æµ‹è¯•æ—¶è®°å¾—å°†å…¶ä»– @Configuration æ³¨é‡Šæ‰ï¼Œæˆ–ç€æ³¨é‡Šæ‰ @ComponentScan
// @Import(ColorFactoryBean.class)// ä¹Ÿå¯ä»¥ä½¿ç”¨ @Bean æ¥æ³¨å†Œ beanï¼Œå¹¶å¯ä»¥è‡ªå®šä¹‰ bean name
public class IocConfig7 {

    @Bean
    public ColorFactoryBean colorFactoryBean(){
        return new ColorFactoryBean();
    }

}
```

```java
/**
 * FactoryBean
 */
public class IocConfig7Test {

    private ApplicationContext context;

    @BeforeEach
    public void init(){
        context = new AnnotationConfigApplicationContext(IocConfig7.class);
        System.out.println("å®¹å™¨åˆ›å»ºå®Œæˆ");
    }

    @Test
    public void test(){

        // å·¥å‚Beanè·å–çš„æ˜¯å·¥å‚beanè°ƒç”¨getObjectåˆ›å»ºçš„å¯¹è±¡ã€‚ä½†æ˜¯å®¹å™¨å†…å§‹ç»ˆæ²¡æœ‰é€šè¿‡getObjectåˆ›å»ºçš„å¯¹è±¡ï¼Œåªæœ‰ ColorFactoryBean
        Object bean1 = context.getBean("colorFactoryBean");
        System.out.println(bean1.getClass());// class top.conanan.bean.Color
        Color bean3 = context.getBean(Color.class);
        System.out.println(bean3.getClass());// class top.conanan.bean.Color

        // æŸ¥çœ‹ BeanFactory å·¥å‚ç±»æ¥å£å³å¯çœ‹åˆ°è¯¥ Fieldï¼š String FACTORY_BEAN_PREFIX = "&";
        Object bean2 = context.getBean("&colorFactoryBean");
        System.out.println(bean2.getClass());// class top.conanan.bean.ColorFactoryBean
        ColorFactoryBean bean4 = context.getBean(ColorFactoryBean.class);
        System.out.println(bean4.getClass());// class top.conanan.bean.ColorFactoryBean

        // No bean named 'top.conanan.bean.Color' available. Color,color éƒ½ä¸è¡Œ
        // Object color = context.getBean("color");
    }

    @AfterEach
    public void destroy(){
        // è·å–å®¹å™¨ä¸­æ‰€æœ‰ bean åç§°
        System.out.println("======è·å–å®¹å™¨ä¸­æ‰€æœ‰ bean åç§°=====");
        String[] beanDefinitionNames = context.getBeanDefinitionNames();
        for (String beanDefinitionName : beanDefinitionNames) {
            System.out.println(beanDefinitionName);
        }
        System.out.println("======è·å–å®¹å™¨ä¸­æ‰€æœ‰ bean åç§°=====");
    }
}
```



## æ³¨å†Œç»„ä»¶â€”æ€»ç»“

*   åŒ…æ‰«æ+ç»„ä»¶æ ‡æ³¨æ³¨è§£ï¼ˆ@Controller/@Service/@Repository/@Componentï¼‰ï¼š**è‡ªå·±å†™çš„ç±»**
*   `@Bean`ï¼šå¯¼å…¥çš„**ç¬¬ä¸‰æ–¹**åŒ…é‡Œé¢çš„ç»„ä»¶
*   `@Import`ï¼š**å¿«é€Ÿç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶**
    *   @Import(è¦å¯¼å…¥åˆ°å®¹å™¨ä¸­çš„ç»„ä»¶)ï¼›å®¹å™¨ä¸­å°±ä¼šè‡ªåŠ¨æ³¨å†Œè¿™ä¸ªç»„ä»¶ï¼Œidé»˜è®¤æ˜¯å…¨ç±»å
    *   ImportSelectorğŸ”¥ï¼šè¿”å›éœ€è¦å¯¼å…¥çš„ç»„ä»¶çš„å…¨ç±»åæ•°ç»„ã€‚Spring Boot ä¸­ä½¿ç”¨éå¸¸å¤š
    *   ImportBeanDefinitionRegistrarï¼šæ‰‹åŠ¨æ³¨å†Œbeanåˆ°å®¹å™¨ä¸­ï¼Œå¯æŒ‡å®šbeanåç§°
*   ä½¿ç”¨Springæä¾›çš„ `FactoryBean`ï¼ˆå·¥å‚Beanï¼‰ã€‚å¤šç”¨äº**æ•´åˆSpringå’Œå…¶ä»–æ¡†æ¶**çš„åº•å±‚ä»£ç 
    *   é»˜è®¤è·å–åˆ°çš„æ˜¯å·¥å‚beanè°ƒç”¨getObjectåˆ›å»ºçš„å¯¹è±¡
    *   è¦è·å–å·¥å‚Beanæœ¬èº«ï¼Œæˆ‘ä»¬éœ€è¦ç»™idå‰é¢åŠ ä¸€ä¸ª`&`ï¼Œ`&colorFactoryBean`
*   Spring è¿˜æä¾›äº†ä¸€ç§é‡‡ç”¨ç±»ä¼¼@Configuration + å®ç°æ¥å£çš„æ–¹å¼æ¥æ³¨å†Œç»„ä»¶



## æ³¨å…¥ç»„ä»¶â€”è‡ªåŠ¨æ³¨å…¥

::: tip

ä½œç”¨å’Œxmlé…ç½®æ–‡ä»¶ä¸­çš„`<bean>`æ ‡ç­¾ç¼–å†™`<property>`æ ‡ç­¾å®ç°åŠŸèƒ½ä¸€è‡´ã€‚åˆ©ç”¨DIå®Œæˆä¾èµ–å…³ç³»èµ‹å€¼

AutowiredAnnotationBeanPostProcessorï¼šåç½®å¤„ç†å™¨ï¼Œè§£æå®Œæˆè‡ªåŠ¨è£…é…åŠŸèƒ½ï¼ˆä»¥ä¸‹å››ä¸ªï¼‰	

:::



### @Autowired è¢«åŠ¨æ³¨å…¥ğŸ”¥

*   **byType**ï¼šä¸€èˆ¬**åœ¨ IoC å®¹å™¨å¯åŠ¨æ—¶**è‡ªåŠ¨**æŒ‰ç…§ç±»å‹æ³¨å…¥**ã€‚é¦–å…ˆæŒ‰ç…§ç±»å‹å»æ‰¾ï¼ˆ**åŒ…æ‹¬å­ç±»ã€å®ç°ç±»**ï¼‰ï¼Œå½“å®¹å™¨ä¸­**æœ‰å”¯ä¸€ä¸€ä¸ª** Bean å¯¹è±¡ç±»å‹å’Œè¦æ³¨å…¥çš„å˜é‡**ç±»å‹åŒ¹é…**ï¼Œå°±æ³¨å…¥æˆåŠŸï¼Œ**ä¸€ä¸ªéƒ½æ²¡æœ‰**åˆ™**æŠ¥é”™**ï¼Œæ— æ³•å¯åŠ¨ï¼ç±»æ¯”ä»…ä½¿ç”¨ IoC å®¹å™¨è·å– Beanã€‚

*   **byName**ï¼šå¦‚æœæœ‰**å¤šä¸ªç±»å‹åŒ¹é…åˆ°**ï¼Œåˆ™ä½¿ç”¨**å˜é‡åç§°**ä½œä¸º Bean çš„ idï¼Œåœ¨ Spring å®¹å™¨æŸ¥æ‰¾ï¼Œæ‰¾åˆ°äº†ä¹Ÿå¯ä»¥æ³¨å…¥æˆåŠŸï¼Œå¦åˆ™æŠ¥é”™ã€‚ç±»æ¯”ä»…ä½¿ç”¨ IoC å®¹å™¨è·å– Beanã€‚å¯ä»¥**æ®æ­¤æ¥æ³¨å…¥ä¸€ä¸ªæ¥å£ï¼Œä½†æ˜¯å˜é‡åç§°ä¿®æ”¹ä¸ºå®ç°ç±»çš„åç§°**ï¼Œå³å¯å®Œæˆ**åˆ‡æ¢**æ³¨å…¥å®ç°ç±»ï¼ˆä¸ç†æƒ³ï¼Œåç»­æ¨è**ä½¿ç”¨ @Qualifier æ›´æ–¹ä¾¿**ï¼Œå› ä¸º**ä¸ç”¨ä¿®æ”¹åé¢çš„ä»£ç **ï¼‰ã€‚
*   å¯ä»¥ä½¿ç”¨`required=false`æŒ‡å®šåï¼ŒIoC å®¹å™¨å¯åŠ¨æ—¶æ³¨å…¥å¤±è´¥ä¹Ÿä¸ä¼šæŠ¥é”™ï¼ˆäº†è§£ï¼‰

* å‡ºç°çš„ä½ç½®å¦‚ä¸‹ï¼š
    * æ ‡åœ¨æ„é€ å™¨ä¸Šï¼šå¦‚æœç»„ä»¶åªæœ‰ä¸€ä¸ªæ„é€ å™¨ä¸”ä¸ºæœ‰å‚æ„é€ å™¨ï¼Œè¿™ä¸ªæœ‰å‚æ„é€ å™¨çš„@Autowiredå¯ä»¥**çœç•¥**
    * @Bean + æ–¹æ³•å‚æ•°ï¼šå‚æ•°ä»å®¹å™¨ä¸­è·å–ï¼Œåˆ™@Autowiredå¯ä»¥**çœç•¥**



#### FIELD å±æ€§

Spring ä¸æ¨èï¼Œä½†æ˜¯æœ€æ–¹ä¾¿

```java
@ToString
public class Boss1 {

    @Autowired
    private Car car;

    public void print(){
        System.out.println(car);
    }
}
```

```java
public class Car {
}
```

```java
@Configuration
@Import({Boss1.class, Car.class})
public class DiConfig1 {

}
```

```java
public class DiConfig1Test {

    private ApplicationContext context;

    @BeforeEach
    public void init(){
        context = new AnnotationConfigApplicationContext(DiConfig1.class);
        System.out.println("å®¹å™¨åˆ›å»ºå®Œæˆ");
    }

    @Test
    public void test1(){
        Boss1 boss1 = context.getBean(Boss1.class);
        boss1.print();

        Car car = context.getBean(Car.class);
        System.out.println(car);// è¿™ä¸ªcarå’Œä¸Šé¢é‚£ä¸ªä¸€è‡´
    }
}
```







#### METHOD æ–¹æ³•æ³¨å…¥ï¼ˆsetter æ³¨å…¥ï¼‰

Spring å®¹å™¨åˆ›å»ºå½“å‰å¯¹è±¡æ—¶ï¼Œå°±ä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œå®Œæˆèµ‹å€¼ã€‚æ–¹æ³•å‚æ•°çš„å€¼ä¼šè‡ªåŠ¨ä»å®¹å™¨ä¸­è·å–

```java
@ToString
public class Boss2 {

    private Car car;

    public Car getCar() {
        return car;
    }

    @Autowired// å¿…é¡»æœ‰
    public void setCar(Car car) {
        this.car = car;
    }
}
```

```java
public class Car { }
```

```java
@Configuration
@Import({Boss2.class, Car.class})
public class DiConfig1 {

}
```

```java
public class DiConfig1Test {

    private ApplicationContext context;

    @BeforeEach
    public void init(){
        context = new AnnotationConfigApplicationContext(DiConfig1.class);
        System.out.println("å®¹å™¨åˆ›å»ºå®Œæˆ");
    }

    @Test
    public void test2(){
        Boss2 boss2 = context.getBean(Boss2.class);
        System.out.println(boss2);

        Car car = context.getBean(Car.class);
        System.out.println(car);// è¿™ä¸ªcarå’Œä¸Šé¢é‚£ä¸ªä¸€è‡´
    }
}
```





#### CONSTRUCTORâ€”æ„é€ å™¨

*   Spring å®˜æ–¹ä¸æ¨èä½¿ç”¨ Field æ³¨å…¥ï¼Œæ¨èä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼ˆå°±æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼‰ï¼Œå¹¶ä¸”å®¹æ˜“å¼•å‘**å¾ªç¯ä¾èµ–**ï¼

*   **å¦‚æœç»„ä»¶åªæœ‰ä¸€ä¸ªæ„é€ å™¨ä¸”æ˜¯æœ‰å‚æ„é€ å™¨**ï¼Œè¿™ä¸ªæœ‰å‚æ„é€ å™¨ä¸Šçš„@Autowiredå¯ä»¥**çœç•¥**

```java
@ToString
public class Boss3 {

    private Car car;

    public Boss3(){
        System.out.println("Boss3 æ— å‚æ„é€ ");
    }

    @Autowired// æœ‰å¤šä¸ªåˆ™ä¸èƒ½çœç•¥
    public Boss3(Car car){
        this.car = car;
        System.out.println("Boss3 æœ‰å‚æ„é€ ");
    }
}
```

```java
public class Car {
}
```

```java
@Configuration
@Import({Boss3.class, Car.class})
public class DiConfig1 {

}
```

```java
public class DiConfig1Test {

    private ApplicationContext context;

    @BeforeEach
    public void init(){
        context = new AnnotationConfigApplicationContext(DiConfig1.class);
        System.out.println("å®¹å™¨åˆ›å»ºå®Œæˆ");
    }

    @Test
    public void test3(){
        Boss3 boss3 = context.getBean(Boss3.class);
        System.out.println(boss3);

        Car car = context.getBean(Car.class);
        System.out.println(car);// è¿™ä¸ªcarå’Œä¸Šé¢é‚£ä¸ªä¸€è‡´
    }
}
```







#### PARAMETERâ€”å‚æ•° ğŸ”¥

*   @Bean+æ–¹æ³•å‚æ•°ï¼Œåˆ™å‚æ•°ä»å®¹å™¨ä¸­è·å–ï¼Œæ­¤æ—¶@Autowiredå¯ä»¥**çœç•¥**

```java
@ToString
public class Boss4 {

    private Car car;

    public Boss4(){
        System.out.println("Boss4 æ— å‚æ„é€ ");
    }

    public Boss4(Car car){
        this.car = car;
        System.out.println("Boss4 æœ‰å‚æ„é€ ");
    }
}
```

```java
public class Car {
}
```

```java
@Configuration
@Import({Car.class})
public class DiConfig1 {

    @Bean
    /*@Autowired*/
    public Boss4 boss4(/*@Autowired*/ Car car){
        return new Boss4(car);
    }
}
```

```java
public class DiConfig1Test {

    private ApplicationContext context;

    @BeforeEach
    public void init(){
        context = new AnnotationConfigApplicationContext(DiConfig1.class);
        System.out.println("å®¹å™¨åˆ›å»ºå®Œæˆ");
    }

	 @Test
    public void test4(){
        Boss4 boss4 = context.getBean(Boss4.class);
        System.out.println(boss4);

        Car car = context.getBean(Car.class);
        System.out.println(car);// è¿™ä¸ªcarå’Œä¸Šé¢é‚£ä¸ªä¸€è‡´
    }
}
```







### @Qualifier ä¸»åŠ¨æ³¨å…¥ğŸ”¥

*   åœ¨è‡ªåŠ¨æŒ‰ç…§ç±»å‹æ³¨å…¥çš„**åŸºç¡€ä¹‹ä¸Š**ï¼Œ**å†æŒ‰ç…§ Bean çš„ id æ³¨å…¥**

*   åœ¨ç»™**ç±»æˆå‘˜æ³¨å…¥æ—¶ä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼ˆé…åˆ @Autowiredï¼‰**ï¼Œä½†æ˜¯**ç»™æ–¹æ³•å‚æ•°æ³¨å…¥æ—¶å¯ä»¥å•ç‹¬ä½¿ç”¨**

- å±æ€§ï¼š`value`ç”¨äºæŒ‡å®šæ³¨å…¥çš„ Bean çš„ ID

*   æ³¨æ„ï¼š`@Qualifier`ç»™æ–¹æ³•å‚æ•°æ³¨å…¥æ—¶å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œç›´æ¥æŒ‡å®š Bean çš„ ID




### @Primary ğŸ”¥

åœ¨ @Bean å¯¹è±¡æ·»åŠ æ­¤æ³¨è§£ï¼Œåˆ™é¦–å…ˆæ³¨å…¥è¿™ä¸ªBeanã€‚è‹¥`@Qualifier`æŒ‡å®šäº†ï¼Œåˆ™è¿™ä¸ªæ³¨è§£å¤±æ•ˆ



### @Resource

JaveEEï¼ˆJSR250ï¼‰çš„æ³¨è§£ï¼Œè€¦åˆæ€§ä½

*   å¯ä»¥å’Œ@Autowiredä¸€æ ·å®ç°è‡ªåŠ¨è£…é…åŠŸèƒ½ï¼Œé»˜è®¤æ˜¯**æŒ‰ç…§ç»„ä»¶åç§°è¿›è¡Œè£…é…çš„**ï¼Œæ‰¾ä¸åˆ°å†çœ‹ç±»å‹è£…é…ã€‚å¯ä»¥ç‹¬ç«‹ä½¿ç”¨ã€‚

*   ä¸æ”¯æŒ@PrimaryåŠŸèƒ½ï¼›ä¸æ”¯æŒ@Autowiredï¼ˆreqiured=falseï¼‰;

- å±æ€§ï¼š`name`ç”¨äºæŒ‡å®šæ³¨å…¥çš„beançš„id



### @Inject

JaveEEï¼ˆJSR330ï¼‰çš„æ³¨è§£ï¼Œè€¦åˆæ€§ä½ï¼ˆä¹Ÿä¸ä¸€å®šï¼Œå¯¹äº Spring å¼€å‘æ¥è¯´ï¼‰

- éœ€è¦å¯¼å…¥`javax.inject`ä¾èµ–ã€‚
- å’Œ@Autowiredçš„åŠŸèƒ½ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨@Qualifierï¼Œåªæ˜¯æ²¡æœ‰required=falseçš„åŠŸèƒ½





## æ³¨å…¥ç»„ä»¶â€”Awareæ¥å£

è‹¥è‡ªå®šä¹‰ç»„ä»¶æƒ³è¦**ä½¿ç”¨ Spring å®¹å™¨åº•å±‚çš„ä¸€äº›ç»„ä»¶**ï¼Œå¦‚ï¼šApplicationContextï¼ŒBeanFactory ç­‰åˆ°

* è‡ªå®šä¹‰ç»„ä»¶éœ€è¦**å®ç° xxxAwar**eï¼ˆå‚è€ƒAwareæ¥å£è®¾è®¡ï¼‰ï¼šåœ¨**åˆ›å»ºè¯¥ç»„ä»¶å¯¹è±¡**çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨æ¥å£è§„å®šçš„æ–¹æ³•æ³¨å…¥ç›¸å…³ç»„ä»¶
* xxxAwareï¼š**åŠŸèƒ½å®ç°ä½¿ç”¨å¯¹åº”çš„xxxProcessor**ï¼Œå¦‚ï¼šApplicationContextAware â€”> ApplicationContextAwareProcessor

```java
public class Red implements ApplicationContextAware, BeanNameAware, EmbeddedValueResolverAware {

    private ApplicationContext context;

    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        this.context = applicationContext;
        System.out.println("ä¼ å…¥çš„IoC: " + applicationContext);
        // ä¼ å…¥çš„IoC: org.springframework.context.annotation.AnnotationConfigApplicationContext@df27fae, started on Wed May 06 00:37:46 CST 2020
    }

    @Override
    public void setBeanName(String name) {
        System.out.println("å½“å‰ bean çš„åå­—: " + name);
        // å½“å‰ bean çš„åå­—: top.conanan.aware.Red
    }

    @Override
    public void setEmbeddedValueResolver(StringValueResolver resolver) {
        String resolveStringValue = resolver.resolveStringValue("ä½ å¥½ ${os.name} æˆ‘æ˜¯ #{20*18}");
        System.out.println("è§£æçš„å­—ç¬¦ä¸²ï¼š"+resolveStringValue);
        // è§£æçš„å­—ç¬¦ä¸²ï¼šä½ å¥½ Mac OS X æˆ‘æ˜¯ 360
    }
}
```

```java
@Configuration
@Import(Red.class)
public class AwareConfig1 {

}
```

```java
public class AwareConfig1Test {

    private ApplicationContext context;

    @BeforeEach
    public void init(){
        context = new AnnotationConfigApplicationContext(AwareConfig1.class);
        System.out.println("å®¹å™¨åˆ›å»ºå®Œæˆ");
    }

    @Test
    public void test1(){
    }

    @AfterEach
    public void destroy(){
        // è·å–å®¹å™¨ä¸­æ‰€æœ‰ bean åç§°
        System.out.println("======è·å–å®¹å™¨ä¸­æ‰€æœ‰ bean åç§°=====");
        String[] beanDefinitionNames = context.getBeanDefinitionNames();
        for (String beanDefinitionName : beanDefinitionNames) {
            System.out.println(beanDefinitionName);
        }
        System.out.println("======è·å–å®¹å™¨ä¸­æ‰€æœ‰ bean åç§°=====");
    }
}
```





## è‡ªåŠ¨é…ç½® â€” @SpringBootApplication ğŸ”¥

### ä¸ºä»€ä¹ˆè¦æœ‰è‡ªåŠ¨è£…é…ï¼Ÿ ğŸ”¥

å¯¹æ¯” XML æ—¶ä»£çš„ Spring é…ç½®ï¼Œä¼šå‘ç°è™½ç„¶é¡¹ç›®ä¸åŒï¼Œä½†æ˜¯æœ‰é‚£ä¹ˆä¸€éƒ¨åˆ†ï¼ˆç”šè‡³ä¸€å¤§éƒ¨åˆ†ï¼‰çš„é…ç½®éƒ½æ˜¯ä¸å˜çš„ï¼Œåƒæ˜¯ä»ä¸€ä¸ªé¡¹ç›®å¤åˆ¶åˆ°å¦ä¸€ä¸ªé¡¹ç›®é‡Œã€‚è€Œ Spring Boot çš„å‡ºç°å°±æ˜¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œé€šè¿‡çº¦å®šå¤§äºé…ç½®æ¥é»˜è®¤è‡ªåŠ¨é…ç½®ã€‚



### @SpringBootApplication

æŒ‰ä½Ctrlç‚¹å‡»æŸ¥çœ‹å¯åŠ¨ç±»MySpringBootApplicationä¸Šçš„æ³¨è§£@SpringBootApplicationï¼Œæºç å¦‚ä¸‹ï¼š

```java
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@SpringBootConfiguration
@EnableAutoConfiguration
@ComponentScan(excludeFilters = {
		@Filter(type = FilterType.CUSTOM, classes = TypeExcludeFilter.class),
		@Filter(type = FilterType.CUSTOM, classes = AutoConfigurationExcludeFilter.class) })
public @interface SpringBootApplication {

	/**
	 * Exclude specific auto-configuration classes such that they will never be applied.
	 * @return the classes to exclude
	 */
	@AliasFor(annotation = EnableAutoConfiguration.class)
	Class<?>[] exclude() default {};

	... ... ...

}
```



### @SpringBootConfiguration

ç­‰åŒä¸`@Configuration`ï¼Œæ—¢æ ‡æ³¨è¯¥ç±»æ˜¯Springçš„ä¸€ä¸ªé…ç½®ç±»





### @EnableAutoConfiguration

SpringBoot è‡ªåŠ¨é…ç½®åŠŸèƒ½å¼€å¯ã€‚ä¸æ˜¯ç”¨äºè‡ªå·±å†™çš„ Beanï¼Œè€Œæ˜¯**é…ç½®ä¸‰æ–¹åº“ä¸­çš„ Bean**

æŒ‰ä½Ctrlç‚¹å‡»æŸ¥çœ‹è¯¥æ³¨è§£

```java
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@AutoConfigurationPackage
@Import(AutoConfigurationImportSelector.class)
public @interface EnableAutoConfiguration {
	... ... ...
}
```

#### @AutoConfigurationPackage

è‡ªåŠ¨é…ç½®åŒ…**ï¼Œ**å¦‚ä¸‹æ³¨è§£çš„ç®€å†™

```java
@Import(AutoConfigurationPackages.Registrar.class)
```



#### @Import

Springåº•å±‚æ³¨è§£`@Import`ï¼Œç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶ï¼›å¯¼å…¥çš„ç»„ä»¶ç”±`AutoConfigurationImportSelector.class`æŒ‡å®šï¼Œè¿™ä¸ªç±»æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œé€šè¿‡æ³¨è§£metadataï¼Œå°†ä¸»é…ç½®ç±»ï¼ˆ`@SpringBootApplication`ï¼‰æ‰€åœ¨åŒ…åŠä¸‹é¢æ‰€æœ‰å­åŒ…é‡Œé¢çš„æ‰€æœ‰ç»„ä»¶æ‰«æåˆ°Springå®¹å™¨

æŒ‰ä½Ctrlç‚¹å‡»æŸ¥çœ‹`AutoConfigurationImportSelector`æºç 

```java
public String[] selectImports(AnnotationMetadata annotationMetadata) {
    ... ... ...
        List<String> configurations = getCandidateConfigurations(annotationMetadata,
                                                                 attributes);
    configurations = removeDuplicates(configurations);
    Set<String> exclusions = getExclusions(annotationMetadata, attributes);
    checkExcludedClasses(configurations, exclusions);
    configurations.removeAll(exclusions);
    configurations = filter(configurations, autoConfigurationMetadata);
    fireAutoConfigurationImportEvents(configurations, exclusions);
    return StringUtils.toStringArray(configurations);
}


protected List<String> getCandidateConfigurations(AnnotationMetadata metadata,
                                                  AnnotationAttributes attributes) {
    List<String> configurations = SpringFactoriesLoader.loadFactoryNames(
        getSpringFactoriesLoaderFactoryClass(), getBeanClassLoader());

    return configurations;
}
```

å…¶ä¸­ï¼Œ`SpringFactoriesLoader.loadFactoryNames` æ–¹æ³•çš„ä½œç”¨å°±æ˜¯ä»`META-INF/spring.factories`æ–‡ä»¶ä¸­è¯»å–æŒ‡å®šç±»å¯¹åº”çš„**å…¨ç±»å**çš„åˆ—è¡¨ï¼Œå¦‚xxxAutoConfiguration

![1550170881470](../images/1550170881470.png)

`spring-autoconfigure-metadata.properties` æ–‡ä»¶ä¸­æœ‰å…³è‡ªåŠ¨é…ç½®çš„é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š

```
org.springframework.boot.autoconfigure.web.reactive.function.client.WebClientAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.DispatcherServletAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.error.ErrorMvcAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.MultipartAutoConfiguration,\
......
```

ä¸Šé¢é…ç½®æ–‡ä»¶å­˜åœ¨å¤§é‡çš„ä»¥Configurationä¸ºç»“å°¾çš„ç±»åç§°ï¼Œè¿™äº›ç±»å°±æ˜¯å­˜æœ‰è‡ªåŠ¨é…ç½®ä¿¡æ¯çš„ç±»ï¼Œè€ŒSpringApplicationåœ¨è·å–è¿™äº›ç±»ååå†åŠ è½½

æˆ‘ä»¬ä»¥`ServletWebServerFactoryAutoConfiguration`ä¸ºä¾‹æ¥åˆ†ææºç ï¼š

```java
@Configuration
@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE)
@ConditionalOnClass(ServletRequest.class)
@ConditionalOnWebApplication(type = Type.SERVLET)
@EnableConfigurationProperties(ServerProperties.class)
@Import({ ServletWebServerFactoryAutoConfiguration.BeanPostProcessorsRegistrar.class,
		ServletWebServerFactoryConfiguration.EmbeddedTomcat.class,
		ServletWebServerFactoryConfiguration.EmbeddedJetty.class,
		ServletWebServerFactoryConfiguration.EmbeddedUndertow.class })
public class ServletWebServerFactoryAutoConfiguration {
	......
}

```

å…¶ä¸­ï¼Œ`@EnableConfigurationProperties(ServerProperties.class) `ä»£è¡¨åŠ è½½`ServerProperties`æœåŠ¡å™¨é…ç½®å±æ€§ç±»

è¿›å…¥ServerProperties.classæºç å¦‚ä¸‹ï¼š

```java
@ConfigurationProperties(prefix = "server", ignoreUnknownFields = true)
public class ServerProperties {
    /**
	 * Server HTTP port.
	 */
    private Integer port;
    /**
	 * Network address to which the server should bind.
	 */
    private InetAddress address;
	......
}

```

å…¶ä¸­ï¼Œ`prefix = "server"` è¡¨ç¤ºSpringBooté…ç½®æ–‡ä»¶ä¸­çš„å‰ç¼€ï¼ŒSpringBootä¼šå°†é…ç½®æ–‡ä»¶ä¸­ä»¥serverå¼€å§‹çš„å±æ€§æ˜ å°„åˆ°è¯¥ç±»çš„å­—æ®µä¸­ã€‚å¦‚åœ¨`application.properties`ä¸­é…ç½®`server.port=80`å³å¯æ”¹å˜å½“å‰æœåŠ¡å™¨çš„HTTPç«¯å£å·



**è‡ªåŠ¨é…ç½®æ€»ç»“**

- **SpringBootå¯åŠ¨ä¼šåŠ è½½å¤§é‡çš„è‡ªåŠ¨é…ç½®ç±»**
- **æˆ‘ä»¬çœ‹æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½æœ‰æ²¡æœ‰SpringBooté»˜è®¤å†™å¥½çš„è‡ªåŠ¨é…ç½®ç±»ï¼›**
- **æˆ‘ä»¬å†æ¥çœ‹è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»ä¸­åˆ°åº•é…ç½®äº†å“ªäº›ç»„ä»¶ï¼›ï¼ˆåªè¦æˆ‘ä»¬è¦ç”¨çš„ç»„ä»¶æœ‰ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦å†æ¥é…ç½®äº†ï¼‰**
- **ç»™å®¹å™¨ä¸­è‡ªåŠ¨é…ç½®ç±»æ·»åŠ ç»„ä»¶çš„æ—¶å€™ï¼Œä¼šä»propertiesç±»ä¸­è·å–æŸäº›å±æ€§ã€‚æˆ‘ä»¬å°±å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šè¿™äº›å±æ€§çš„å€¼ï¼›**
- **è‡ªåŠ¨é…ç½®ç±»å¯¹åº”å±æ€§ç±»**
    - xxxxAutoConfigurartionï¼šè‡ªåŠ¨é…ç½®ç±»ï¼›ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶
    - xxxxProperties:å°è£…é…ç½®æ–‡ä»¶ä¸­ç›¸å…³å±æ€§ï¼›





### SPI æœºåˆ¶çš„åº”ç”¨ ğŸ”¥

Service Provider Interfaceï¼Œåº”å¯¹å˜åŒ–çš„è§£å†³æ–¹æ¡ˆï¼Œä¸Šé¢çš„ @EnableXXX å°±æ˜¯å¯¹ SPI çš„åº”ç”¨ã€‚**åŸºäº Interface æ¥å£ + ç­–ç•¥æ¨¡å¼ + é…ç½®æ–‡ä»¶ï¼ˆå¦‚ spring.factoriesï¼‰**ã€‚

ä¹‹å‰è®²è¿‡çš„ @Primary å’Œ @Conditionxx ä¹Ÿå¯ä»¥è§£å†³ï¼Œä½†æ˜¯å…³æ³¨çš„ç²’åº¦æ˜¯**å…·ä½“**ç±»ã€å¯¹è±¡ã€‚è€Œ SPI å…³æ³¨çš„æ˜¯**æ•´ä½“è§£å†³æ–¹æ¡ˆ**ï¼Œå…³æ³¨è®¸å¤šç±»ï¼Œå¯¹è±¡çš„æ•´ä½“ï¼







## å‚è€ƒ

*   [Spring Component Scan](https://dzone.com/articles/spring-component-scan)





## XML é…ç½®ï¼ˆæ—§ï¼‰

### æ­¥éª¤

1. åœ¨resourcesä¸­åˆ›å»º`spring-config.xml`æˆ–`applicationContext.xml`æ–‡ä»¶ã€‚ï¼ˆçº¦æŸåœ¨å‚è€ƒä¸­æœç´¢`xmlns`å³å¯æ‰¾åˆ°ï¼‰

    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <beans xmlns="http://www.springframework.org/schema/beans"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd">
    </beans>
    ```

2. åœ¨é…ç½®æ–‡ä»¶ä¸­**é…ç½®è®© spring åˆ›å»ºçš„å¯¹è±¡**ï¼ˆåŸç†å’Œå¼•å…¥ä¸­å·¥å‚æ¨¡å¼ä¸€è‡´ï¼‰

    ```xml
    <bean id="accountDao" class="com.itheima.dao.impl.AccountDaoImpl"></bean>
    <bean id="accountService" class="com.itheima.service.impl.AccountServiceImpl"></bean>
    ```

3. è·å–Spring IoCæ ¸å¿ƒå®¹å™¨ï¼Œå¹¶æ ¹æ®idè·å–å¯¹è±¡

    ```java
    ApplicationContext ac = new ClassPathXmlApplicationContext("spring-config.xml");
    AccountDao accountDao = (AccountDao) ac.getBean("accountDao"); //éœ€è¦å¼ºè½¬
    AccountService accountService = ac.getBean("accountService", AccountService.class); //ä¼ å­—èŠ‚ç æ–‡ä»¶å¯¹è±¡ï¼Œä¸ç”¨å¼ºè½¬
    ```





### Spirngå¯¹Beançš„ç®¡ç†ç»†èŠ‚

**beanæ ‡ç­¾**

* ä½œç”¨ï¼š**é…ç½®å¯¹è±¡è®©springæ¥åˆ›å»ºçš„**ã€‚é»˜è®¤æƒ…å†µä¸‹å®ƒè°ƒç”¨çš„æ˜¯ç±»ä¸­çš„**æ— å‚æ„é€ å‡½æ•°**ã€‚å¦‚æœæ²¡æœ‰æ— å‚æ„é€ å‡½æ•°åˆ™ä¸èƒ½åˆ›å»ºæˆåŠŸã€‚ 
* å±æ€§ï¼š
    * **`id`**ï¼šç»™å¯¹è±¡åœ¨å®¹å™¨ä¸­æä¾›ä¸€ä¸ª**å”¯ä¸€æ ‡è¯†**ï¼Œç”¨äºè·å–å¯¹è±¡
    * **`class`**ï¼šæŒ‡å®š**ç±»çš„å…¨é™å®šç±»å**ï¼Œç”¨äº**åå°„åˆ›å»ºå¯¹è±¡**ï¼Œé»˜è®¤æƒ…å†µä¸‹è°ƒç”¨æ— å‚æ„é€ å‡½æ•°
    * **`scope`**ï¼š**æŒ‡å®šå¯¹è±¡çš„ä½œç”¨èŒƒå›´**
        * **`singleton`**ï¼š**å•ä¾‹**çš„ï¼ˆé»˜è®¤ï¼‰ï¼Œä¸€ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹ï¼Œå®ƒçš„ä½œç”¨èŒƒå›´å°±æ˜¯**æ•´ä¸ªåº”ç”¨** 
        * **`prototype`**ï¼š**å¤šä¾‹**çš„ï¼Œæ¯æ¬¡è®¿é—®å¯¹è±¡æ—¶ï¼Œéƒ½ä¼šé‡æ–°åˆ›å»ºå¯¹è±¡å®ä¾‹ã€‚
        * `request`ï¼šWEB é¡¹ç›®ä¸­ï¼ŒSpring ä¸º**æ¯ä¸ªè¯·æ±‚**åˆ›å»ºä¸€ä¸ªbeanå®ä¾‹
        * `session`ï¼šWEB é¡¹ç›®ä¸­ï¼ŒSpring ä¸º**æ¯ä¸ªä¼šè¯**åˆ›å»ºä¸€ä¸ªbeanå®ä¾‹
        * `global-session`ï¼šä½œç”¨äº**é›†ç¾¤(Portlet)ç¯å¢ƒçš„å…¨å±€ä¼šè¯èŒƒå›´**ï¼Œå½“ä¸æ˜¯é›†ç¾¤(Portlet)ç¯å¢ƒæ—¶ï¼Œå®ƒå°±æ˜¯session
    * `init-method`ï¼šæŒ‡å®šç±»ä¸­çš„åˆå§‹åŒ–æ–¹æ³•åç§°
    * `destroy-method`ï¼šæŒ‡å®šç±»ä¸­é”€æ¯æ–¹æ³•åç§°ã€‚å•ä¾‹ä¸­éœ€è¦å…³é—­å®¹å™¨ï¼ˆä½¿ç”¨å®ç°ç±»çš„æ–¹æ³•ï¼‰

**Beanå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ**

- **å•ä¾‹å¯¹è±¡ï¼šç”Ÿå‘½å‘¨æœŸå’Œå®¹å™¨ç›¸åŒ**ï¼Œä¸€ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹ï¼Œå®ƒçš„ä½œç”¨èŒƒå›´å°±æ˜¯æ•´ä¸ªåº”ç”¨
    - å‡ºç”Ÿï¼šå½“å®¹å™¨åˆ›å»ºæ—¶å‡ºç”Ÿï¼ˆè¯»å–å®Œé…ç½®æ–‡ä»¶ï¼‰
    - å­˜æ´»ï¼šåªè¦å®¹å™¨å­˜åœ¨ï¼Œå¯¹è±¡ä¸€ç›´å­˜æ´»
    - æ­»äº¡ï¼šå®¹å™¨é”€æ¯ï¼Œå¯¹è±¡æ¶ˆäº¡
- **å¤šä¾‹å¯¹è±¡**ï¼šæ¯æ¬¡è®¿é—®å¯¹è±¡æ—¶ï¼Œéƒ½ä¼šé‡æ–°åˆ›å»ºå¯¹è±¡å®ä¾‹ã€‚
    - **å‡ºç”Ÿ**ï¼šå½“æˆ‘ä»¬**ä½¿ç”¨å¯¹è±¡**æ—¶ï¼Œ**Springæ¡†æ¶ä¸ºæˆ‘ä»¬åˆ›å»º**
    - **å­˜æ´»**ï¼šå¯¹è±¡åªè¦åœ¨**ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå°±ä¸€ç›´å­˜æ´»**
    - **æ­»äº¡**ï¼šå½“å¯¹è±¡**é•¿æ—¶é—´ä¸ä½¿ç”¨ï¼Œä¸”æ²¡æœ‰åˆ«çš„å¯¹è±¡å¼•ç”¨**æ—¶ï¼Œç”±Javaçš„**GC**æœºåˆ¶å›æ”¶

**åˆ›å»ºBeançš„ä¸‰ç§æ–¹å¼**

1. **ä½¿ç”¨é»˜è®¤æ„é€ æ–¹æ³•åˆ›å»º**

    é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨`bean`æ ‡ç­¾ä»¥åŠ`id`å’Œ`class`å±æ€§ï¼Œä¸”æ²¡æœ‰å…¶ä»–å±æ€§å’Œæ ‡ç­¾æ—¶~ã€‚è‹¥ç±»ä¸­æ²¡æœ‰é»˜è®¤æ„é€ æ–¹æ³•ï¼Œåˆ™å¯¹è±¡æ— æ³•åˆ›å»º

    ```xml
    <bean id="accountDao" class="com.itheima.dao.impl.AccountDaoImpl"></bean>
    ```

2. ä½¿ç”¨**æ™®é€šå·¥å‚ä¸­çš„æ–¹æ³•**åˆ›å»ºå¯¹è±¡ï¼ˆä¹Ÿç§°ä½¿ç”¨æŸä¸ªç±»ä¸­çš„æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼‰ï¼Œå¹¶å­˜å…¥Spirngå®¹å™¨

    ```xml
    <bean id="accountDaoFactory" class="com.itheima.factory.AccountDaoFactory"></bean>
    <bean id="accountDao" factory-bean="accountDaoFactory" factory-method="getAccountDao"></bean>
    ```

3. ä½¿ç”¨**é™æ€å·¥å‚ä¸­çš„é™æ€æ–¹æ³•**åˆ›å»ºå¯¹è±¡ï¼ˆä¹Ÿç§°ä½¿ç”¨æŸä¸ªç±»ä¸­çš„é™æ€æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼‰ï¼Œå¹¶å­˜å…¥Spirngå®¹å™¨

    ```xml
    <bean id="accountDao" class="com.itheima.factory.AccountDaoFactory" factory-method="getAccountDao"></bean>
    ```



### ä¾èµ–æ³¨å…¥

> æˆ‘ä»¬çš„ä¸šåŠ¡å±‚ä»ä¼šè°ƒç”¨æŒä¹…å±‚çš„æ–¹æ³•ï¼Œåœ¨ä½¿ç”¨ spring ä¹‹åï¼Œå°±è®© **spring æ¥ç»´æŠ¤**äº†ä»–ä»¬çš„**ä¾èµ–å…³ç³»**ã€‚å°±æ˜¯è®©æ¡†æ¶æŠŠæŒä¹…å±‚å¯¹è±¡ä¼ å…¥ä¸šåŠ¡å±‚ï¼Œä¸ç”¨è‡ªå·±å»è·å–ã€‚

DIï¼ˆDependency Injectionï¼‰ï¼š**ä¾èµ–æ³¨å…¥**ï¼Œå³æ˜¯**ä¾èµ–å…³ç³»çš„ç»´æŠ¤**äº¤ç”±Spirngç®¡ç†ã€‚

èƒ½æ³¨å…¥çš„æ•°æ®æœ‰ä¸‰ç±»ï¼šï¼ˆä¸é€‚ç”¨äºç»å¸¸å˜æ¢çš„æ•°æ®ï¼‰

* **åŸºæœ¬ç±»å‹å’ŒString**
* **å…¶ä»–beanç±»å‹**ï¼ˆåœ¨é…ç½®æ–‡ä»¶æˆ–æ³¨è§£ä¸­é…ç½®è¿‡çš„beanï¼‰
* **å¤æ‚ç±»å‹/é›†åˆç±»å‹**ï¼šå¦‚Arrayã€Listã€Setã€Mapã€Properties



**æ„é€ æ–¹æ³•æ³¨å…¥**

ä½¿ç”¨ç±»ä¸­çš„æ„é€ æ–¹æ³•ç»™æˆå‘˜å˜é‡èµ‹å€¼ã€‚æ³¨æ„ï¼šèµ‹å€¼çš„æ“ä½œä¸æ˜¯æˆ‘ä»¬è‡ªå·±åšçš„ï¼Œè€Œæ˜¯é€šè¿‡é…ç½®çš„æ–¹å¼ï¼Œè®©springæ¡†æ¶æ¥ä¸ºæˆ‘ä»¬æ³¨å…¥

* è¦æ±‚ï¼šç±»ä¸­éœ€è¦æä¾›ä¸€ä¸ª**å¯¹åº”å‚æ•°åˆ—è¡¨çš„æ„é€ æ–¹æ³•**
* æ ‡ç­¾ï¼š`bean`æ ‡ç­¾ä¸­**`constructor-arg`**
    * å±æ€§ï¼š
        * ~~`index`ï¼šæŒ‡å®šå‚æ•°åœ¨æ„é€ å‡½æ•°å‚æ•°åˆ—è¡¨çš„ç´¢å¼•ä½ç½®ï¼Œä»0å¼€å§‹ã€‚ä¸å¸¸ç”¨ã€‚~~
        * ~~`type`ï¼šæŒ‡å®šå‚æ•°åœ¨æ„é€ å‡½æ•°ä¸­çš„æ•°æ®ç±»å‹ã€‚ä¸å¸¸ç”¨ã€‚~~
        * **`name`**ï¼šæŒ‡å®š**å‚æ•°åœ¨æ„é€ å‡½æ•°ä¸­çš„åç§°**
        * **`value`**ï¼šå®ƒèƒ½èµ‹çš„å€¼æ˜¯**åŸºæœ¬æ•°æ®ç±»å‹**å’Œ **String ç±»å‹** 
        * **`ref`**ï¼šå®ƒèƒ½èµ‹çš„å€¼æ˜¯**å…¶ä»– bean ç±»å‹**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¿…é¡»å¾—æ˜¯**é…ç½®è¿‡çš„ bean** 

```xml
<bean id="accountService" class="com.itheima.service.impl.AccountServiceImpl"> 
    <constructor-arg name="name" value=" å¼ ä¸‰ "></constructor-arg>  <!--Stringç±»å‹-->
    <constructor-arg name="age" value="18"></constructor-arg>       <!--åŸºæœ¬ç±»å‹-->
    <constructor-arg name="birthday" ref="now"></constructor-arg>   <!--å…¶ä»–beanç±»å‹-->
</bean> 
<bean id="now" class="java.util.Date"></bean> 
```

* ä¼˜åŠ¿ï¼šåœ¨è·å–beanå¯¹è±¡æ—¶ï¼Œæ³¨å…¥æ•°æ®æ˜¯å¿…é¡»çš„æ“ä½œï¼Œå¦åˆ™å¯¹è±¡æ— æ³•åˆ›å»ºæˆåŠŸã€‚
* å¼Šç«¯ï¼šä¼˜åŠ¿ä¹Ÿæ˜¯å…¶å¼Šç«¯ï¼Œæ”¹å˜äº†beanå¯¹è±¡çš„å®ä¾‹åŒ–æ–¹å¼ã€‚åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå³ä½¿ç”¨ä¸åˆ°è¿™äº›æ•°æ®ï¼Œä¹Ÿå¿…é¡»æä¾›ã€‚

> c-å‘½åç©ºé—´æ³¨å…¥ï¼ˆæœ¬è´¨æ˜¯æ„é€ æ–¹æ³•æ³¨å…¥ï¼‰ï¼šæ— æ³•å®ç°è£…é…é›†åˆ



**setæ–¹æ³•æ³¨å…¥(ä½¿ç”¨æœ€å¤š)**

* è¦æ±‚ï¼šå°±æ˜¯åœ¨ç±»ä¸­**æä¾›éœ€è¦æ³¨å…¥æˆ**å‘˜çš„ **set æ–¹æ³•**
* æ ‡ç­¾ï¼š`bean`æ ‡ç­¾ä¸­**`property`**
    * å±æ€§ï¼š
        * **`name`**ï¼šæ‰¾çš„æ˜¯ç±»ä¸­ **set æ–¹æ³•åé¢çš„éƒ¨åˆ†** 
        * **`value`**ï¼šå®ƒèƒ½èµ‹çš„å€¼æ˜¯**åŸºæœ¬æ•°æ®ç±»å‹**å’Œ **String ç±»å‹**
        * **`ref`**ï¼šå®ƒèƒ½èµ‹çš„å€¼æ˜¯**å…¶ä»– bean ç±»å‹**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¿…é¡»å¾—æ˜¯**é…ç½®è¿‡çš„ bean** 

```xml
<bean id="accountService" class="com.itheima.service.impl.AccountServiceImpl">   
    <property name="name" value="test"></property> <!--Stringç±»å‹-->
    <property name="age" value="21"></property>    <!--åŸºæœ¬ç±»å‹-->
    <property name="birthday" ref="now"></property> <!--å…¶ä»–beanç±»å‹-->
</bean> 
<bean id="now" class="java.util.Date"></bean>
```

* ä¼˜åŠ¿ï¼šåˆ›å»ºå¯¹è±¡æ—¶ï¼Œæ³¨å…¥çš„å‚æ•°æ²¡æœ‰æ˜ç¡®é™åˆ¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤æ„é€ æ–¹æ³•
* å¼Šç«¯ï¼šä¼˜åŠ¿ä¹Ÿæ˜¯å…¶å¼Šç«¯ï¼Œè‹¥æŸä¸ªæˆå‘˜å¿…é¡»æœ‰å€¼ï¼Œåˆ™è·å–å¯¹è±¡æ—¶æœ‰å¯èƒ½setæ–¹æ³•æ²¡æœ‰æ‰§è¡Œ

> p-å‘½åç©ºé—´æ³¨å…¥ï¼ˆæœ¬è´¨è¿˜æ˜¯è°ƒç”¨ set æ–¹æ³•ï¼‰ï¼šæ— æ³•å®ç°è£…é…é›†åˆ



**æ³¨å…¥é›†åˆå±æ€§**

å°±æ˜¯ç»™ç±»ä¸­çš„**é›†åˆæˆå‘˜ä¼ å€¼**ï¼Œå¯ä»¥é‡‡ç”¨setæ–¹æ³•æ³¨å…¥çš„æ–¹å¼ï¼Œåªä¸è¿‡å˜é‡çš„æ•°æ®ç±»å‹éƒ½æ˜¯é›†åˆ

* æ³¨å…¥é›†åˆæ•°æ®ï¼šåªè¦**ç»“æ„ç›¸åŒï¼Œæ ‡ç­¾å¯ä»¥äº’æ¢**
    * Listç»“æ„å¯ä»¥ç”¨ï¼šarrayã€listã€set
    * Mapç»“æ„å¯ä»¥ç”¨ï¼šmapã€entryï¼›propsã€propã€‚ä½†æ˜¯propertiesåªèƒ½å­˜å‚¨é”®å€¼éƒ½æ˜¯å­—ç¬¦ä¸²çš„æ•°æ®ã€‚

```xml
<bean id="accountService" class="com.itheima.service.impl.AccountServiceImpl"> 
 <!-- åœ¨æ³¨å…¥é›†åˆæ•°æ®æ—¶ï¼Œåªè¦ç»“æ„ç›¸åŒï¼Œæ ‡ç­¾å¯ä»¥äº’æ¢ -->  
    <!-- ç»™æ•°ç»„æ³¨å…¥æ•°æ® -->  
    <property name="myStrs"> 
        <set>    
            <value>AAA</value>    
            <ref bean="car"></ref><!--ä¹Ÿå¯ä»¥å¼•ç”¨ç±»å‹ã€‚åªæ˜¯åˆ—å‡ºæ¥å‚è€ƒï¼Œå®é™…ä¸ä¼šè¿™æ ·å­˜å‚¨ä¸åŒç±»å‹æ•°æ®-->
        </set> 
    </property> 
    <!-- æ³¨å…¥ list é›†åˆæ•°æ® -->  
    <property name="myList">   
        <array>    
            <value>AAA</value>    
            <ref bean="car"></ref><!--ä¹Ÿå¯ä»¥å¼•ç”¨ç±»å‹ã€‚åªæ˜¯åˆ—å‡ºæ¥å‚è€ƒï¼Œå®é™…ä¸ä¼šè¿™æ ·å­˜å‚¨ä¸åŒç±»å‹æ•°æ®-->
        </array>  
    </property>  
    <!-- æ³¨å…¥ set é›†åˆæ•°æ® -->  
    <property name="mySet"> 
        <list>    
            <value>AAA</value>    
            <ref bean="car"></ref><!--ä¹Ÿå¯ä»¥å¼•ç”¨ç±»å‹ã€‚åªæ˜¯åˆ—å‡ºæ¥å‚è€ƒï¼Œå®é™…ä¸ä¼šè¿™æ ·å­˜å‚¨ä¸åŒç±»å‹æ•°æ®-->
        </list>  
    </property> 
    <!--=============================================-->
    <!-- æ³¨å…¥ Map æ•°æ® -->  
    <property name="myMap">   
        <map>    
            <entry key="testA" value="aaa"></entry> 
            <entry key-ref="car" value-ref="car"></entry> <!--key,value,key-ref,value-ref  å…±4ç§ç»„åˆ -->
            
            <!--value-type="cn.itcast.pojo.Car"   å¯ä»¥ä¸è®¾ç½®ï¼Œè®¾ç½®åå€¼ç±»å‹å”¯ä¸€-->
      <!--  <entry key="testB">   ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼Œä½†æ˜¯éº»çƒ¦  
                <value>bbb</value> 
            </entry>  --> 
        </map>
    </property> 
    <!-- æ³¨å…¥ properties æ•°æ®--> 
    <property name="myProps"> 
          <props> 
            <prop key="testA">aaa</prop>    
            <prop key="testB">bbb</prop>   
        </props> 
    </property> 
</bean>
<!--========================è¢«å¼•ç”¨çš„æµ‹è¯•bean =====================================-->
<bean name="car" class="cn.itcast.pojo.Car">
    <property name="name" value="BMW"></property>
    <property name="color" value="red"></property>
</bean>
```



