(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{567:function(s,a,v){s.exports=v.p+"assets/img/20200608142523.5eacb0fa.png"},568:function(s,a,v){s.exports=v.p+"assets/img/20200608142541.6a998b9a.png"},569:function(s,a,v){s.exports=v.p+"assets/img/image-20210322224952967.a120b432.png"},570:function(s,a,v){s.exports=v.p+"assets/img/image-20210322231343462.f6a0ab20.png"},571:function(s,a,v){s.exports=v.p+"assets/img/image-20210322233538723.1481728b.png"},572:function(s,a,v){s.exports=v.p+"assets/img/image-20210322235031635.db1258e5.png"},573:function(s,a,v){s.exports=v.p+"assets/img/image-20210322235807544.a444d842.png"},574:function(s,a,v){s.exports=v.p+"assets/img/image-20210323000007405.dc8b6833.png"},575:function(s,a,v){s.exports=v.p+"assets/img/image-20210323000635512.0efbd1ce.png"},576:function(s,a,v){s.exports=v.p+"assets/img/image-20210323000657592.a8b57858.png"},577:function(s,a,v){s.exports=v.p+"assets/img/image-20210323000804799.19e06879.png"},578:function(s,a,v){s.exports=v.p+"assets/img/image-20210324173958322.d2f0583e.png"},579:function(s,a,v){s.exports=v.p+"assets/img/image-20210324181416803.9b6dadea.png"},754:function(s,a,v){"use strict";v.r(a);var t=v(11),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"æŒä¹…åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æŒä¹…åŒ–"}},[s._v("#")]),s._v(" æŒä¹…åŒ–")]),s._v(" "),t("h2",{attrs:{id:"ç®€ä»‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç®€ä»‹"}},[s._v("#")]),s._v(" ç®€ä»‹")]),s._v(" "),t("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯æŒä¹…åŒ–ï¼Ÿ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯æŒä¹…åŒ–ï¼Ÿ"}},[s._v("#")]),s._v(" ä»€ä¹ˆæ˜¯æŒä¹…åŒ–ï¼Ÿ")]),s._v(" "),t("p",[s._v("åˆ©ç”¨"),t("strong",[s._v("æ°¸ä¹…æ€§")]),s._v("å­˜å‚¨ä»‹è´¨å°†æ•°æ®è¿›è¡Œä¿å­˜ï¼Œåœ¨ç‰¹å®šçš„æ—¶é—´å°†ä¿å­˜çš„æ•°æ®è¿›è¡Œæ¢å¤çš„å·¥ä½œæœºåˆ¶ç§°ä¸ºæŒä¹…åŒ–ã€‚")]),s._v(" "),t("h3",{attrs:{id:"ä¸ºä»€ä¹ˆè¦æŒä¹…åŒ–ï¼Ÿ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆè¦æŒä¹…åŒ–ï¼Ÿ"}},[s._v("#")]),s._v(" ä¸ºä»€ä¹ˆè¦æŒä¹…åŒ–ï¼Ÿ")]),s._v(" "),t("p",[t("strong",[s._v("é˜²æ­¢")]),s._v("æ•°æ®çš„æ„å¤–"),t("strong",[s._v("ä¸¢å¤±")]),s._v("ï¼Œç¡®ä¿æ•°æ®"),t("strong",[s._v("å®‰å…¨æ€§")])]),s._v(" "),t("h3",{attrs:{id:"æŒä¹…åŒ–è¿‡ç¨‹ä¿å­˜ä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æŒä¹…åŒ–è¿‡ç¨‹ä¿å­˜ä»€ä¹ˆ"}},[s._v("#")]),s._v(" æŒä¹…åŒ–è¿‡ç¨‹"),t("strong",[s._v("ä¿å­˜ä»€ä¹ˆ")])]),s._v(" "),t("ul",[t("li",[s._v("å°†å½“å‰"),t("strong",[s._v("æ•°æ®çŠ¶æ€")]),s._v("è¿›è¡Œä¿å­˜ï¼Œ"),t("strong",[s._v("å¿«ç…§")]),s._v("å½¢å¼ï¼Œå­˜å‚¨æ•°æ®ç»“æœï¼Œå­˜å‚¨æ ¼å¼ç®€å•ï¼Œå…³æ³¨ç‚¹åœ¨"),t("strong",[s._v("æ•°æ®")]),s._v("ã€‚RDB")]),s._v(" "),t("li",[s._v("å°†æ•°æ®çš„"),t("strong",[s._v("æ“ä½œè¿‡ç¨‹")]),s._v("è¿›è¡Œä¿å­˜ï¼Œ"),t("strong",[s._v("æ—¥å¿—")]),s._v("å½¢å¼ï¼Œå­˜å‚¨æ“ä½œè¿‡ç¨‹ï¼Œå­˜å‚¨æ ¼å¼å¤æ‚ï¼Œå…³æ³¨ç‚¹åœ¨æ•°æ®çš„æ“ä½œ"),t("strong",[s._v("è¿‡ç¨‹")]),s._v("ã€‚AOF")])]),s._v(" "),t("p",[t("img",{attrs:{src:v(567),alt:"img"}})]),s._v(" "),t("h2",{attrs:{id:"rdb-å…¨é‡å¿«ç…§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdb-å…¨é‡å¿«ç…§"}},[s._v("#")]),s._v(" RDBâ€”å…¨é‡å¿«ç…§")]),s._v(" "),t("h3",{attrs:{id:"rdb-é…ç½®-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdb-é…ç½®-ğŸ”¥"}},[s._v("#")]),s._v(" RDB é…ç½® ğŸ”¥")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("dbfilename dump.rdb")]),s._v(" "),t("ul",[t("li",[s._v("è¯´æ˜ï¼šè®¾ç½®æœ¬åœ°æ•°æ®åº“"),t("strong",[s._v("æ–‡ä»¶å")]),s._v("ï¼Œé»˜è®¤å€¼ä¸º dump.rdb")]),s._v(" "),t("li",[s._v("ç»éªŒï¼šé€šå¸¸è®¾ç½®ä¸º"),t("code",[s._v("dump-ç«¯å£å·.rdb")])])])]),s._v(" "),t("li",[t("p",[s._v("dir")]),s._v(" "),t("ul",[t("li",[s._v("è¯´æ˜ï¼šè®¾ç½®å­˜å‚¨.rdbæ–‡ä»¶çš„"),t("strong",[s._v("è·¯å¾„")])]),s._v(" "),t("li",[s._v("ç»éªŒï¼šé€šå¸¸è®¾ç½®æˆå­˜å‚¨ç©ºé—´è¾ƒå¤§çš„ç›®å½•ä¸­ï¼Œç›®å½•åç§°"),t("strong",[s._v("data")])])])]),s._v(" "),t("li",[t("p",[s._v("rdbcompression yes")]),s._v(" "),t("ul",[t("li",[s._v("è¯´æ˜ï¼šè®¾ç½®å­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦"),t("strong",[s._v("å‹ç¼©æ•°æ®")]),s._v("ï¼Œé»˜è®¤ä¸º "),t("strong",[s._v("yes")]),s._v("ï¼Œé‡‡ç”¨ LZF å‹ç¼©")]),s._v(" "),t("li",[s._v("ç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå¦‚æœè®¾ç½®ä¸ºnoï¼Œå¯ä»¥èŠ‚çœ CPU è¿è¡Œæ—¶é—´ï¼Œä½†ä¼šä½¿å­˜å‚¨çš„æ–‡ä»¶å˜å¤§ï¼ˆå·¨å¤§ï¼‰")])])]),s._v(" "),t("li",[t("p",[s._v("rdbchecksum yes")]),s._v(" "),t("ul",[t("li",[s._v("è¯´æ˜ï¼šè®¾ç½®æ˜¯å¦"),t("strong",[s._v("è¿›è¡ŒRDBæ–‡ä»¶æ ¼å¼æ ¡éªŒ")]),s._v("ï¼Œè¯¥æ ¡éªŒè¿‡ç¨‹åœ¨"),t("strong",[s._v("å†™æ–‡ä»¶å’Œè¯»æ–‡ä»¶è¿‡ç¨‹å‡è¿›è¡Œ")])]),s._v(" "),t("li",[s._v("ç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå¦‚æœè®¾ç½®ä¸ºnoï¼Œå¯ä»¥èŠ‚çº¦è¯»å†™æ€§è¿‡ç¨‹çº¦10%"),t("strong",[s._v("æ—¶é—´æ¶ˆè€—")]),s._v("ï¼Œä½†æ˜¯å­˜å‚¨ä¸€å®šçš„æ•°æ®æŸåé£é™©")])])]),s._v(" "),t("li",[t("p",[s._v("stop-writes-on-bgsave-error yes")]),s._v(" "),t("ul",[t("li",[s._v("è¯´æ˜ï¼š[bgsaveç›¸å…³]ã€‚åå°å­˜å‚¨è¿‡ç¨‹ä¸­å¦‚æœ"),t("strong",[s._v("å‡ºç°é”™è¯¯")]),s._v("ç°è±¡ï¼Œæ˜¯å¦"),t("strong",[s._v("åœæ­¢ä¿å­˜")]),s._v("æ“ä½œ")]),s._v(" "),t("li",[s._v("ç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€")])])]),s._v(" "),t("li",[t("p",[s._v("save second changes")]),s._v(" "),t("ul",[t("li",[s._v("ä½œç”¨ï¼šæ»¡è¶³"),t("strong",[s._v("é™å®šæ—¶é—´èŒƒå›´å†…keyçš„å˜åŒ–æ•°é‡è¾¾åˆ°æŒ‡å®šæ•°é‡")]),s._v("å³è¿›è¡ŒæŒä¹…åŒ–")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("å‚æ•°")]),s._v(" "),t("ul",[t("li",[s._v("secondï¼šç›‘æ§æ—¶é—´èŒƒå›´ï¼Œç§’ï¼")]),s._v(" "),t("li",[s._v("changesï¼šç›‘æ§ key çš„"),t("strong",[s._v("å˜åŒ–")]),s._v("é‡")])])])])])]),s._v(" "),t("p",[s._v("å¸¸è§é…ç½®å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('protected-mode no\n# bind 127.0.0.1\nport 6379\ndaemonize yes\nlogfile "/usr/local/redis-6.2.1/logs/redis-6379.log"\ndir ./data\ndbfilename dump-6379.rdb\nrdbcompression yes\nrdbchecksum yes\nstop-writes-on-bgsave-error yes\nsave 60 10000\nsave 300 100\nsave 3600 1\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h3",{attrs:{id:"rdb-å¯åŠ¨æ–¹å¼-save-é˜»å¡æŒ‡ä»¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdb-å¯åŠ¨æ–¹å¼-save-é˜»å¡æŒ‡ä»¤"}},[s._v("#")]),s._v(" RDB å¯åŠ¨æ–¹å¼â€”save é˜»å¡æŒ‡ä»¤")]),s._v(" "),t("p",[t("strong",[s._v("æ‰‹åŠ¨æ‰§è¡Œ")]),s._v("ä¸€æ¬¡ä¿å­˜æ“ä½œ")]),s._v(" "),t("h4",{attrs:{id:"save-å·¥ä½œåŸç†-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#save-å·¥ä½œåŸç†-ğŸ”¥"}},[s._v("#")]),s._v(" save å·¥ä½œåŸç† ğŸ”¥")]),s._v(" "),t("p",[t("img",{attrs:{src:v(568),alt:"img"}})]),s._v(" "),t("p",[s._v("æ­¥éª¤ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("æ¥æ”¶åˆ°SAVEå‘½ä»¤çš„RedisæœåŠ¡å™¨å°†éå†æ•°æ®åº“åŒ…å«çš„æ‰€æœ‰æ•°æ®åº“ï¼Œå¹¶å°†å„ä¸ªæ•°æ®åº“åŒ…å«çš„é”®å€¼å¯¹å…¨éƒ¨è®°å½•åˆ°RDBæ–‡ä»¶ä¸­ã€‚")]),s._v(" "),t("li",[s._v("åœ¨SAVEå‘½ä»¤æ‰§è¡ŒæœŸé—´ï¼ŒRedisæœåŠ¡å™¨å°†é˜»å¡ï¼Œç›´åˆ°RDBæ–‡ä»¶åˆ›å»ºå®Œæ¯•ä¸ºæ­¢ã€‚")]),s._v(" "),t("li",[s._v("å¦‚æœRedisæœåŠ¡å™¨åœ¨æ‰§è¡ŒSAVEå‘½ä»¤æ—¶å·²ç»æ‹¥æœ‰äº†ç›¸åº”çš„RDBæ–‡ä»¶ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†ä½¿ç”¨"),t("strong",[s._v("æ–°åˆ›å»ºçš„RDBæ–‡ä»¶ä»£æ›¿å·²æœ‰çš„RDBæ–‡ä»¶")])])]),s._v(" "),t("p",[s._v("æ³¨æ„ï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("saveæŒ‡ä»¤")]),s._v("çš„æ‰§è¡Œä¼š"),t("strong",[s._v("é˜»å¡")]),s._v("å½“å‰RedisæœåŠ¡å™¨ï¼Œç›´åˆ°å½“å‰RDBè¿‡ç¨‹å®Œæˆä¸ºæ­¢ï¼Œæœ‰å¯èƒ½ä¼šé€ æˆ"),t("strong",[s._v("é•¿æ—¶é—´é˜»å¡")]),s._v("ï¼Œçº¿ä¸Š"),t("strong",[s._v("ä¸å»ºè®®ä½¿ç”¨")]),s._v("ã€‚")])]),s._v(" "),t("h4",{attrs:{id:"æ•°æ®é‡å¤§ã€å•çº¿ç¨‹é˜»å¡é—®é¢˜ï¼Ÿ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®é‡å¤§ã€å•çº¿ç¨‹é˜»å¡é—®é¢˜ï¼Ÿ"}},[s._v("#")]),s._v(" æ•°æ®é‡å¤§ã€å•çº¿ç¨‹é˜»å¡é—®é¢˜ï¼Ÿ")]),s._v(" "),t("p",[s._v("é‚£ä¹ˆ"),t("strong",[s._v("æ•°æ®é‡è¿‡å¤§ï¼Œå•çº¿ç¨‹æ‰§è¡Œæ–¹å¼é€ æˆæ•ˆç‡è¿‡ä½å¦‚ä½•å¤„ç†")]),s._v("?")]),s._v(" "),t("p",[s._v("å¯ä»¥é‡‡ç”¨"),t("strong",[s._v("åå°æ‰§è¡Œ")]),s._v("ï¼ˆè§ bgsaveï¼‰ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("è°ï¼šRedisæ“ä½œè€…**ï¼ˆç”¨æˆ·ï¼‰å‘èµ·æŒ‡ä»¤**ï¼›Redis "),t("strong",[s._v("æœåŠ¡å™¨æ§åˆ¶æŒ‡ä»¤æ‰§è¡Œ")])]),s._v(" "),t("li",[s._v("ä»€ä¹ˆæ—¶é—´ï¼š"),t("strong",[s._v("å³æ—¶ï¼ˆå‘èµ·ï¼‰")]),s._v("ï¼›"),t("strong",[s._v("åˆç†çš„æ—¶é—´ï¼ˆæ‰§è¡Œï¼‰")])]),s._v(" "),t("li",[s._v("å¹²ä»€ä¹ˆäº‹æƒ…ï¼šä¿å­˜æ•°æ®")])]),s._v(" "),t("h3",{attrs:{id:"rdb-å¯åŠ¨æ–¹å¼-bgsave-å¼‚æ­¥æŒ‡ä»¤-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdb-å¯åŠ¨æ–¹å¼-bgsave-å¼‚æ­¥æŒ‡ä»¤-ğŸ”¥"}},[s._v("#")]),s._v(" RDB å¯åŠ¨æ–¹å¼â€”bgsave å¼‚æ­¥æŒ‡ä»¤ ğŸ”¥")]),s._v(" "),t("p",[t("strong",[s._v("æ‰‹åŠ¨å¯åŠ¨åå°ä¿å­˜")]),s._v("æ“ä½œï¼Œä½†ä¸æ˜¯ç«‹å³æ‰§è¡Œã€‚å®ƒä¸ä¼šç›´æ¥ä½¿ç”¨"),t("strong",[s._v("RedisæœåŠ¡å™¨è¿›ç¨‹")]),s._v("åˆ›å»ºRDBæ–‡ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨"),t("strong",[s._v("å­è¿›ç¨‹")]),s._v("åˆ›å»ºRDBæ–‡ä»¶")]),s._v(" "),t("h4",{attrs:{id:"bgsave-å·¥ä½œåŸç†-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#bgsave-å·¥ä½œåŸç†-ğŸ”¥"}},[s._v("#")]),s._v(" bgsave å·¥ä½œåŸç† ğŸ”¥")]),s._v(" "),t("p",[t("img",{attrs:{src:v(569),alt:"image-20210322224952967"}})]),s._v(" "),t("p",[s._v("æ­¥éª¤ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ã€‚")]),s._v(" "),t("li",[s._v("å­è¿›ç¨‹æ‰§è¡ŒSAVEå‘½ä»¤ï¼Œåˆ›å»ºæ–°çš„RDBæ–‡ä»¶ã€‚")]),s._v(" "),t("li",[s._v("RDBæ–‡ä»¶åˆ›å»ºå®Œæ¯•ä¹‹åï¼Œå­è¿›ç¨‹é€€å‡ºå¹¶é€šçŸ¥RedisæœåŠ¡å™¨è¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹ï¼‰æ–°RDBæ–‡ä»¶å·²ç»å®Œæˆã€‚")]),s._v(" "),t("li",[t("strong",[s._v("RedisæœåŠ¡å™¨è¿›ç¨‹")]),s._v("ä½¿ç”¨æ–°RDBæ–‡ä»¶æ›¿æ¢å·²æœ‰çš„RDBæ–‡ä»¶ã€‚")])]),s._v(" "),t("p",[s._v("æ³¨æ„ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("bgsaveå‘½ä»¤æ˜¯é’ˆå¯¹saveé˜»å¡é—®é¢˜åšçš„ä¼˜åŒ–ã€‚Redis å†…éƒ¨æ‰€æœ‰æ¶‰åŠåˆ°RDBæ“ä½œéƒ½é‡‡ç”¨bgsaveçš„æ–¹å¼ï¼Œsaveå‘½ä»¤å¯ä»¥æ”¾å¼ƒã€‚")]),s._v(" "),t("li",[s._v("è™½ç„¶BGSAVEå‘½ä»¤ä¸ä¼šåƒSAVEå‘½ä»¤é‚£æ ·ä¸€ç›´é˜»å¡RedisæœåŠ¡å™¨ï¼Œä½†ç”±äºæ‰§è¡ŒBGSAVEå‘½ä»¤éœ€è¦åˆ›å»ºå­è¿›ç¨‹ï¼Œæ‰€ä»¥"),t("strong",[s._v("çˆ¶è¿›ç¨‹å ç”¨çš„å†…å­˜æ•°é‡è¶Šå¤§ï¼Œåˆ›å»ºå­è¿›ç¨‹è¿™ä¸€æ“ä½œè€—è´¹çš„æ—¶é—´ä¹Ÿä¼šè¶Šé•¿")]),s._v("ï¼Œå› æ­¤RedisæœåŠ¡å™¨åœ¨æ‰§è¡ŒBGSAVEå‘½ä»¤æ—¶ï¼Œä»ç„¶å¯èƒ½ä¼šç”±äºåˆ›å»ºå­è¿›ç¨‹è€Œè¢«"),t("strong",[s._v("çŸ­æš‚åœ°é˜»å¡")])]),s._v(" "),t("li",[t("strong",[s._v("bgsaveçš„ä¿å­˜æ“ä½œå¯ä»¥é€šè¿‡redisçš„æ—¥å¿—æŸ¥çœ‹")]),s._v("ã€‚å¹¶ä¸”æ‰§è¡Œæ—¶å°±å·²ç»è¿”å› background...")])]),s._v(" "),t("h4",{attrs:{id:"ä½•æ—¶æ‰§è¡Œä¿å­˜æŒ‡ä»¤é—®é¢˜ï¼Ÿ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä½•æ—¶æ‰§è¡Œä¿å­˜æŒ‡ä»¤é—®é¢˜ï¼Ÿ"}},[s._v("#")]),s._v(" ä½•æ—¶æ‰§è¡Œä¿å­˜æŒ‡ä»¤é—®é¢˜ï¼Ÿ")]),s._v(" "),t("p",[t("strong",[s._v("åå¤æ‰§è¡Œä¿å­˜æŒ‡ä»¤ï¼Œå¿˜è®°äº†æ€ä¹ˆåŠ")]),s._v("ï¼Ÿä¸çŸ¥é“æ•°æ®äº§ç”Ÿäº†å¤šå°‘å˜åŒ–ï¼Œ"),t("strong",[s._v("ä½•æ—¶ä¿å­˜")]),s._v("ï¼Ÿ")]),s._v(" "),t("p",[s._v("è‡ªåŠ¨æ‰§è¡Œ")]),s._v(" "),t("ul",[t("li",[s._v("è°ï¼šRedis"),t("strong",[s._v("æœåŠ¡å™¨å‘èµ·æŒ‡ä»¤ï¼ˆåŸºäºæ¡ä»¶ï¼‰")])]),s._v(" "),t("li",[s._v("ä»€ä¹ˆæ—¶é—´ï¼š"),t("strong",[s._v("æ»¡è¶³æ¡ä»¶")])]),s._v(" "),t("li",[s._v("å¹²ä»€ä¹ˆäº‹æƒ…ï¼šä¿å­˜æ•°æ®")])]),s._v(" "),t("h3",{attrs:{id:"rdb-å¯åŠ¨æ–¹å¼-save-é…ç½®-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdb-å¯åŠ¨æ–¹å¼-save-é…ç½®-ğŸ”¥"}},[s._v("#")]),s._v(" RDB å¯åŠ¨æ–¹å¼â€”save é…ç½® ğŸ”¥")]),s._v(" "),t("h4",{attrs:{id:"ç®€ä»‹-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç®€ä»‹-2"}},[s._v("#")]),s._v(" ç®€ä»‹")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("save second changes\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ä½œç”¨ï¼šæ»¡è¶³"),t("strong",[s._v("é™å®šæ—¶é—´èŒƒå›´å†…keyçš„å˜åŒ–æ•°é‡è¾¾åˆ°æŒ‡å®šæ•°é‡")]),s._v("å³è¿›è¡ŒæŒä¹…åŒ–")]),s._v(" "),t("p",[s._v("å‚æ•°")]),s._v(" "),t("ul",[t("li",[s._v("secondï¼šç›‘æ§æ—¶é—´èŒƒå›´ï¼Œç§’ï¼")]),s._v(" "),t("li",[s._v("changesï¼šç›‘æ§ key çš„"),t("strong",[s._v("å˜åŒ–")]),s._v("é‡")])]),s._v(" "),t("p",[s._v("ä½ç½®ï¼šåœ¨confæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®")]),s._v(" "),t("p",[s._v("RDBæŒä¹…åŒ–æ˜¯Redisé»˜è®¤ä½¿ç”¨çš„æŒä¹…åŒ–æ–¹å¼ï¼Œå¦‚æœç”¨æˆ·åœ¨å¯åŠ¨RedisæœåŠ¡å™¨æ—¶ï¼Œæ—¢"),t("strong",[s._v("æ²¡æœ‰æ˜¾å¼åœ°å…³é—­RDBæŒä¹…åŒ–åŠŸèƒ½")]),s._v("ï¼Œä¹Ÿ"),t("strong",[s._v("æ²¡æœ‰å¯ç”¨AOFæŒä¹…åŒ–åŠŸèƒ½")]),s._v("ï¼Œé‚£ä¹ˆRedis"),t("strong",[s._v("é»˜è®¤å°†ä½¿ç”¨ä»¥ä¸‹saveé€‰é¡¹è¿›è¡ŒRDBæŒä¹…åŒ–")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("save 60 10000\nsave 300 100\nsave 3600 1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("æ³¨æ„ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("Rediså…è®¸ç”¨æˆ·åŒæ—¶å‘æœåŠ¡å™¨æä¾›"),t("strong",[s._v("å¤šä¸ªsaveé€‰é¡¹")]),s._v("ï¼Œå½“ç»™å®šé€‰é¡¹ä¸­çš„"),t("strong",[s._v("ä»»æ„ä¸€ä¸ªæ¡ä»¶è¢«æ»¡è¶³æ—¶")]),s._v("ï¼ŒæœåŠ¡å™¨å°±ä¼š"),t("strong",[s._v("æ‰§è¡Œä¸€æ¬¡BGSAVE")])]),s._v(" "),t("li",[s._v("ä¸ºäº†é¿å…ç”±äºåŒæ—¶ä½¿ç”¨å¤šä¸ªè§¦å‘æ¡ä»¶è€Œå¯¼è‡´æœåŠ¡å™¨è¿‡äºé¢‘ç¹åœ°æ‰§è¡ŒBGSAVEå‘½ä»¤ï¼ŒRedisæœåŠ¡å™¨åœ¨"),t("strong",[s._v("æ¯æ¬¡æˆåŠŸåˆ›å»ºRDBæ–‡ä»¶ä¹‹å")]),s._v("ï¼Œ"),t("strong",[s._v("è´Ÿè´£è‡ªåŠ¨è§¦å‘BGSAVEå‘½ä»¤çš„æ—¶é—´è®¡æ•°å™¨ä»¥åŠä¿®æ”¹æ¬¡æ•°è®¡æ•°å™¨éƒ½ä¼šè¢«æ¸…é›¶å¹¶é‡æ–°å¼€å§‹è®¡æ•°")]),s._v("ï¼šæ— è®ºè¿™ä¸ªRDBæ–‡ä»¶æ˜¯ç”±è‡ªåŠ¨è§¦å‘çš„BGSAVEå‘½ä»¤åˆ›å»ºçš„ï¼Œè¿˜æ˜¯ç”±ç”¨æˆ·æ‰§è¡Œçš„SAVEå‘½ä»¤æˆ–BGSAVEå‘½ä»¤åˆ›å»ºçš„ï¼Œéƒ½æ˜¯å¦‚æ­¤")])]),s._v(" "),t("h4",{attrs:{id:"save-é…ç½®åŸç†-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#save-é…ç½®åŸç†-ğŸ”¥"}},[s._v("#")]),s._v(" save é…ç½®åŸç† ğŸ”¥")]),s._v(" "),t("p",[t("img",{attrs:{src:v(570),alt:"image-20210322231343462"}})]),s._v(" "),t("p",[s._v("æ³¨æ„ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("saveé…ç½®è¦"),t("strong",[s._v("æ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µè¿›è¡Œè®¾ç½®")]),s._v("ï¼Œé¢‘åº¦è¿‡é«˜æˆ–è¿‡ä½éƒ½ä¼šå‡ºç°æ€§èƒ½é—®é¢˜ï¼Œç»“æœå¯èƒ½æ˜¯"),t("strong",[s._v("ç¾éš¾æ€§")]),s._v("çš„")]),s._v(" "),t("li",[s._v("saveé…ç½®ä¸­å¯¹äºsecondä¸changesè®¾ç½®é€šå¸¸å…·æœ‰"),t("strong",[s._v("äº’è¡¥å¯¹åº”å…³ç³»")]),s._v("ï¼ˆä¸€å¤§ä¸€å°ï¼‰ï¼Œå°½é‡ä¸è¦è®¾ç½®æˆåŒ…å«æ€§å…³ç³»")]),s._v(" "),t("li",[s._v("saveé…ç½®å¯åŠ¨åæ‰§è¡Œçš„æ˜¯"),t("strong",[s._v("bgsave")]),s._v("æ“ä½œ")])]),s._v(" "),t("h3",{attrs:{id:"rdbä¸‰ç§å¯åŠ¨æ–¹å¼å¯¹æ¯”-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdbä¸‰ç§å¯åŠ¨æ–¹å¼å¯¹æ¯”-ğŸ”¥"}},[s._v("#")]),s._v(" RDBä¸‰ç§å¯åŠ¨æ–¹å¼å¯¹æ¯” ğŸ”¥")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("æ–¹å¼")]),s._v(" "),t("th",[s._v("save æŒ‡ä»¤")]),s._v(" "),t("th",[s._v("bgsave æŒ‡ä»¤")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("è¯»å†™")]),s._v(" "),t("td",[s._v("åŒæ­¥")]),s._v(" "),t("td",[s._v("å¼‚æ­¥")])]),s._v(" "),t("tr",[t("td",[s._v("é˜»å¡å®¢æˆ·ç«¯æŒ‡ä»¤")]),s._v(" "),t("td",[s._v("æ˜¯")]),s._v(" "),t("td",[s._v("å¦")])]),s._v(" "),t("tr",[t("td",[s._v("é¢å¤–å†…å­˜æ¶ˆè€—")]),s._v(" "),t("td",[s._v("å¦")]),s._v(" "),t("td",[s._v("æ˜¯")])]),s._v(" "),t("tr",[t("td",[s._v("å¯åŠ¨æ–°è¿›ç¨‹")]),s._v(" "),t("td",[s._v("å¦")]),s._v(" "),t("td",[s._v("æ˜¯")])])])]),s._v(" "),t("ul",[t("li",[s._v("SAVEå‘½ä»¤åœ¨åˆ›å»ºRDBæ–‡ä»¶æœŸé—´ä¼š"),t("strong",[s._v("é˜»å¡")]),s._v("RedisæœåŠ¡å™¨ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨åˆ›å»ºRDBæ–‡ä»¶çš„åŒæ—¶è®©RedisæœåŠ¡å™¨ç»§ç»­ä¸ºå…¶ä»–å®¢æˆ·ç«¯æœåŠ¡ï¼Œé‚£ä¹ˆå°±åªèƒ½ä½¿ç”¨BGSAVEå‘½ä»¤æ¥åˆ›å»ºRDBæ–‡ä»¶")]),s._v(" "),t("li",[s._v("SAVEå‘½ä»¤"),t("strong",[s._v("æ— é¡»åˆ›å»ºå­è¿›ç¨‹")]),s._v("ï¼Œå®ƒ"),t("strong",[s._v("ä¸ä¼šå› ä¸ºåˆ›å»ºå­è¿›ç¨‹è€Œæ¶ˆè€—é¢å¤–çš„å†…å­˜")]),s._v("ï¼Œæ‰€ä»¥åœ¨"),t("strong",[s._v("ç»´æŠ¤ç¦»çº¿çš„RedisæœåŠ¡å™¨")]),s._v("æ—¶ï¼Œä½¿ç”¨SAVEå‘½ä»¤èƒ½å¤Ÿæ¯”ä½¿ç”¨BGSAVEå‘½ä»¤"),t("strong",[s._v("æ›´å¿«åœ°å®Œæˆåˆ›å»ºRDBæ–‡ä»¶")]),s._v("çš„å·¥ä½œ")])]),s._v(" "),t("h3",{attrs:{id:"rdb-ç‰¹æ®Šå¯åŠ¨æ–¹å¼-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdb-ç‰¹æ®Šå¯åŠ¨æ–¹å¼-ğŸ”¥"}},[s._v("#")]),s._v(" RDB ç‰¹æ®Šå¯åŠ¨æ–¹å¼ ğŸ”¥")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("å…¨é‡å¤åˆ¶ï¼šåœ¨"),t("strong",[s._v("ä¸»ä»å¤åˆ¶")]),s._v("ä¸­è¯¦ç»†è®²è§£")])]),s._v(" "),t("li",[t("p",[s._v("æœåŠ¡å™¨"),t("strong",[s._v("è¿è¡Œè¿‡ç¨‹ä¸­é‡å¯")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("debug reload\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("å…³é—­æœåŠ¡å™¨æ—¶æŒ‡å®šä¿å­˜æ•°æ®")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("shutdown save\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("é»˜è®¤")]),s._v("æƒ…å†µä¸‹æ‰§è¡Œ shutdown å‘½ä»¤æ—¶ï¼Œ"),t("strong",[s._v("è‡ªåŠ¨æ‰§è¡Œ saveï¼ˆå¦‚æœæ²¡æœ‰å¼€å¯AOFæŒä¹…åŒ–åŠŸèƒ½ï¼‰")])])])]),s._v(" "),t("h3",{attrs:{id:"rdb-ä¼˜ç¼ºç‚¹-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdb-ä¼˜ç¼ºç‚¹-ğŸ”¥"}},[s._v("#")]),s._v(" RDB ä¼˜ç¼ºç‚¹ ğŸ”¥")]),s._v(" "),t("p",[s._v("ä¼˜ç‚¹ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("RDBæ˜¯ä¸€ä¸ª"),t("strong",[s._v("ç´§å‡‘å‹ç¼©")]),s._v("çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œ"),t("strong",[s._v("å­˜å‚¨æ•ˆç‡è¾ƒé«˜")])]),s._v(" "),t("li",[s._v("RDBå†…éƒ¨å­˜å‚¨çš„æ˜¯Redisåœ¨æŸä¸ªæ—¶é—´ç‚¹çš„"),t("strong",[s._v("æ•°æ®å¿«ç…§")]),s._v("ï¼Œéå¸¸é€‚åˆç”¨äº"),t("strong",[s._v("æ•°æ®å¤‡ä»½")]),s._v("ï¼Œ"),t("strong",[s._v("å…¨é‡å¤åˆ¶")]),s._v("ç­‰åœºæ™¯")]),s._v(" "),t("li",[t("strong",[s._v("RDBæ¢å¤æ•°æ®çš„é€Ÿåº¦è¦æ¯”AOFå¿«å¾ˆå¤š")])]),s._v(" "),t("li",[s._v("åº”ç”¨ï¼šæœåŠ¡å™¨ä¸­æ¯Xå°æ—¶æ‰§è¡Œbgsaveå¤‡ä»½ï¼Œå¹¶å°†RDBæ–‡ä»¶æ‹·è´åˆ°è¿œç¨‹æœºå™¨ä¸­ï¼Œç”¨äº"),t("strong",[s._v("ç¾éš¾æ¢å¤")]),s._v("ã€‚")])]),s._v(" "),t("p",[s._v("ç¼ºç‚¹ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("RDBæ–¹å¼æ— è®ºæ˜¯æ‰§è¡ŒæŒ‡ä»¤è¿˜æ˜¯åˆ©ç”¨é…ç½®ï¼Œ"),t("strong",[s._v("æ— æ³•åšåˆ°å®æ—¶æŒä¹…åŒ–")]),s._v("ï¼Œå…·æœ‰è¾ƒå¤§çš„"),t("strong",[s._v("å¯èƒ½æ€§ä¸¢å¤±æ•°æ®")])]),s._v(" "),t("li",[s._v("bgsaveæŒ‡ä»¤æ¯æ¬¡è¿è¡Œè¦æ‰§è¡Œ"),t("strong",[s._v("forkæ“ä½œåˆ›å»ºå­è¿›ç¨‹")]),s._v("ï¼Œè¦"),t("strong",[s._v("ç‰ºç‰²æ‰ä¸€äº›æ€§èƒ½")]),s._v("ã€‚ç”šè‡³æ•°æ®é‡å¤§çš„æ—¶å€™è¿˜ä¼š"),t("strong",[s._v("çŸ­æš‚é˜»å¡")])]),s._v(" "),t("li",[t("strong",[s._v("å­˜å‚¨æ•°æ®é‡å¤§æ—¶ï¼Œæ•ˆç‡ä½")]),s._v('ã€‚å› ä¸ºæ˜¯"å…¨é‡"æ•°æ®')]),s._v(" "),t("li",[s._v("Redisçš„ä¼—å¤šç‰ˆæœ¬ä¸­"),t("strong",[s._v("æœªè¿›è¡ŒRDBæ–‡ä»¶æ ¼å¼çš„ç‰ˆæœ¬ç»Ÿä¸€")]),s._v("ï¼Œæœ‰å¯èƒ½å‡ºç°å„ç‰ˆæœ¬æœåŠ¡ä¹‹é—´æ•°æ®æ ¼å¼æ— æ³•"),t("strong",[s._v("å…¼å®¹")]),s._v("ç°è±¡")])]),s._v(" "),t("h3",{attrs:{id:"åœºæ™¯-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åœºæ™¯-ğŸ”¥"}},[s._v("#")]),s._v(" åœºæ™¯ ğŸ”¥")]),s._v(" "),t("p",[t("strong",[s._v("æ‰€ä»¥RDBæ›´åƒæ˜¯ä¸€ç§æ•°æ®å¤‡ä»½æ‰‹æ®µè€Œéä¸€ç§æ™®é€šçš„æ•°æ®æŒä¹…åŒ–æ‰‹æ®µ")])]),s._v(" "),t("h2",{attrs:{id:"aof-å¢é‡-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aof-å¢é‡-ğŸ”¥"}},[s._v("#")]),s._v(" AOFâ€”å¢é‡ ğŸ”¥")]),s._v(" "),t("h3",{attrs:{id:"rdb-ç¼ºç‚¹å¦‚ä½•è§£å†³"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdb-ç¼ºç‚¹å¦‚ä½•è§£å†³"}},[s._v("#")]),s._v(" RDB ç¼ºç‚¹å¦‚ä½•è§£å†³")]),s._v(" "),t("p",[s._v("ç¼ºç‚¹ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("å­˜å‚¨æ•°æ®é‡è¾ƒå¤§ï¼Œæ•ˆç‡è¾ƒä½ã€‚åŸºäº"),t("strong",[s._v("å¿«ç…§")]),s._v("æ€æƒ³ï¼Œæ¯æ¬¡è¯»å†™éƒ½æ˜¯å…¨éƒ¨æ•°æ®ï¼Œå½“æ•°æ®é‡å·¨å¤§æ—¶ï¼Œæ•ˆç‡éå¸¸ä½")]),s._v(" "),t("li",[s._v("æ‰€ä»¥å¤§æ•°æ®é‡ä¸‹çš„IOæ€§èƒ½è¾ƒä½")]),s._v(" "),t("li",[s._v("åŸºäºforkåˆ›å»ºå­è¿›ç¨‹ï¼Œå†…å­˜äº§ç”Ÿé¢å¤–æ¶ˆè€—")]),s._v(" "),t("li",[s._v("å®•æœºå¸¦æ¥çš„æ•°æ®ä¸¢å¤±é£é™©")])]),s._v(" "),t("p",[s._v("è§£å†³æ€è·¯ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("ä¸å†™å…¨æ•°æ®ï¼Œä»…è®°å½•"),t("strong",[s._v("éƒ¨åˆ†æ•°æ®")])]),s._v(" "),t("li",[s._v("é™ä½åŒºåˆ†æ•°æ®"),t("strong",[s._v("æ˜¯å¦æ”¹å˜")]),s._v("çš„éš¾åº¦ï¼Œæ”¹è®°å½•æ•°æ®ä¸º"),t("strong",[s._v("è®°å½•æ“ä½œè¿‡ç¨‹")])]),s._v(" "),t("li",[s._v("å¯¹"),t("strong",[s._v("æ‰€æœ‰æ“ä½œå‡è¿›è¡Œè®°å½•")]),s._v("ï¼Œ"),t("strong",[s._v("æ’é™¤ä¸¢å¤±æ•°æ®")]),s._v("çš„é£é™©")])]),s._v(" "),t("h3",{attrs:{id:"aof-ç®€ä»‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aof-ç®€ä»‹"}},[s._v("#")]),s._v(" AOF ç®€ä»‹")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("AOFï¼ˆappend only fileï¼‰æŒä¹…åŒ–")]),s._v("ï¼šä»¥"),t("strong",[s._v("ç‹¬ç«‹æ—¥å¿—")]),s._v("çš„æ–¹å¼è®°å½•æ¯æ¬¡"),t("strong",[s._v("å†™å‘½ä»¤")]),s._v("ï¼Œ"),t("strong",[s._v("é‡å¯æ—¶å†é‡æ–°æ‰§è¡ŒAOFæ–‡ä»¶ä¸­å‘½ä»¤")]),s._v("è¾¾åˆ°æ¢å¤æ•°æ®çš„ç›®çš„ã€‚ä¸RDBç›¸æ¯”å¯ä»¥ç®€å•æè¿°ä¸ºæ”¹è®°å½•æ•°æ®ä¸º"),t("strong",[s._v("è®°å½•æ•°æ®äº§ç”Ÿçš„è¿‡ç¨‹")])]),s._v(" "),t("li",[s._v("AOFçš„ä¸»è¦ä½œç”¨æ˜¯"),t("strong",[s._v("è§£å†³äº†æ•°æ®æŒä¹…åŒ–çš„å®æ—¶æ€§")]),s._v("ï¼Œç›®å‰å·²ç»æ˜¯RedisæŒä¹…åŒ–çš„"),t("strong",[s._v("ä¸»æµæ–¹å¼")])])]),s._v(" "),t("h3",{attrs:{id:"aof-é…ç½®å¯åŠ¨-appendonly-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aof-é…ç½®å¯åŠ¨-appendonly-ğŸ”¥"}},[s._v("#")]),s._v(" AOF é…ç½®å¯åŠ¨â€”appendonly ğŸ”¥")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("appendonly yes|no\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ä½œç”¨ï¼šæ˜¯å¦å¼€å¯AOFæŒä¹…åŒ–åŠŸèƒ½ï¼Œ"),t("strong",[s._v("é»˜è®¤ä¸ºä¸å¼€å¯çŠ¶æ€")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("appendfsync always|everysec|no\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ä½œç”¨ï¼šAOF"),t("strong",[s._v("å†™æ•°æ®ï¼ˆåˆ·ç›˜ï¼‰ç­–ç•¥")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("appendfilename filename\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ä½œç”¨ï¼šAOF"),t("strong",[s._v("æŒä¹…åŒ–æ–‡ä»¶å")]),s._v("ï¼Œé»˜è®¤æ–‡ä»¶åæœªappendonly.aofï¼Œå»ºè®®é…ç½®ä¸º"),t("code",[s._v("appendonly-ç«¯å£å·.aof")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("dir\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ä½œç”¨ï¼šAOF æŒä¹…åŒ–æ–‡ä»¶ä¿å­˜è·¯å¾„ï¼Œä¸RDBæŒä¹…åŒ–æ–‡ä»¶ä¿æŒä¸€è‡´å³å¯")]),s._v(" "),t("p",[s._v("å¸¸è§é…ç½®å¦‚ä¸‹ï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('protected-mode no\n# bind 127.0.0.1\nport 6379\ndaemonize yes\nlogfile "/usr/local/redis-6.2.1/logs/redis-6379.log"\ndir ./data\ndbfilename dump-6379.rdb\nrdbcompression yes\nrdbchecksum yes\nstop-writes-on-bgsave-error yes\nsave 60 2\nappendonly yes\nappendfsync everysec\nappendfilename appendonly-6379.aof\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"aofå†™æ•°æ®è¿‡ç¨‹-ä¸‰ç§ç­–ç•¥-appendfsync-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aofå†™æ•°æ®è¿‡ç¨‹-ä¸‰ç§ç­–ç•¥-appendfsync-ğŸ”¥"}},[s._v("#")]),s._v(" AOFå†™æ•°æ®è¿‡ç¨‹ & ä¸‰ç§ç­–ç•¥ appendfsync ğŸ”¥")]),s._v(" "),t("p",[t("img",{attrs:{src:v(571),alt:"image-20210322233538723"}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("always")]),s._v("ï¼ˆæ¯æ¬¡ï¼‰ï¼šæ¯æ¬¡å†™å…¥æ“ä½œå‡åŒæ­¥åˆ°AOFæ–‡ä»¶ä¸­ï¼Œ"),t("strong",[s._v("æ•°æ®é›¶è¯¯å·®ï¼Œæ€§èƒ½è¾ƒä½")])]),s._v(" "),t("li",[t("strong",[s._v("everysecğŸ”¥")]),s._v("ï¼ˆæ¯ç§’ï¼‰ï¼š"),t("strong",[s._v("é»˜è®¤")]),s._v("ã€‚æ¯ç§’å°†"),t("strong",[s._v("ç¼“å†²åŒº")]),s._v("ä¸­çš„æŒ‡ä»¤åŒæ­¥åˆ°AOFæ–‡ä»¶ä¸­ï¼Œ"),t("strong",[s._v("æ•°æ®å‡†ç¡®æ€§è¾ƒé«˜ï¼Œæ€§èƒ½è¾ƒé«˜")]),s._v("ã€‚åœ¨ç³»ç»Ÿçªç„¶å®•æœºçš„æƒ…å†µä¸‹"),t("strong",[s._v("ä¸¢å¤±1ç§’å†…")]),s._v("çš„æ•°æ®")]),s._v(" "),t("li",[t("strong",[s._v("no")]),s._v("ï¼ˆç³»ç»Ÿæ§åˆ¶ï¼‰ï¼šç”±"),t("strong",[s._v("æ“ä½œç³»ç»Ÿæ§åˆ¶")]),s._v("æ¯æ¬¡åŒæ­¥åˆ°AOFæ–‡ä»¶çš„å‘¨æœŸï¼Œæ•´ä½“è¿‡ç¨‹"),t("strong",[s._v("ä¸å¯æ§")])])]),s._v(" "),t("h3",{attrs:{id:"aof-é‡å†™-é‡å†™è§„åˆ™-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aof-é‡å†™-é‡å†™è§„åˆ™-ğŸ”¥"}},[s._v("#")]),s._v(" AOF é‡å†™ & é‡å†™è§„åˆ™ ğŸ”¥")]),s._v(" "),t("h4",{attrs:{id:"aof-é‡å†™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aof-é‡å†™"}},[s._v("#")]),s._v(" AOF é‡å†™")]),s._v(" "),t("p",[s._v("å¦‚æœè¿ç»­æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤è¯¥å¦‚ä½•å¤„ç†")]),s._v(" "),t("p",[t("img",{attrs:{src:v(572),alt:"image-20210322235031635"}})]),s._v(" "),t("p",[s._v("éšç€å‘½ä»¤ä¸æ–­å†™å…¥AOFï¼Œ"),t("strong",[s._v("æ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§")]),s._v("ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒRediså¼•å…¥äº†AOFé‡å†™æœºåˆ¶å‹ç¼©æ–‡ä»¶ä½“ç§¯ã€‚AOFæ–‡ä»¶é‡å†™æ˜¯"),t("strong",[s._v("å°†Redisè¿›ç¨‹å†…çš„æ•°æ®è½¬åŒ–ä¸ºå†™å‘½ä»¤åŒæ­¥åˆ°æ–°AOFæ–‡ä»¶çš„è¿‡ç¨‹")]),s._v("ã€‚ç®€å•è¯´å°±æ˜¯"),t("strong",[s._v("å°†å¯¹åŒä¸€ä¸ªæ•°æ®çš„è‹¥å¹²ä¸ªæ¡å‘½ä»¤æ‰§è¡Œç»“æœè½¬åŒ–æˆæœ€ç»ˆç»“æœæ•°æ®å¯¹åº”çš„æŒ‡ä»¤è¿›è¡Œè®°å½•")]),s._v("ã€‚")]),s._v(" "),t("p",[s._v("AOFé‡å†™ä½œç”¨ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("é™ä½ç£ç›˜å ç”¨é‡ï¼Œæé«˜ç£ç›˜åˆ©ç”¨ç‡")]),s._v(" "),t("li",[s._v("æé«˜æŒä¹…åŒ–æ•ˆç‡ï¼Œé™ä½æŒä¹…åŒ–å†™æ—¶é—´ï¼Œæé«˜IOæ€§èƒ½")]),s._v(" "),t("li",[s._v("é™ä½æ•°æ®æ¢å¤ç”¨æ—¶ï¼Œæé«˜æ•°æ®æ¢å¤æ•ˆç‡")])]),s._v(" "),t("h4",{attrs:{id:"aof-é‡å†™è§„åˆ™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aof-é‡å†™è§„åˆ™"}},[s._v("#")]),s._v(" AOF é‡å†™è§„åˆ™")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("è¿›ç¨‹å†…"),t("strong",[s._v("å·²è¶…æ—¶çš„æ•°æ®ä¸å†å†™å…¥")]),s._v("æ–‡ä»¶")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("å¿½ç•¥æ— æ•ˆæŒ‡ä»¤")]),s._v("ï¼Œé‡å†™æ—¶ä½¿ç”¨è¿›ç¨‹å†…æ•°æ®ç›´æ¥ç”Ÿæˆï¼Œè¿™æ ·æ–°çš„AOFæ–‡ä»¶åªä¿ç•™æœ€ç»ˆæ•°æ®çš„å†™å…¥å‘½ä»¤")]),s._v(" "),t("p",[s._v("å¦‚ del key1ã€ hdel key2ã€srem key3ã€set key4 111ã€set key4 222ç­‰")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("å¯¹åŒä¸€æ•°æ®çš„å¤šæ¡å†™å‘½ä»¤åˆå¹¶ä¸ºä¸€æ¡å‘½ä»¤")]),s._v("\nå¦‚lpush list1 aã€lpush list1 bã€ lpush list1 c å¯ä»¥è½¬åŒ–ä¸º:lpush list1 a b cã€‚ ä¸ºé˜²æ­¢æ•°æ®é‡è¿‡å¤§é€ æˆå®¢æˆ·ç«¯ç¼“å†²åŒºæº¢å‡ºï¼Œå¯¹listã€setã€hashã€zsetç­‰ç±»å‹ï¼Œæ¯æ¡æŒ‡ä»¤æœ€å¤šå†™å…¥64ä¸ªå…ƒç´ ")])])]),s._v(" "),t("h3",{attrs:{id:"aof-é‡å†™æ–¹å¼-bgrewriteaof-æŒ‡ä»¤ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aof-é‡å†™æ–¹å¼-bgrewriteaof-æŒ‡ä»¤ğŸ”¥"}},[s._v("#")]),s._v(" AOF é‡å†™æ–¹å¼â€”bgrewriteaof æŒ‡ä»¤ğŸ”¥")]),s._v(" "),t("h4",{attrs:{id:"bgrewriteaof-å¼‚æ­¥æŒ‡ä»¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#bgrewriteaof-å¼‚æ­¥æŒ‡ä»¤"}},[s._v("#")]),s._v(" bgrewriteaof å¼‚æ­¥æŒ‡ä»¤")]),s._v(" "),t("p",[s._v("æ‰‹åŠ¨é‡å†™ï¼Œåˆ›å»º"),t("strong",[s._v("å­è¿›ç¨‹")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("bgrewriteaof\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"bgrewriteaof-å·¥ä½œåŸç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#bgrewriteaof-å·¥ä½œåŸç†"}},[s._v("#")]),s._v(" bgrewriteaof å·¥ä½œåŸç†")]),s._v(" "),t("p",[t("img",{attrs:{src:v(573),alt:"image-20210322235807544"}})]),s._v(" "),t("p",[s._v("æ³¨æ„ï¼š")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("å¦‚æœç”¨æˆ·å‘é€BGREWRITEAOFå‘½ä»¤è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨æ­£åœ¨åˆ›å»ºRDBæ–‡ä»¶ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†æŠŠAOFé‡å†™æ“ä½œå»¶ååˆ°RDBæ–‡ä»¶åˆ›å»ºå®Œæ¯•ä¹‹åå†æ‰§è¡Œï¼Œä»è€Œé¿å…ä¸¤ä¸ªå†™ç¡¬ç›˜æ“ä½œåŒæ—¶æ‰§è¡Œå¯¼è‡´æœºå™¨æ€§èƒ½ä¸‹é™")])]),s._v(" "),t("li",[t("p",[s._v("å¦‚æœæœåŠ¡å™¨åœ¨æ‰§è¡Œé‡å†™æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œåˆæ¥æ”¶åˆ°äº†æ–°çš„BGREWRITEAOFå‘½ä»¤è¯·æ±‚ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†è¿”å›ä»¥ä¸‹é”™è¯¯ï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("redis> BGREWRITEAOF\n(error) ERR Background append only file rewriting already in progress\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])]),s._v(" "),t("h3",{attrs:{id:"aof-é‡å†™æ–¹å¼-é…ç½®-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aof-é‡å†™æ–¹å¼-é…ç½®-ğŸ”¥"}},[s._v("#")]),s._v(" AOF é‡å†™æ–¹å¼â€”é…ç½® ğŸ”¥")]),s._v(" "),t("p",[s._v("è‡ªåŠ¨é‡å†™è§¦å‘æ¡ä»¶è®¾ç½®")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("auto-aof-rewrite-min-size size \nauto-aof-rewrite-percentage percentage\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[t("p",[t("code",[s._v("auto-aof-rewrite-min-size")]),s._v("é€‰é¡¹ç”¨äºè®¾ç½®"),t("strong",[s._v("è§¦å‘è‡ªåŠ¨AOFæ–‡ä»¶é‡å†™æ‰€éœ€çš„æœ€å°AOFæ–‡ä»¶ä½“ç§¯")]),s._v("ï¼Œå½“AOFæ–‡ä»¶çš„ä½“ç§¯å°äºç»™å®šå€¼æ—¶ï¼ŒæœåŠ¡å™¨å°†ä¸ä¼šè‡ªåŠ¨æ‰§è¡ŒBGREWRITEAOFå‘½ä»¤ã€‚åœ¨"),t("strong",[s._v("é»˜è®¤")]),s._v("æƒ…å†µä¸‹ï¼Œè¯¥é€‰é¡¹çš„å€¼ä¸º "),t("strong",[s._v("64mb")])])]),s._v(" "),t("li",[t("p",[t("code",[s._v("auto-aof-rewrite-percentage")]),s._v("æ§åˆ¶çš„æ˜¯è§¦å‘è‡ªåŠ¨AOFæ–‡ä»¶é‡å†™æ‰€éœ€çš„æ–‡ä»¶ä½“ç§¯"),t("strong",[s._v("å¢å¤§æ¯”ä¾‹")]),s._v("ã€‚é»˜è®¤å€¼"),t("strong",[s._v("100")])]),s._v(" "),t("p",[s._v("é»˜è®¤å€¼è¡¨ç¤ºå¦‚æœå½“å‰AOFæ–‡ä»¶çš„ä½“ç§¯æ¯”æœ€åä¸€æ¬¡AOFæ–‡ä»¶é‡å†™ä¹‹åçš„ä½“ç§¯å¢å¤§äº†ä¸€å€ï¼ˆ100%ï¼‰ï¼Œé‚£ä¹ˆå°†è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡BGREWRITEAOFå‘½ä»¤")])])]),s._v(" "),t("p",[s._v("è‡ªåŠ¨é‡å†™è§¦å‘æ¯”å¯¹å‚æ•°ï¼ˆæ‰§è¡Œ "),t("code",[s._v("info")]),s._v("æŒ‡ä»¤ï¼ŒæŸ¥çœ‹ Persistenceè·å–å…·ä½“ä¿¡æ¯ï¼‰")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("aof_current_size # è¿™ä¸ªå€¼ä¼šä¸æ–­å˜åŒ–\naof_base_size # è¿™ä¸ªå€¼ä¼šåœ¨rewriteåå˜åŒ–\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("è‡ªåŠ¨é‡å†™è§¦å‘æ¡ä»¶")]),s._v(" "),t("p",[t("img",{attrs:{src:v(574),alt:"image-20210323000007405"}})]),s._v(" "),t("h3",{attrs:{id:"aof-å·¥ä½œæµç¨‹-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aof-å·¥ä½œæµç¨‹-ğŸ”¥"}},[s._v("#")]),s._v(" AOF å·¥ä½œæµç¨‹ ğŸ”¥")]),s._v(" "),t("p",[t("img",{attrs:{src:v(575),alt:"image-20210323000635512"}})]),s._v(" "),t("h3",{attrs:{id:"aof-é‡å†™æµç¨‹-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#aof-é‡å†™æµç¨‹-ğŸ”¥"}},[s._v("#")]),s._v(" AOF é‡å†™æµç¨‹ ğŸ”¥")]),s._v(" "),t("p",[t("img",{attrs:{src:v(576),alt:"image-20210323000657592"}})]),s._v(" "),t("p",[t("img",{attrs:{src:v(577),alt:"image-20210323000804799"}})]),s._v(" "),t("h2",{attrs:{id:"rdb-aofæ··åˆæŒä¹…åŒ–-4-0-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdb-aofæ··åˆæŒä¹…åŒ–-4-0-ğŸ”¥"}},[s._v("#")]),s._v(" RDB-AOFæ··åˆæŒä¹…åŒ–â€”4.0 ğŸ”¥")]),s._v(" "),t("p",[s._v("RDB ä¸ AOF å¯¹æ¯”ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("RDBæŒä¹…åŒ–å¯ä»¥ç”Ÿæˆç´§å‡‘çš„RDBæ–‡ä»¶ï¼Œå¹¶ä¸”ä½¿ç”¨RDBæ–‡ä»¶è¿›è¡Œæ•°æ®æ¢å¤çš„é€Ÿåº¦ä¹Ÿéå¸¸å¿«ï¼Œä½†æ˜¯RDBçš„å…¨é‡æŒä¹…åŒ–æ¨¡å¼å¯èƒ½ä¼šè®©æœåŠ¡å™¨åœ¨åœæœºæ—¶ä¸¢å¤±å¤§é‡æ•°æ®ã€‚")]),s._v(" "),t("li",[s._v("ä¸RDBæŒä¹…åŒ–ç›¸æ¯”ï¼ŒAOFæŒä¹…åŒ–å¯ä»¥å°†ä¸¢å¤±æ•°æ®çš„æ—¶é—´çª—å£é™åˆ¶åœ¨1sä¹‹å†…ï¼Œä½†æ˜¯åè®®æ–‡æœ¬æ ¼å¼çš„AOFæ–‡ä»¶çš„ä½“ç§¯å°†æ¯”RDBæ–‡ä»¶è¦å¤§å¾—å¤šï¼Œå¹¶ä¸”æ•°æ®æ¢å¤è¿‡ç¨‹ä¹Ÿä¼šç›¸å¯¹è¾ƒæ…¢ã€‚ç›¸æ¯”RDBä¼˜å…ˆçº§é«˜ï¼")])]),s._v(" "),t("p",[s._v("Redisä»"),t("strong",[s._v("4.0ç‰ˆæœ¬")]),s._v("å¼€å§‹å¼•å…¥RDB-AOFæ··åˆæŒä¹…åŒ–æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æ˜¯åŸºäºAOFæŒä¹…åŒ–æ¨¡å¼æ„å»ºè€Œæ¥çš„â€”â€”å¦‚æœç”¨æˆ·"),t("strong",[s._v("æ‰“å¼€äº†æœåŠ¡å™¨çš„AOFæŒä¹…åŒ–åŠŸèƒ½")]),s._v("ï¼Œå¹¶ä¸”å°†")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("aof-use-rdb-preamble <value>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("é€‰é¡¹çš„å€¼è®¾ç½®æˆäº†yesï¼ˆé»˜è®¤ä¸ºnoï¼‰")]),s._v("ï¼Œé‚£ä¹ˆRedisæœåŠ¡å™¨åœ¨æ‰§è¡Œ"),t("strong",[s._v("AOFé‡å†™")]),s._v("æ“ä½œæ—¶ï¼Œå°±ä¼šåƒæ‰§è¡ŒBGSAVEå‘½ä»¤é‚£æ ·ï¼Œæ ¹æ®æ•°æ®åº“å½“å‰çš„çŠ¶æ€"),t("strong",[s._v("ç”Ÿæˆå‡ºç›¸åº”çš„RDBæ•°æ®")]),s._v("ï¼Œå¹¶å°†è¿™äº›æ•°æ®"),t("strong",[s._v("å†™å…¥æ–°å»ºçš„AOFæ–‡ä»¶")]),s._v("ä¸­ï¼Œè‡³äºé‚£äº›"),t("strong",[s._v("åœ¨AOFé‡å†™å¼€å§‹ä¹‹åæ‰§è¡Œçš„Rediså‘½ä»¤")]),s._v("ï¼Œåˆ™ä¼šç»§ç»­ä»¥"),t("strong",[s._v("åè®®æ–‡æœ¬")]),s._v("çš„æ–¹å¼"),t("strong",[s._v("è¿½åŠ åˆ°æ–°AOFæ–‡ä»¶çš„æœ«å°¾")]),s._v("ï¼Œå³å·²æœ‰çš„RDBæ•°æ®çš„åé¢ã€‚")]),s._v(" "),t("p",[s._v("æ¢å¥è¯è¯´ï¼Œåœ¨å¼€å¯äº†RDB-AOFæ··åˆæŒä¹…åŒ–åŠŸèƒ½ä¹‹åï¼ŒæœåŠ¡å™¨ç”Ÿæˆçš„AOFæ–‡ä»¶å°†ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆï¼Œå…¶ä¸­ä½äºAOFæ–‡ä»¶"),t("strong",[s._v("å¼€å¤´çš„æ˜¯RDBæ ¼å¼çš„æ•°æ®")]),s._v("ï¼Œè€Œ"),t("strong",[s._v("è·Ÿåœ¨RDBæ•°æ®åé¢çš„åˆ™æ˜¯AOFæ ¼å¼çš„æ•°æ®")]),s._v("ï¼Œå¦‚å›¾æ‰€ç¤º")]),s._v(" "),t("img",{staticStyle:{zoom:"50%"},attrs:{src:v(578),alt:"image-20210324173958322"}}),s._v(" "),t("h2",{attrs:{id:"åŒæ—¶ä½¿ç”¨rdbå’Œaof-4-0-å‰-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŒæ—¶ä½¿ç”¨rdbå’Œaof-4-0-å‰-ğŸ”¥"}},[s._v("#")]),s._v(" åŒæ—¶ä½¿ç”¨RDBå’ŒAOFâ€”4.0 å‰ ğŸ”¥")]),s._v(" "),t("p",[s._v("æ³¨æ„ä»¥ä¸‹é—®é¢˜å³å¯ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½éœ€è¦è€—è´¹å¤§é‡ç³»ç»Ÿèµ„æºï¼Œ"),t("strong",[s._v("ç³»ç»Ÿçš„ç¡¬ä»¶å¿…é¡»èƒ½å¤Ÿæ”¯æ’‘")]),s._v("è¿è¡Œè¿™ä¸¤ç§åŠŸèƒ½æ‰€éœ€çš„èµ„æºæ¶ˆè€—ï¼Œå¦åˆ™ä¼šç»™ç³»ç»Ÿæ€§èƒ½å¸¦æ¥å½±å“ã€‚")]),s._v(" "),t("li",[s._v("ğŸ”¥RedisæœåŠ¡å™¨åœ¨å¯åŠ¨æ—¶ï¼Œä¼š"),t("strong",[s._v("ä¼˜å…ˆä½¿ç”¨AOFæ–‡ä»¶è¿›è¡Œæ•°æ®æ¢å¤")]),s._v("ï¼Œ"),t("strong",[s._v("åªæœ‰åœ¨æ²¡æœ‰æ£€æµ‹åˆ°AOFæ–‡ä»¶")]),s._v("æ—¶ï¼Œ"),t("strong",[s._v("æ‰ä¼šè€ƒè™‘")]),s._v("å¯»æ‰¾å¹¶ä½¿ç”¨RDBæ–‡ä»¶è¿›è¡Œæ•°æ®æ¢å¤ã€‚"),t("strong",[s._v("è¦æ˜¯2ä¸ªéƒ½æœ‰ï¼Œåˆ™ä¼šåªä½¿ç”¨ AOF")]),s._v("ï¼ï¼ï¼åœ¨ä¼ä¸šçº§æ•°æ®æ¢å¤ä¸­æœ‰è¸©å‘ï¼")]),s._v(" "),t("li",[s._v("å½“RedisæœåŠ¡å™¨æ­£åœ¨åå°ç”Ÿæˆæ–°çš„RDBæ–‡ä»¶æ—¶ï¼Œå¦‚æœæœ‰ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€BGREWRITEAOFå‘½ä»¤ï¼Œæˆ–è€…é…ç½®é€‰é¡¹ä¸­è®¾ç½®çš„AOFé‡å†™æ¡ä»¶è¢«æ»¡è¶³äº†ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†æŠŠAOFé‡å†™æ“ä½œæ¨å»¶åˆ°RDBæ–‡ä»¶åˆ›å»ºå®Œæ¯•ä¹‹åå†æ‰§è¡Œï¼Œä»¥æ­¤æ¥é¿å…ä¸¤ç§æŒä¹…åŒ–æ“ä½œåŒæ—¶æ‰§è¡Œå¹¶äº‰æŠ¢ç³»ç»Ÿèµ„æºã€‚")]),s._v(" "),t("li",[s._v("åŒæ ·ï¼Œå½“æœåŠ¡å™¨æ­£åœ¨æ‰§è¡ŒBGREWRITEAOFå‘½ä»¤æ—¶ï¼Œç”¨æˆ·å‘é€æˆ–è€…è¢«è§¦å‘çš„BGSAVEå‘½ä»¤ä¹Ÿä¼šæ¨å»¶åˆ°BGREWRITEAOFå‘½ä»¤æ‰§è¡Œå®Œæ¯•ä¹‹åå†æ‰§è¡Œã€‚")])]),s._v(" "),t("h2",{attrs:{id:"rdbä¸aofåŒºåˆ«ä¸é€‰æ‹©ï¼ˆæ—§ï¼‰"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rdbä¸aofåŒºåˆ«ä¸é€‰æ‹©ï¼ˆæ—§ï¼‰"}},[s._v("#")]),s._v(" RDBä¸AOFåŒºåˆ«ä¸é€‰æ‹©ï¼ˆæ—§ï¼‰")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("æŒä¹…åŒ–æ–¹å¼")]),s._v(" "),t("th",[s._v("RDB")]),s._v(" "),t("th",[s._v("AOF")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("å ç”¨å­˜å‚¨ç©ºé—´")]),s._v(" "),t("td",[s._v("å°ï¼ˆæ•°æ®çº§ï¼šå‹ç¼©ï¼‰")]),s._v(" "),t("td",[s._v("å¤§ï¼ˆæŒ‡ä»¤çº§ï¼šé‡å†™ï¼‰")])]),s._v(" "),t("tr",[t("td",[s._v("å­˜å‚¨é€Ÿåº¦")]),s._v(" "),t("td",[s._v("æ…¢ï¼ˆæ•°æ®é‡å¤§æ—¶éå¸¸æ…¢ï¼‰")]),s._v(" "),t("td",[s._v("å¿«")])]),s._v(" "),t("tr",[t("td",[s._v("æ¢å¤é€Ÿåº¦")]),s._v(" "),t("td",[s._v("å¿«ï¼ˆç›´æ¥å¤åˆ¶ï¼‰")]),s._v(" "),t("td",[s._v("æ…¢ï¼ˆæ‰§è¡ŒæŒ‡ä»¤ï¼‰")])]),s._v(" "),t("tr",[t("td",[s._v("æ•°æ®å®‰å…¨æ€§")]),s._v(" "),t("td",[s._v("ä¼šä¸¢å¤±æ•°æ®")]),s._v(" "),t("td",[s._v("ä¾æ®ç­–ç•¥å†³å®š")])]),s._v(" "),t("tr",[t("td",[s._v("èµ„æºæ¶ˆè€—")]),s._v(" "),t("td",[s._v("é«˜/é‡é‡çº§ï¼ˆæ–‡ä»¶å¤§ï¼‰")]),s._v(" "),t("td",[s._v("ä½/è½»é‡çº§ï¼ˆæ–‡ä»¶å°ï¼‰")])]),s._v(" "),t("tr",[t("td",[s._v("å¯åŠ¨ä¼˜å…ˆçº§")]),s._v(" "),t("td",[s._v("ä½")]),s._v(" "),t("td",[t("strong",[s._v("é«˜")])])]),s._v(" "),t("tr",[t("td"),s._v(" "),t("td",[s._v("bgsave æ—¶å¯èƒ½çŸ­æš‚é˜»å¡")]),s._v(" "),t("td",[s._v("bgrewriteaof æ—¶å¯èƒ½çŸ­æš‚é˜»å¡")])])])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("å¯¹"),t("strong",[s._v("æ•°æ®éå¸¸æ•æ„Ÿ")]),s._v("ï¼Œå»ºè®®ä½¿ç”¨é»˜è®¤çš„"),t("strong",[s._v("AOF")]),s._v("æŒä¹…åŒ–æ–¹æ¡ˆ")]),s._v(" "),t("ul",[t("li",[s._v("AOFæŒä¹…åŒ–ç­–ç•¥ä½¿ç”¨everysecondï¼Œæ¯ç§’é’Ÿfsyncä¸€æ¬¡ã€‚è¯¥ç­–ç•¥redisä»å¯ä»¥ä¿æŒå¾ˆå¥½çš„å¤„ç†æ€§èƒ½ï¼Œå½“å‡ºç°é—®é¢˜æ—¶ï¼Œæœ€å¤šä¸¢å¤±0-1ç§’å†…çš„æ•°æ®ã€‚")]),s._v(" "),t("li",[s._v("æ³¨æ„ï¼šç”±äºAOFæ–‡ä»¶å­˜å‚¨ä½“ç§¯è¾ƒå¤§ï¼Œä¸”æ¢å¤é€Ÿåº¦è¾ƒæ…¢")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("æ•°æ®å‘ˆç°é˜¶æ®µæœ‰æ•ˆæ€§")]),s._v("ï¼Œå»ºè®®ä½¿ç”¨ "),t("strong",[s._v("RDB")]),s._v(" æŒä¹…åŒ–æ–¹æ¡ˆ")])]),s._v(" "),t("li",[t("ul",[t("li",[s._v("æ•°æ®å¯ä»¥è‰¯å¥½çš„åšåˆ°é˜¶æ®µå†…æ— ä¸¢å¤±ï¼ˆè¯¥é˜¶æ®µæ˜¯å¼€å‘è€…æˆ–è¿ç»´äººå‘˜æ‰‹å·¥ç»´æŠ¤çš„ï¼‰ï¼Œä¸”æ¢å¤é€Ÿåº¦è¾ƒå¿«ï¼Œé˜¶æ®µç‚¹æ•°æ®æ¢å¤é€šå¸¸é‡‡ç”¨RDBæ–¹æ¡ˆ")]),s._v(" "),t("li",[s._v("æ³¨æ„ï¼šåˆ©ç”¨RDBå®ç°ç´§å‡‘çš„æ•°æ®æŒä¹…åŒ–ä¼šä½¿Redisé™çš„å¾ˆä½ï¼Œæ…é‡")])])]),s._v(" "),t("li",[t("p",[s._v("ç»¼åˆæ¯”å¯¹ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("RDBä¸AOFçš„é€‰æ‹©å®é™…ä¸Šæ˜¯åœ¨åšä¸€ç§æƒè¡¡ï¼Œæ¯ç§éƒ½æœ‰åˆ©æœ‰å¼Š")]),s._v(" "),t("li",[s._v("å¦‚ä¸èƒ½æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œå¯¹ä¸šåŠ¡æ•°æ®éå¸¸æ•æ„Ÿï¼Œé€‰ç”¨AOF")]),s._v(" "),t("li",[s._v("å¦‚èƒ½æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œä¸”è¿½æ±‚å¤§æ•°æ®é›†çš„æ¢å¤é€Ÿåº¦ï¼Œé€‰ç”¨RDB")]),s._v(" "),t("li",[s._v("ç¾éš¾æ¢å¤é€‰ç”¨RDB")]),s._v(" "),t("li",[s._v("åŒä¿é™©ç­–ç•¥ï¼ŒåŒæ—¶å¼€å¯ RDB å’Œ AOFï¼Œé‡å¯åï¼ŒRedisä¼˜å…ˆä½¿ç”¨ AOF æ¥æ¢å¤æ•°æ®ï¼Œé™ä½ä¸¢å¤±æ•°æ®çš„é‡")])])])]),s._v(" "),t("h2",{attrs:{id:"æ— æŒä¹…åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ— æŒä¹…åŒ–"}},[s._v("#")]),s._v(" æ— æŒä¹…åŒ–")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('save ""\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"æŒä¹…åŒ–åº”ç”¨åœºæ™¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æŒä¹…åŒ–åº”ç”¨åœºæ™¯"}},[s._v("#")]),s._v(" æŒä¹…åŒ–åº”ç”¨åœºæ™¯")]),s._v(" "),t("ul",[t("li",[t("s",[s._v("Tips 1:redisç”¨äºæ§åˆ¶æ•°æ®åº“è¡¨ä¸»é”®idï¼Œä¸ºæ•°æ®åº“è¡¨ä¸»é”®æä¾›ç”Ÿæˆç­–ç•¥ï¼Œä¿éšœæ•°æ®åº“è¡¨çš„ä¸»é”®å”¯ä¸€æ€§")]),s._v("ã€‚æ•°æ®åº“è¯»æœ€å¤§å€¼+1")]),s._v(" "),t("li",[t("s",[s._v("Tips 3:redisåº”ç”¨äºå„ç§ç»“æ„å‹å’Œéç»“æ„å‹é«˜çƒ­åº¦æ•°æ®è®¿é—®åŠ é€Ÿ")]),s._v("ã€‚æ•°æ®åº“ä¹Ÿå­˜äº†")]),s._v(" "),t("li",[t("s",[s._v("Tips 4:redis åº”ç”¨äºè´­ç‰©è½¦æ•°æ®å­˜å‚¨è®¾è®¡")]),s._v("ã€‚æ•°æ®åº“ä¹Ÿå­˜äº†")]),s._v(" "),t("li",[s._v("Tips 5:redis åº”ç”¨äºæŠ¢è´­ï¼Œé™è´­ç±»ã€é™é‡å‘æ”¾ä¼˜æƒ å·ã€æ¿€æ´»ç ç­‰ä¸šåŠ¡çš„æ•°æ®å­˜å‚¨è®¾è®¡")]),s._v(" "),t("li",[s._v("Tips 6:redis åº”ç”¨äºå…·æœ‰æ“ä½œå…ˆåé¡ºåºçš„æ•°æ®æ§åˆ¶")]),s._v(" "),t("li",[s._v("Tips 7:redis åº”ç”¨äºæœ€æ–°æ¶ˆæ¯å±•ç¤º")]),s._v(" "),t("li",[t("s",[s._v("Tips 9:redis åº”ç”¨äºåŒç±»ä¿¡æ¯çš„å…³è”æœç´¢ï¼ŒäºŒåº¦å…³è”æœç´¢ï¼Œæ·±åº¦å…³è”æœç´¢")])]),s._v(" "),t("li",[s._v("Tips 12:redis åº”ç”¨äºåŸºäºé»‘åå•ï¼ˆæ•°æ®åº“ä¸ä¸€å®šæœ‰ï¼‰ä¸ç™½åå•ï¼ˆæ•°æ®åº“è‚¯å®šæœ‰ï¼‰è®¾å®šçš„æœåŠ¡æ§åˆ¶")]),s._v(" "),t("li",[s._v("Tips 13:redis åº”ç”¨äºè®¡æ•°å™¨ç»„åˆæ’åºåŠŸèƒ½å¯¹åº”çš„æ’å")]),s._v(" "),t("li",[t("s",[s._v("Tips 15:redis åº”ç”¨äºå³æ—¶ä»»åŠ¡/æ¶ˆæ¯é˜Ÿåˆ—æ‰§è¡Œç®¡ç†")]),s._v("ã€‚MQ")]),s._v(" "),t("li",[t("s",[s._v("Tips 16:redis åº”ç”¨äºæŒ‰æ¬¡ç»“ç®—çš„æœåŠ¡æ§åˆ¶")])])]),s._v(" "),t("p",[s._v("ä¸åŒ"),t("strong",[s._v("åº“")]),s._v("ï¼ˆä¸æ˜¯é‚£16ä¸ªdbï¼‰é‡Œä¸åŒæŒä¹…åŒ–æ–¹å¼ï¼")]),s._v(" "),t("h2",{attrs:{id:"shutdown"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#shutdown"}},[s._v("#")]),s._v(" SHUTDOWN")]),s._v(" "),t("p",[s._v("ç”¨æˆ·å¯ä»¥é€šè¿‡æ‰§è¡ŒSHUTDOWNå‘½ä»¤æ¥å…³é—­RedisæœåŠ¡å™¨")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("SHUTDOWN\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“RedisæœåŠ¡å™¨æ¥æ”¶åˆ°SHUTDOWNå‘½ä»¤æ—¶ï¼Œå®ƒå°†æ‰§è¡Œä»¥ä¸‹åŠ¨ä½œï¼š")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("åœæ­¢å¤„ç†å®¢æˆ·ç«¯å‘é€çš„å‘½ä»¤è¯·æ±‚ã€‚")])]),s._v(" "),t("li",[t("p",[s._v("æ ¹æ®æœåŠ¡å™¨çš„æŒä¹…åŒ–é…ç½®é€‰é¡¹ï¼Œå†³å®šæ˜¯å¦æ‰§è¡Œæ•°æ®ä¿å­˜æ“ä½œï¼š")]),s._v(" "),t("ul",[t("li",[s._v("å¦‚æœæœåŠ¡å™¨å¯ç”¨äº†RDBæŒä¹…åŒ–åŠŸèƒ½ï¼Œå¹¶ä¸”æ•°æ®åº“è·ç¦»æœ€åä¸€æ¬¡æˆåŠŸåˆ›å»ºRDBæ–‡ä»¶ä¹‹åå·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†æ‰§è¡ŒSAVEå‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„RDBæ–‡ä»¶ã€‚")]),s._v(" "),t("li",[s._v("å¦‚æœæœåŠ¡å™¨å¯ç”¨äº†AOFæŒä¹…åŒ–åŠŸèƒ½æˆ–è€…RDB-AOFæ··åˆæŒä¹…åŒ–åŠŸèƒ½ï¼Œé‚£ä¹ˆå®ƒå°†å†²æ´—AOFæ–‡ä»¶ï¼Œç¡®ä¿æ‰€æœ‰å·²æ‰§è¡Œçš„å‘½ä»¤éƒ½è¢«è®°å½•åˆ°äº†AOFæ–‡ä»¶ä¸­ã€‚")]),s._v(" "),t("li",[s._v("å¦‚æœæœåŠ¡å™¨æ—¢æ²¡æœ‰å¯ç”¨RDBæŒä¹…åŒ–åŠŸèƒ½ï¼Œä¹Ÿæ²¡æœ‰å¯ç”¨AOFæŒä¹…åŒ–åŠŸèƒ½ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†ç•¥è¿‡è¿™ä¸€æ­¥ã€‚")])])]),s._v(" "),t("li",[t("p",[s._v("æœåŠ¡å™¨è¿›ç¨‹é€€å‡º")])])]),s._v(" "),t("p",[s._v("å› ä¸ºRedisæœåŠ¡å™¨åœ¨æ¥æ”¶åˆ°SHUTDOWNå‘½ä»¤å¹¶å…³é—­è‡ªèº«çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæ ¹æ®é…ç½®é€‰é¡¹æ¥å†³å®šæ˜¯å¦æ‰§è¡Œæ•°æ®ä¿å­˜æ“ä½œï¼Œæ‰€ä»¥åªè¦æœåŠ¡å™¨"),t("strong",[s._v("å¯ç”¨äº†æŒä¹…åŒ–åŠŸèƒ½")]),s._v("ï¼Œé‚£ä¹ˆ"),t("strong",[s._v("ä½¿ç”¨SHUTDOWNå‘½ä»¤æ¥å…³é—­æœåŠ¡å™¨å°±ä¸ä¼šé€ æˆä»»ä½•æ•°æ®ä¸¢å¤±")])]),s._v(" "),t("p",[s._v("ä½¿ç”¨SHUTDOWNå‘½ä»¤æä¾›çš„"),t("code",[s._v("save")]),s._v("é€‰é¡¹æˆ–è€…"),t("code",[s._v("nosave")]),s._v("é€‰é¡¹ï¼Œæ˜¾å¼åœ°æŒ‡ç¤ºæœåŠ¡å™¨åœ¨å…³é—­ä¹‹å‰æ˜¯å¦éœ€è¦æ‰§è¡ŒæŒä¹…åŒ–æ“ä½œï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("SHUTDOWN [save|nosave]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("å¦‚æœç”¨æˆ·ç»™å®šçš„æ˜¯saveé€‰é¡¹ï¼Œé‚£ä¹ˆæ— è®ºæœåŠ¡å™¨æ˜¯å¦å¯ç”¨äº†æŒä¹…åŒ–åŠŸèƒ½ï¼ŒæœåŠ¡å™¨éƒ½ä¼šåœ¨å…³é—­ä¹‹å‰æ‰§è¡Œä¸€æ¬¡æŒä¹…åŒ–æ“ä½œã€‚ä¸‹å›¾å±•ç¤ºäº†æœåŠ¡å™¨åœ¨ä¸åŒæŒä¹…åŒ–é…ç½®ä¸‹ï¼Œæ‰§è¡ŒSHUTDOWN saveå‘½ä»¤æ—¶çš„è¡Œä¸º")]),s._v(" "),t("p",[t("img",{attrs:{src:v(579),alt:"image-20210324181416803"}})]),s._v(" "),t("p",[s._v("å¦‚æœç”¨æˆ·ç»™å®šçš„æ˜¯nosaveé€‰é¡¹ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†ä¸æ‰§è¡ŒæŒä¹…åŒ–æ“ä½œï¼Œç›´æ¥å…³é—­æœåŠ¡å™¨ã€‚ä¼šä¸¢å¤±å°šæœªä¿å­˜çš„æ•°æ®")]),s._v(" "),t("h2",{attrs:{id:"ä¼ä¸šçº§æ•°æ®å¤‡ä»½æ–¹æ¡ˆ-æ•°æ®æ¢å¤å®¹ç¾æ¼”ç»ƒ-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä¼ä¸šçº§æ•°æ®å¤‡ä»½æ–¹æ¡ˆ-æ•°æ®æ¢å¤å®¹ç¾æ¼”ç»ƒ-ğŸ”¥"}},[s._v("#")]),s._v(" ä¼ä¸šçº§æ•°æ®å¤‡ä»½æ–¹æ¡ˆ & æ•°æ®æ¢å¤å®¹ç¾æ¼”ç»ƒ ğŸ”¥")]),s._v(" "),t("h3",{attrs:{id:"æŒä¹…åŒ–çš„é…ç½®ç­–ç•¥-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æŒä¹…åŒ–çš„é…ç½®ç­–ç•¥-ğŸ”¥"}},[s._v("#")]),s._v(" æŒä¹…åŒ–çš„é…ç½®ç­–ç•¥ ğŸ”¥")]),s._v(" "),t("p",[s._v("RDB é…ç½®é»˜è®¤ä¸º")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("save 60 10000\nsave 300 100\nsave 3600 1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("æ— éœ€æ”¹å˜ã€‚å¦‚æœä½ å¸Œæœ›å°½å¯èƒ½ç¡®ä¿è¯´ï¼ŒRDBæœ€å¤šä¸¢1åˆ†é’Ÿçš„æ•°æ®ï¼Œé‚£ä¹ˆå°½é‡å°±æ˜¯æ¯éš”1åˆ†é’Ÿéƒ½ç”Ÿæˆä¸€ä¸ªå¿«ç…§ï¼Œä½å³°æœŸæˆ–æ•°æ®é‡å¾ˆå°‘æ—¶ä¹Ÿæ²¡å¿…è¦")]),s._v(" "),t("p",[s._v("å¼€å¯ AOFï¼Œå¹¶é…ç½®ï¼ˆé»˜è®¤ï¼‰")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("appendfsync everysec # ä¸ç”¨æ”¹ï¼\nauto-aof-rewrite-percentage 100 # æ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µä¿®æ”¹\nauto-aof-rewrite-min-size 64mb # æ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µä¿®æ”¹\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"æ•°æ®å†·å¤‡ä»½æ–¹æ¡ˆ-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®å†·å¤‡ä»½æ–¹æ¡ˆ-ğŸ”¥"}},[s._v("#")]),s._v(" æ•°æ®å†·å¤‡ä»½æ–¹æ¡ˆ ğŸ”¥")]),s._v(" "),t("p",[s._v("RDBéå¸¸é€‚åˆåšå†·å¤‡ï¼Œæ¯æ¬¡ç”Ÿæˆä¹‹åï¼Œå°±ä¸ä¼šå†æœ‰ä¿®æ”¹äº†ã€‚å…·ä½“æ–¹æ¡ˆï¼š")]),s._v(" "),t("ul",[t("li",[s._v("å†™ "),t("strong",[s._v("crontab")]),s._v(" å®šæ—¶è°ƒåº¦è„šæœ¬å»åšæ•°æ®å¤‡ä»½")]),s._v(" "),t("li",[t("strong",[s._v("æ¯å°æ—¶")]),s._v("éƒ½copyä¸€ä»½rdbçš„å¤‡ä»½ï¼Œåˆ°ä¸€ä¸ªç›®å½•ä¸­å»ï¼Œä»…ä»…ä¿ç•™"),t("strong",[s._v("æœ€è¿‘48å°æ—¶")]),s._v("çš„å¤‡ä»½")]),s._v(" "),t("li",[t("strong",[s._v("æ¯å¤©éƒ½")]),s._v("ä¿ç•™ä¸€ä»½å½“æ—¥çš„rdbçš„å¤‡ä»½ï¼Œåˆ°ä¸€ä¸ªç›®å½•ä¸­å»ï¼Œä»…ä»…ä¿ç•™"),t("strong",[s._v("æœ€è¿‘1ä¸ªæœˆ")]),s._v("çš„å¤‡ä»½")]),s._v(" "),t("li",[s._v("æ¯æ¬¡copyå¤‡ä»½çš„æ—¶å€™ï¼Œéƒ½æŠŠå¤ªæ—§çš„å¤‡ä»½ç»™åˆ äº†")]),s._v(" "),t("li",[s._v("æ¯å¤©æ™šä¸Šå°†å½“å‰æœåŠ¡å™¨ä¸Šæ‰€æœ‰çš„æ•°æ®å¤‡ä»½ï¼Œå‘é€ä¸€ä»½åˆ°è¿œç¨‹çš„äº‘æœåŠ¡ä¸Šå»")])]),s._v(" "),t("p",[s._v("æ¯å°æ—¶çš„è„šæœ¬æ–‡ä»¶"),t("code",[s._v("redis_rdb_copy_hourly.sh")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh ")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("cur_date")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%Y%m%d%k"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /usr/local/redis/snapshotting/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cur_date")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/redis/snapshotting/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cur_date")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /var/redis/6379/dump.rdb /usr/local/redis/snapshotting/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cur_date")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("del_date")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" -d -48hour +%Y%m%d%k"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /usr/local/redis/snapshotting/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$del_date")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("å†™"),t("code",[s._v("crontab")]),s._v("å®šæ—¶å™¨")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("ubuntu@VM-0-3-ubuntu:~$ crontab -e\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ç¼–è¾‘å†…å®¹å¦‚ä¸‹")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("0 * * * * sh /usr/local/redis/copy/redis_rdb_copy_hourly.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("æ³¨ï¼šç¬¬1ä½ä»£è¡¨åˆ†é’Ÿï¼")]),s._v(" "),t("p",[s._v("æ¯å¤©çš„è„šæœ¬æ–‡ä»¶"),t("code",[s._v("redis_rdb_copy_daily.sh")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh ")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("cur_date")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%Y%m%d"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /usr/local/redis/snapshotting/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cur_date")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/redis/snapshotting/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cur_date")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /var/redis/6379/dump.rdb /usr/local/redis/snapshotting/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cur_date")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("del_date")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" -d -1month +%Y%m%d"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /usr/local/redis/snapshotting/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$del_date")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("å†™"),t("code",[s._v("crontab")]),s._v("å®šæ—¶å™¨")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("ubuntu@VM-0-3-ubuntu:~$ crontab -e\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("ç¼–è¾‘å†…å®¹å¦‚ä¸‹")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("0 0 * * * sh /usr/local/redis/copy/redis_rdb_copy_daily.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("æ³¨ï¼šç¬¬1ä½ä»£è¡¨åˆ†é’Ÿï¼ç¬¬2ä½ä»£è¡¨å°æ—¶ï¼")]),s._v(" "),t("h3",{attrs:{id:"æ•°æ®æ¢å¤æ–¹æ¡ˆ-rdb-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®æ¢å¤æ–¹æ¡ˆ-rdb-ğŸ”¥"}},[s._v("#")]),s._v(" æ•°æ®æ¢å¤æ–¹æ¡ˆâ€”RDB ğŸ”¥")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("å¦‚æœæ˜¯redisè¿›ç¨‹æŒ‚æ‰ï¼Œé‚£ä¹ˆé‡å¯redisè¿›ç¨‹å³å¯ï¼Œç›´æ¥åŸºäºAOFæ—¥å¿—æ–‡ä»¶æ¢å¤æ•°æ®")]),s._v(" "),t("p",[s._v("æœ€å¤šä¸¢1ç§’æ•°æ®")])]),s._v(" "),t("li",[t("p",[s._v("å¦‚æœæ˜¯redisè¿›ç¨‹æŒ‚æ‰ï¼Œé‚£ä¹ˆé‡å¯redisè¿›ç¨‹å³å¯ï¼Œç›´æ¥åŸºäºAOFæ—¥å¿—æ–‡ä»¶æ¢å¤æ•°æ®")]),s._v(" "),t("p",[s._v("AOFæ²¡æœ‰ç ´æŸï¼Œä¹Ÿæ˜¯å¯ä»¥ç›´æ¥åŸºäºAOFæ¢å¤çš„ã€‚å¦‚æœAOFæ–‡ä»¶ç ´æŸï¼Œé‚£ä¹ˆç”¨"),t("code",[s._v("redis-check-aof fix")]),s._v("ä¿®å¤")])]),s._v(" "),t("li",[t("p",[s._v("å¦‚æœrediså½“å‰"),t("strong",[s._v("æœ€æ–°çš„AOFå’ŒRDBæ–‡ä»¶å‡ºç°äº†ä¸¢å¤±/æŸå")]),s._v("ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•åŸºäºè¯¥æœºå™¨ä¸Šå½“å‰çš„æŸä¸ª"),t("strong",[s._v("æœ€æ–°çš„RDBæ•°æ®å‰¯æœ¬")]),s._v("è¿›è¡Œæ•°æ®æ¢å¤")]),s._v(" "),t("p",[s._v("è¿™ç§æƒ…å†µä¸€èˆ¬ä¸æ˜¯æœºå™¨é—®é¢˜ï¼Œæ˜¯äººä¸ºçš„ã€‚å¤§æ•°æ®ç³»ç»Ÿï¼Œhadoopï¼Œæœ‰äººä¸å°å¿ƒå°±æŠŠhadoopä¸­å­˜å‚¨çš„å¤§é‡çš„æ•°æ®æ–‡ä»¶å¯¹åº”çš„ç›®å½•ï¼Œrm -rf ä¸€ä¸‹ã€‚å°å…¬å¸ï¼Œè¿ç»´ä¸å¤ªé è°±ï¼Œæƒé™ä¹Ÿå¼„çš„ä¸å¤ªå¥½ï¼ŒæŠŠ /var/redis/6379 ä¸‹çš„æ–‡ä»¶ç»™åˆ é™¤äº†")]),s._v(" "),t("p",[s._v("æ‰¾åˆ°RDBæœ€æ–°çš„ä¸€ä»½å¤‡ä»½ï¼Œå°æ—¶çº§çš„å³å¯ï¼Œcopyåˆ°redisé‡Œé¢å»ï¼Œå°±å¯ä»¥æ¢å¤åˆ°æŸä¸€ä¸ªå°æ—¶çš„æ•°æ®ã€‚")]),s._v(" "),t("p",[s._v("**ä½†æ˜¯ä½†æ˜¯ä½†æ˜¯ï¼æ³¨æ„ï¼š**AOF å’Œ RDB ä¼šä¼˜å…ˆä½¿ç”¨ AOFï¼Œåªæœ‰æ²¡æœ‰ AOF æ–‡ä»¶æ—¶æ‰ä¼šä½¿ç”¨ RDBã€‚")]),s._v(" "),t("p",[t("strong",[s._v("æ‰€ä»¥éœ€è¦åœæ­¢ Redisï¼Œå…³é—­é…ç½®æ–‡ä»¶ä¸­çš„ AOFï¼Œæ‹·è´ RDB å¤‡ä»½ï¼Œé‡å¯ Redis ç¡®è®¤æ•°æ®æ¢å¤ï¼Œç„¶ååœ¨å‘½ä»¤è¡Œä¸­æ‰“å¼€ AOFï¼ˆé¦–æ¬¡æ‰§è¡Œå‘½ä»¤ä¼šä¹Ÿæ˜¯ä¸ºäº†é˜»å¡ç”Ÿæˆdumpæ–‡ä»¶ï¼Œæ–¹ä¾¿åç»­è¿½åŠ ï¼Œå»ºè®®åœ¨ä½å³°æœŸæ“ä½œï¼‰ã€‚æ­¤æ—¶å¯ä»¥åœæ­¢ Redisï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­ AOF ä¸º yesï¼Œé‡å¯ Redisï¼Œå½»åº•è§£å†³ï¼")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("CONFIG SET appendonly yes\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("å¦‚æœå½“å‰æœºå™¨ä¸Šçš„æ‰€æœ‰RDBæ–‡ä»¶å…¨éƒ¨æŸåï¼Œé‚£ä¹ˆä»è¿œç¨‹çš„äº‘æœåŠ¡ä¸Šæ‹‰å–æœ€æ–°çš„RDBå¿«ç…§å›æ¥æ¢å¤æ•°æ®")])]),s._v(" "),t("li",[t("p",[s._v("å¦‚æœæ˜¯å‘ç°æœ‰é‡å¤§çš„æ•°æ®é”™è¯¯ï¼Œæ¯”å¦‚æŸä¸ªå°æ—¶ä¸Šçº¿çš„ç¨‹åºä¸€ä¸‹å­å°†æ•°æ®å…¨éƒ¨æ±¡æŸ“äº†ï¼Œæ•°æ®å…¨é”™äº†ï¼Œé‚£ä¹ˆå¯ä»¥é€‰æ‹©æŸä¸ªæ›´æ—©çš„æ—¶é—´ç‚¹ï¼Œå¯¹æ•°æ®è¿›è¡Œæ¢å¤")])])]),s._v(" "),t("h3",{attrs:{id:"æ•°æ®æ¢å¤æ–¹æ¡ˆ-4-0å-ğŸ”¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®æ¢å¤æ–¹æ¡ˆ-4-0å-ğŸ”¥"}},[s._v("#")]),s._v(" æ•°æ®æ¢å¤æ–¹æ¡ˆâ€”4.0å ğŸ”¥")]),s._v(" "),t("p",[s._v("å¯ä»¥åˆ©ç”¨ä¸Šé¢æ€è·¯ï¼Œä½¿ç”¨  RDB-AOF æ··åˆæŒä¹…åŒ–ï¼ˆæœ€ç»ˆè¿˜æ˜¯ AOF æ–‡ä»¶ï¼‰æ¥è¿›è¡Œå¤‡ä»½ä»¥åŠæ•°æ®æ¢å¤ï¼")])])}),[],!1,null,null,null);a.default=e.exports}}]);