(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{560:function(t,s,a){t.exports=a.p+"assets/img/image-20210324220455060.bd26d4df.png"},561:function(t,s,a){t.exports=a.p+"assets/img/image-20210324220828692.cad5cd64.png"},562:function(t,s,a){t.exports=a.p+"assets/img/image-20210324220952133.7aa022d1.png"},563:function(t,s,a){t.exports=a.p+"assets/img/image-20210324221401134.f00597a6.png"},564:function(t,s,a){t.exports=a.p+"assets/img/image-20210324221506782.cc9a51e1.png"},747:function(t,s,a){"use strict";a.r(s);var v=a(11),_=Object(v.a)({},(function(){var t=this,s=t.$createElement,v=t._self._c||s;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"bitmap-位图"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#bitmap-位图"}},[t._v("#")]),t._v(" bitmap—位图")]),t._v(" "),v("p",[t._v("Redis的位图是在"),v("strong",[t._v("字符串")]),t._v("的基础上实现的，所以它会把位图键看作一个字符串键。所以可以使用字符串命令对位图进行操作")]),t._v(" "),v("h2",{attrs:{id:"🔥setbit-设置二进制位的值"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔥setbit-设置二进制位的值"}},[t._v("#")]),t._v(" 🔥SETBIT 设置二进制位的值")]),t._v(" "),v("p",[t._v("通过使用SETBIT命令，用户可以为位图**指定偏移量（从0开始）**上的二进制位设置值")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("setbit bitmap offset value\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("SETBIT命令在对二进制位进行设置之后，将"),v("strong",[t._v("返回")]),t._v("二进制位被设置之前的"),v("strong",[t._v("旧值")]),t._v("作为结果")]),t._v(" "),v("p",[t._v("注意：")]),t._v(" "),v("ul",[v("li",[t._v("当用户执行SETBIT命令尝试对一个位图进行设置的时候，如果"),v("strong",[t._v("位图不存在")]),t._v("，或者位图当前的大小无法满足用户想要执行的设置操作，那么Redis将对"),v("strong",[t._v("被设置的位图进行扩展")]),t._v("，使得位图可以满足用户的设置请求")]),t._v(" "),v("li",[t._v("因为Redis对位图的扩展操作是以字节为单位进行的，所以扩展之后的位图包含的"),v("strong",[t._v("二进制位数量")]),t._v("可能会比用户要求的"),v("strong",[t._v("稍微多一些")]),t._v("，并且在扩展位图的同时，Redis还会将"),v("strong",[t._v("所有未被设置的二进制")]),t._v("位的值"),v("strong",[t._v("初始化为0")]),t._v("。")]),t._v(" "),v("li",[t._v("SETBIT命令"),v("strong",[t._v("只能使用正数偏移量")]),t._v("，尝试输入负数作为偏移量将引发一个错误")])]),t._v(" "),v("p",[v("img",{attrs:{src:a(560),alt:"image-20210324220455060"}})]),t._v(" "),v("h2",{attrs:{id:"🔥getbit-获取二进制位的值"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔥getbit-获取二进制位的值"}},[t._v("#")]),t._v(" 🔥GETBIT 获取二进制位的值")]),t._v(" "),v("p",[t._v("使用GETBIT命令，用户可以获取位图指定偏移量上的二进制位的值：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("getbit bitmap offset\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("注意：")]),t._v(" "),v("ul",[v("li",[t._v("与SETBIT命令一样，GETBIT命令也只能接受"),v("strong",[t._v("正数作为偏移量")])]),t._v(" "),v("li",[t._v("如果用户输入的"),v("strong",[t._v("偏移量超过了")]),t._v("位图目前拥有的"),v("strong",[t._v("最大偏移量")]),t._v("，那么GETBIT命令将"),v("strong",[t._v("返回0作为结果")])])]),t._v(" "),v("h2",{attrs:{id:"🔥bitcount-统计被设置的二进制位数量"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔥bitcount-统计被设置的二进制位数量"}},[t._v("#")]),t._v(" 🔥BITCOUNT 统计被设置的二进制位数量")]),t._v(" "),v("p",[t._v("用户可以通过执行BITCOUNT命令统计位图中"),v("strong",[t._v("值为1")]),t._v("的二进制位"),v("strong",[t._v("数量")])]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("bitcount key [start end]\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("div",{staticClass:"custom-block danger"},[v("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("start参数和end参数与本章之前介绍的SETBIT命令和GETBIT命令的offset参数并不相同，这两个参数是用来指定"),v("strong",[t._v("字节偏移量")]),t._v("而"),v("strong",[t._v("不是二进制位偏移量")]),t._v("的。位图的字节偏移量与Redis其他数据结构的偏移量一样，都是从0开始的：位图第一个字节的偏移量为0，第二个字节的偏移量为1，第三个字节的偏移量为2，以此类推。")]),t._v(" "),v("p",[v("img",{attrs:{src:a(561),alt:"image-20210324220828692"}})])]),t._v(" "),v("li",[v("p",[t._v("start参数和end参数的值除了可以是正数之外，还可以是负数")]),t._v(" "),v("p",[v("img",{attrs:{src:a(562),alt:"image-20210324220952133"}})])])])]),t._v(" "),v("h2",{attrs:{id:"bitpos-查找第一个指定的二进制位值"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#bitpos-查找第一个指定的二进制位值"}},[t._v("#")]),t._v(" BITPOS 查找第一个指定的二进制位值")]),t._v(" "),v("p",[t._v("通过执行BITPOS命令，在位图中查找第一个被设置为指定值的二进制位，并返回这个所处"),v("strong",[t._v("整个位图")]),t._v("的"),v("strong",[t._v("二进制位的偏移量")])]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("bitpos bitmap value [start end]\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("div",{staticClass:"custom-block danger"},[v("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("通过可选的start参数和end参数，让BITPOS命令只在"),v("strong",[t._v("指定字节范围（注意）"),v("strong",[t._v("内的")]),t._v("二进制位")]),t._v("中进行查找")]),t._v(" "),v("p",[v("img",{attrs:{src:a(563),alt:"image-20210324221401134"}})])]),t._v(" "),v("li",[v("p",[t._v("start参数和end参数也可以是负数")]),t._v(" "),v("p",[v("img",{attrs:{src:a(564),alt:"image-20210324221506782"}})])]),t._v(" "),v("li",[v("p",[t._v("当用户尝试对一个"),v("strong",[t._v("不存在的位图")]),t._v("或者一个"),v("strong",[t._v("所有位都被设置成了0")]),t._v("的位图中查"),v("strong",[t._v("找值为1")]),t._v("的二进制位时，该命令将返回-1作为结果")])]),t._v(" "),v("li",[v("p",[t._v("如果用户在一个"),v("strong",[t._v("所有位都被设置成1")]),t._v("的位图中查"),v("strong",[t._v("找值为0")]),t._v("的二进制位，那么该命令将返回位图"),v("strong",[t._v("最大偏移量加上1")]),t._v("（Redis会把位图中不存在的二进制位的值看作0）作为结果")])])])]),t._v(" "),v("h2",{attrs:{id:"🔥bitop-执行二进制位运算"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔥bitop-执行二进制位运算"}},[t._v("#")]),t._v(" 🔥BITOP 执行二进制位运算")]),t._v(" "),v("p",[t._v("通过BITOP命令，对一个或多个位图执行指定的二进制位运算，并将运算结果存储到指定的键中")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("bitop operation result_key bitmap [bitmap ...]\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("ul",[v("li",[t._v("and")]),t._v(" "),v("li",[t._v("or")]),t._v(" "),v("li",[t._v("not")]),t._v(" "),v("li",[t._v("xor")])]),t._v(" "),v("p",[t._v("当BITOP命令在对两个长度不同的位图执行运算时，会将"),v("strong",[t._v("长度较短的那个位图中不存在的二进制位的值看作0")])]),t._v(" "),v("h2",{attrs:{id:"bitfield-在位图中存储整数值-未完"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#bitfield-在位图中存储整数值-未完"}},[t._v("#")]),t._v(" BITFIELD 在位图中存储整数值—未完")]),t._v(" "),v("p",[t._v("BITFIELD命令允许用户在位图中的任意区域（field）存储指定长度的整数值，并对这些整数值执行加法或减法操作。BITFIELD命令支持SET、GET、INCRBY、OVERFLOW这4个子命令")]),t._v(" "),v("h2",{attrs:{id:""}},[v("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" =======================================")]),t._v(" "),v("h2",{attrs:{id:"🔥【场景】应用于信息状态统计"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#🔥【场景】应用于信息状态统计"}},[t._v("#")]),t._v(" 🔥【场景】应用于信息状态统计")]),t._v(" "),v("h3",{attrs:{id:"业务场景"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#业务场景"}},[t._v("#")]),t._v(" 业务场景")]),t._v(" "),v("p",[t._v("电影网站，要统计：")]),t._v(" "),v("ul",[v("li",[t._v("统计每天某一部电影是否被点播")]),t._v(" "),v("li",[t._v("统计每天有多少部电影被点播")]),t._v(" "),v("li",[t._v("统计每周/月/年有多少部电影被点播")]),t._v(" "),v("li",[t._v("统计年度哪部电影没有被点播")])]),t._v(" "),v("p",[t._v("运用 bitcount，bitop操作即可")])])}),[],!1,null,null,null);s.default=_.exports}}]);