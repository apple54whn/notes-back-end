(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{753:function(s,a,e){"use strict";e.r(a);var t=e(11),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"安装-配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装-配置"}},[s._v("#")]),s._v(" 安装&配置")]),s._v(" "),e("h2",{attrs:{id:"官网"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#官网"}},[s._v("#")]),s._v(" 官网")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://redis.io",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"http://www.redis.net.cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("中文网"),e("OutboundLink")],1)])]),s._v(" "),e("h2",{attrs:{id:"从源码安装-🔥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#从源码安装-🔥"}},[s._v("#")]),s._v(" 从源码安装 🔥")]),s._v(" "),e("p",[s._v("下载、解压、编译 Redis：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://download.redis.io/releases/redis-6.2.1.tar.gz\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xzf redis-6.2.1.tar.gz\n$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" redis-6.2.1\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("现在编译的二进制文件可以在 src 目录中找到。运行：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ src/redis-server "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("redis.conf"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("你可以使用内置的客户端与 Redis 进行交互")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ src/redis-cli\nredis"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" foo bar\nOK\nredis"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" get foo\n"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bar"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("一般推荐创建 conf、data 目录")]),s._v(" "),e("h2",{attrs:{id:"docker-暂不推荐-🔥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-暂不推荐-🔥"}},[s._v("#")]),s._v(" Docker—暂不推荐 🔥")]),s._v(" "),e("p",[s._v("目前了解到的配置不够，暂不推荐")]),s._v(" "),e("p",[s._v("参考"),e("a",{attrs:{href:"https://hub.docker.com/_/redis/",target:"_blank",rel:"noopener noreferrer"}},[s._v("文档"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker pull redis\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("使用 docker compose 可以参考 Google 搜索结果，或如下（不是最新的 compose 文件了）")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'no'")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 6379"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("启动 Redis 容器")]),s._v(" "),e("ul",[e("li",[s._v("执行"),e("code",[s._v("docker compose up -d")]),s._v("下载启动即可")])]),s._v(" "),e("p",[s._v("进入 Redis 容器，使用 cli")]),s._v(" "),e("ul",[e("li",[s._v("执行"),e("code",[s._v("docker exec -it b2 redis-cli")]),s._v("。当然也可以进入 bash 后执行"),e("code",[s._v("redis-cli")])])]),s._v(" "),e("h2",{attrs:{id:"windows-版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#windows-版"}},[s._v("#")]),s._v(" Windows 版")]),s._v(" "),e("p",[s._v("只能使用 "),e("a",{attrs:{href:"https://github.com/tporadowski/redis",target:"_blank",rel:"noopener noreferrer"}},[s._v("Github"),e("OutboundLink")],1),s._v(" 上维护的版本！还算新！")]),s._v(" "),e("p",[s._v("解压直接可以使用：")]),s._v(" "),e("ul",[e("li",[s._v("redis.windows.conf：配置文件")]),s._v(" "),e("li",[s._v("redis-cli.exe：redis 的客户端")]),s._v(" "),e("li",[s._v("redis-server.exe：redis 服务器端")])]),s._v(" "),e("h2",{attrs:{id:"配置-🔥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置-🔥"}},[s._v("#")]),s._v(" 配置 🔥")]),s._v(" "),e("h3",{attrs:{id:"简介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),e("p",[s._v("Redis 的配置文件位于 Redis 安装目录下，文件名为 redis.conf。你可以通过 "),e("strong",[s._v("CONFIG")]),s._v(" 命令查看或设置配置项。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("CONFIG GET CONFIG_SETTING_NAME\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("使用如下命令保存配置到 redis-6379.conf，并查看")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" redis.conf "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^$"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" redis-6379.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("也可以之间使用 "),e("strong",[s._v("*")]),s._v(" 号获取所有配置项")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("config get *\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("你可以通过"),e("strong",[s._v("修改 redis.conf 文件")]),s._v("或使用 "),e("strong",[s._v("CONFIG SET")]),s._v(" 命令来修改配置。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("CONFIG SET CONFIG_SETTING_NAME NEW_CONFIG_VALUE\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("常见配置")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('protected-mode no # 允许外网访问\n# bind 127.0.0.1 # 必须去掉，允许外网访问。当然可以配置上，只允许内网访问。根据 ps 的内容可以看出区别\nport 6379\ndaemonize yes\nlogfile "/usr/local/redis-6.2.1/logs/redis-6379.log"\ndir ./data # 也可以设置为绝对路径\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"服务端配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#服务端配置"}},[s._v("#")]),s._v(" 服务端配置")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("bind—IP")]),s._v(" "),e("p",[s._v("这里是值允许访问的 IP，类似白名单！绑定后只允许该 IP 访问了")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("bind 127.0.0.1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("port—端口")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("port 6379\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("daemonize—守护进程")]),s._v(" "),e("p",[s._v("默认为 no，会在启动后会在控制台打印日志。改为 yes 后，需要配置日志文件名称")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("daemonize no\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("logfile—日志文件名称")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('logfile ""\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("dir—数据库文件存放目录")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("dir ./\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("databases—数据库数量")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("databases 16\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"日志配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#日志配置"}},[s._v("#")]),s._v(" 日志配置")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("设置服务器以指定日志记录级别")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("loglevel debug|verbose|notice|warning\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("日志记录文件名")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("logfile 端口号.log\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("p",[s._v("注意：日志级别"),e("strong",[s._v("开发期设置为 verbose 即可")]),s._v("，"),e("strong",[s._v("生产环境中配置为 notice")]),s._v("，简化日志输出量，降低写日志 IO 的频度")]),s._v(" "),e("h3",{attrs:{id:"客户端配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#客户端配置"}},[s._v("#")]),s._v(" 客户端配置")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("设置同一时间最大客户端连接数，默认 0 即无限制。当客户端连接到达上限，Redis 会关闭新的连接")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("maxclients 0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("客户端闲置等待最大时长，秒，达到最大值后关闭连接。如需关闭该功能，设置为 0")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("timeout 300\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"多服务器快捷配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#多服务器快捷配置"}},[s._v("#")]),s._v(" 多服务器快捷配置")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("导入并加载指定配置文件信息，用于快速创建 redis"),e("strong",[s._v("公共配置")]),s._v("较多的 redis 实例配置文件，便于维护")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("include /path/server-端口号.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"其他配置见具体章节"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其他配置见具体章节"}},[s._v("#")]),s._v(" 其他配置见具体章节")]),s._v(" "),e("h2",{attrs:{id:"运行-🔥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#运行-🔥"}},[s._v("#")]),s._v(" 运行 🔥")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("src/redis-server "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("conf/redis.conf"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("code",[s._v("--port 9999")]),s._v("指定端口，必须写 src/redis-*，否则无法执行命令。但是推荐在 conf 文件中写好配置！")]),s._v(" "),e("p",[s._v("运行 cli")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("src/redis-cli -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"配置自启动-🔥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置自启动-🔥"}},[s._v("#")]),s._v(" 配置自启动 🔥")]),s._v(" "),e("p",[s._v("参考"),e("code",[s._v("/usr/local/redis/redis-6.2.1/utils/redis_init_script")]),s._v("脚本")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Simple Redis init.d script conceived to work on Linux systems")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# as it does use of the /proc filesystem.")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### BEGIN INIT INFO")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Provides:     redis_6379")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Default-Start:        2 3 4 5")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Default-Stop:         0 1 6")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Short-Description:    Redis data structure server")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Description:          Redis data structure server. See https://redis.io")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### END INIT INFO")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDISPORT")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("EXEC")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/redis/redis-6.2.1/src/redis-server\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLIEXEC")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/redis/redis-6.2.1/src/redis-cli\n\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PIDFILE")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/run/redis_"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${REDISPORT}")]),s._v(".pid\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CONF")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/redis/redis-6.2.1/conf/'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${REDISPORT}")]),s._v('.conf"')]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n    start"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -f "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PIDFILE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PIDFILE")]),s._v(' exists, process is already running or crashed"')]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Starting Redis server..."')]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$EXEC")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CONF")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    stop"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" -f "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PIDFILE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PIDFILE")]),s._v(' does not exist, process is not running"')]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n\n                "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PID")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" $PIDFILE"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Stopping ..."')]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CLIEXEC")]),s._v(" -p "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$REDISPORT")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -x /proc/"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PID}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n                    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Waiting for Redis to shutdown ..."')]),s._v("\n                    "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n                "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Redis stopped"')]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    *"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Please use start or stop as first argument"')]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("esac")]),s._v("\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br")])]),e("p",[s._v("根据上述提示创建 pid 文件"),e("code",[s._v("/var/run/redis_6379.pid")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("6379\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("复制"),e("code",[s._v("/usr/local/redis/redis-6.2.1/utils/redis_init_script")]),s._v("脚本到"),e("code",[s._v("/etc/init.d")]),s._v("中")])])}),[],!1,null,null,null);a.default=n.exports}}]);