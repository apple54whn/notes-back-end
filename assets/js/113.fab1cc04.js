(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{740:function(s,a,t){"use strict";t.r(a);var e=t(11),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"oracle-运维"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#oracle-运维"}},[s._v("#")]),s._v(" Oracle 运维")]),s._v(" "),t("h2",{attrs:{id:"通过-docker-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通过-docker-安装"}},[s._v("#")]),s._v(" 通过 Docker 安装")]),s._v(" "),t("h3",{attrs:{id:"构建-docker-image"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建-docker-image"}},[s._v("#")]),s._v(" 构建 Docker image")]),s._v(" "),t("p",[s._v("此处仅记录 Oracle12c 的 Docker image 构建及使用过程，其他版本如 19c 也类似（run 了半天没启动起来算逑了）。")]),s._v(" "),t("p",[s._v("构建：")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("Clone Oracle 准备的镜像构建"),t("a",{attrs:{href:"https://github.com/oracle/docker-images",target:"_blank",rel:"noopener noreferrer"}},[s._v("仓库"),t("OutboundLink")],1),s._v("（有该公司许多产品）")])]),s._v(" "),t("li",[t("p",[s._v("在 "),t("a",{attrs:{href:"https://www.oracle.com/database/technologies/oracle-database-software-downloads.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Oracle 官网"),t("OutboundLink")],1),s._v("下载需要构建镜像的 "),t("strong",[s._v("Linux")]),s._v(" 原版，此处为 Oracle Database 12c Release 2")])]),s._v(" "),t("li",[t("p",[s._v("进入 1 的 "),t("code",[s._v("docker-images/OracleDatabase/SingleInstance/dockerfiles/12.2.0.1")]),s._v("，将 2 下载的文件放入该目录，其他版本类似。")])]),s._v(" "),t("li",[t("p",[s._v("退出到上一级目录，找到有"),t("code",[s._v("buildDockerImage.sh")]),s._v("命令的目录，执行")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./buildDockerImage.sh -v "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),s._v(".0.1 -e\n\n-----------------含义如下-------------------\n-v: version to build, Choose one of: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11.2")]),s._v(".0.2 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.1")]),s._v(".0.2 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),s._v(".0.1 .etc\n-e: creates image based on ‘Enterprise Edition’\n-s: creates image based on ‘Standard Edition "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("’\n-x: creates image based on ‘Express Edition’\n-i: ignores the MD5 checksums\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("注意在安装过程中需要联网（可能需要科学上网），因为他会下载oraclelinux:7-slim 和 yum install pre-install 的包")])]),s._v(" "),t("li",[t("p",[s._v("等待 10 多分钟应该就好了，此时就可以查看 image，会有oracle linux 和 oracle database")])])]),s._v(" "),t("h3",{attrs:{id:"将镜像上传至阿里云"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#将镜像上传至阿里云"}},[s._v("#")]),s._v(" 将镜像上传至阿里云")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("重命名镜像")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker tag imageId registry.cn-hangzhou.aliyuncs.com/con/oracle12c_r2:12.2.0.1-ee\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("上传（慢得要死）")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker push registry.cn-hangzhou.aliyuncs.com/con/oracle12c_r2:12.2.0.1-ee\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])]),s._v(" "),t("h3",{attrs:{id:"创建容器并运行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建容器并运行"}},[s._v("#")]),s._v(" 创建容器并运行")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("我选择创建"),t("code",[s._v("/usr/local/docker/oracle12c/")]),s._v("并进入，执行")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker run -d --name oracle12c "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --privileged -v /usr/local/docker/oracle12c/oradata:/opt/oracle/oradata "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1521")]),s._v(":1521 oracle/database:12.2.0.1-ee\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("数据库设置和数据将持久化到"),t("code",[s._v("/oradata")]),s._v("文件夹，端口将公开给 localhost 或 boot2docker 容器（Mac 和 Win）")])]),s._v(" "),t("li",[t("p",[s._v("此时的日志会显示一个随机密码，可以重新设置（此时容器必须运行正常，用"),t("code",[s._v("ps")]),s._v("查看）。此处设置为 oracle")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" b0 ./setPassword.sh oracle\nThe Oracle base remains unchanged with value /opt/oracle\n\nSQL*Plus: Release "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),s._v(".0.1.0 Production on Sat Feb "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":13:09 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("\n\nCopyright "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1982")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v(", Oracle.  All rights reserved.\n\n\nConnected to:\nOracle Database 12c Enterprise Edition Release "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),s._v(".0.1.0 - 64bit Production\n\nSQL"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nUser altered.\n\nSQL"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nUser altered.\n\nSQL"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nSession altered.\n\nSQL"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nUser altered.\n\nSQL"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Disconnected from Oracle Database 12c Enterprise Edition Release "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),s._v(".0.1.0 - 64bit Production\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("默认的 SID 为 "),t("code",[s._v("orclcdb")]),s._v("，Server Name 为"),t("code",[s._v("orclpdb1")]),s._v("，使用 "),t("code",[s._v("system")]),s._v("（dba）或"),t("code",[s._v("sys")]),s._v("（sysdba）连接即可")])])]),s._v(" "),t("h3",{attrs:{id:"运行时权限问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行时权限问题"}},[s._v("#")]),s._v(" 运行时权限问题")]),s._v(" "),t("p",[s._v("当使用"),t("code",[s._v("-v")]),s._v("数据卷时，有可能容器里用户对映射的路径没有写权限，会导致运行时报错，启动不了")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("ORACLE PASSWORD FOR SYS, SYSTEM AND PDBADMIN: eTsinj4LADk=1\n\nLSNRCTL for Linux: Version 12.2.0.1.0 - Production on 27-FEB-2020 18:27:12\n\nCopyright (c) 1991, 2016, Oracle.  All rights reserved.\n\nStarting /opt/oracle/product/12.2.0.1/dbhome_1/bin/tnslsnr: please wait...\n\nTNSLSNR for Linux: Version 12.2.0.1.0 - Production\nSystem parameter file is /opt/oracle/product/12.2.0.1/dbhome_1/network/admin/listener.ora\nLog messages written to /opt/oracle/diag/tnslsnr/1d786d0a6d23/listener/alert/log.xml\nListening on: (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC1)))\nListening on: (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=0.0.0.0)(PORT=1521)))\n\nConnecting to (DESCRIPTION=(ADDRESS=(PROTOCOL=IPC)(KEY=EXTPROC1)))\nSTATUS of the LISTENER\n\\------------------------\nAlias                     LISTENER\nVersion                   TNSLSNR for Linux: Version 12.2.0.1.0 - Production\nStart Date                27-FEB-2020 18:27:13\nUptime                    0 days 0 hr. 0 min. 1 sec\nTrace Level               off\nSecurity                  ON: Local OS Authentication\nSNMP                      OFF\nListener Parameter File   /opt/oracle/product/12.2.0.1/dbhome_1/network/admin/listener.ora\nListener Log File         /opt/oracle/diag/tnslsnr/1d786d0a6d23/listener/alert/log.xml\nListening Endpoints Summary...\n  (DESCRIPTION=(ADDRESS=(PROTOCOL=ipc)(KEY=EXTPROC1)))\n  (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=0.0.0.0)(PORT=1521)))\nThe listener supports no services\nThe command completed successfully\n[WARNING] [DBT-10102] The listener configuration is not selected for the database. EM DB Express URL will not be accessible.\n   CAUSE: The database should be registered with a listener in order to access the EM DB Express URL.\n   ACTION: Select a listener to be registered or created with the database.\nLook at the log file \"/opt/oracle/cfgtoollogs/dbca/ORCLCDB.log\" for further details.\ncat: /opt/oracle/cfgtoollogs/dbca/ORCLCDB/ORCLCDB.log: No such file or directory\n[ 2020-02-27 18:27:23.443 UTC ] Cannot create directory \"/opt/oracle/oradata/ORCLCDB\".\n\nSQL*Plus: Release 12.2.0.1.0 Production on Thu Feb 27 18:27:23 2020\n\nCopyright (c) 1982, 2016, Oracle.  All rights reserved.\n\nConnected to an idle instance.\n\nSQL>    ALTER SYSTEM SET control_files='/opt/oracle/oradata/ORCLCDB/control01.ctl' scope=spfile\n*\nERROR at line 1:\nORA-01034: ORACLE not available\nProcess ID: 0\nSession ID: 0 Serial number: 0\n\n\nSQL>    ALTER PLUGGABLE DATABASE ORCLPDB1 SAVE STATE\n*\nERROR at line 1:\nORA-01034: ORACLE not available\nProcess ID: 0\nSession ID: 0 Serial number: 0\n\n\nSQL> BEGIN DBMS_XDB_CONFIG.SETGLOBALPORTENABLED (TRUE); END;\n\n*\nERROR at line 1:\nORA-01034: ORACLE not available\nProcess ID: 0\nSession ID: 0 Serial number: 0\n\n\nSQL> Disconnected\nmkdir: cannot create directory '/opt/oracle/oradata/dbconfig': Permission denied\nmv: cannot stat '/opt/oracle/product/12.2.0.1/dbhome_1/dbs/spfileORCLCDB.ora': No such file or directory\nmv: cannot stat '/opt/oracle/product/12.2.0.1/dbhome_1/dbs/orapwORCLCDB': No such file or directory\nmv: cannot move '/opt/oracle/product/12.2.0.1/dbhome_1/network/admin/sqlnet.ora' to '/opt/oracle/oradata/dbconfig/ORCLCDB/': No such file or directory\nmv: cannot move '/opt/oracle/product/12.2.0.1/dbhome_1/network/admin/listener.ora' to '/opt/oracle/oradata/dbconfig/ORCLCDB/': No such file or directory\nmv: cannot move '/opt/oracle/product/12.2.0.1/dbhome_1/network/admin/tnsnames.ora' to '/opt/oracle/oradata/dbconfig/ORCLCDB/': No such file or directory\ncp: cannot create regular file '/opt/oracle/oradata/dbconfig/ORCLCDB/': No such file or directory\nln: failed to create symbolic link '/opt/oracle/product/12.2.0.1/dbhome_1/network/admin/sqlnet.ora': File exists\nln: failed to create symbolic link '/opt/oracle/product/12.2.0.1/dbhome_1/network/admin/listener.ora': File exists\nln: failed to create symbolic link '/opt/oracle/product/12.2.0.1/dbhome_1/network/admin/tnsnames.ora': File exists\ncp: cannot stat '/opt/oracle/oradata/dbconfig/ORCLCDB/oratab': No such file or directory\nORACLE_HOME = [/home/oracle] ? ORACLE_BASE environment variable is not being set since this\ninformation is not available for the current user ID .\nYou can set ORACLE_BASE manually if it is required.\nResetting ORACLE_BASE to its previous value or ORACLE_HOME\nThe Oracle base remains unchanged with value /opt/oracle\n/opt/oracle/checkDBStatus.sh: line 26: sqlplus: command not found\n\\#####################################\n\\########### E R R O R ###############\nDATABASE SETUP WAS NOT SUCCESSFUL!\nPlease check output for further info!\n\\########### E R R O R ###############\n\\#####################################\nThe following output is now a tail of the alert.log:\ntail: cannot open '/opt/oracle/diag/rdbms/*/*/trace/alert*.log' for reading: No such file or directory\ntail: no files remaining\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br")])]),t("p",[s._v("根据这条 "),t("a",{attrs:{href:"https://github.com/oracle/docker-images/issues/227",target:"_blank",rel:"noopener noreferrer"}},[s._v("issue"),t("OutboundLink")],1),s._v("，无论您将卷安装在哪个位置，请确保Docker容器内的用户在该位置具有写访问权限。请记住，在Linux中唯一重要的是 UID。因此，仅仅因为您在容器内有一个用户 oracle 并不意味着它是容器外的同一用户oracle。您必须确保 UID 匹配或提供正确的权限。这个博客的"),t("a",{attrs:{href:"https://sqlmaria.com/2017/04/27/oracle-database-12c-now-available-on-docker/#comment-855",target:"_blank",rel:"noopener noreferrer"}},[s._v("评论区"),t("OutboundLink")],1),s._v("也有介绍到。")]),s._v(" "),t("p",[s._v("例如，如果您拥有一个"),t("code",[s._v("/home/data")]),s._v("，请确保它是由 UID 54321 的用户即 oracle 拥有的，或者请确保您向其他用户授予了写权限。也可以添加上组名 dba，GID 为 54322。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("54321")]),s._v(":54322 /usr/local/docker/oracle12c\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"设置-sid-环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置-sid-环境变量"}},[s._v("#")]),s._v(" 设置 SID 环境变量")]),s._v(" "),t("p",[s._v("如果是docker，在"),t("strong",[s._v("进入容器")]),s._v("后需确定是否当前为 oracle 用户")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" oracle\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("直接登陆，可能报错。好像每次重启都要设置？")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("ERROR:\nORA-12162: TNS:net service name is incorrectly specified\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("原因是系统没有设置 SID")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ORACLE_SID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ORCLCDB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("登陆")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("sqlplus /nolog\nSQL>conn / as sysdba;\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"修改编码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改编码"}},[s._v("#")]),s._v(" 修改编码")]),s._v(" "),t("p",[s._v("可能存在"),t("code",[s._v("AL32UTF8")]),s._v("编码的服务器导入中文时字段长度不够问题，需转换为"),t("code",[s._v("ZHS16GBK")])]),s._v(" "),t("p",[s._v("查看编码等信息")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" nls_database_parameters\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("table",[t("thead",[t("tr",[t("th",[s._v("PARAMETER")]),s._v(" "),t("th",[s._v("VALUE")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("NLS_RDBMS_VERSION")]),s._v(" "),t("td",[s._v("12.2.0.1.0")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_NCHAR_CONV_EXCP")]),s._v(" "),t("td",[s._v("FALSE")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_LENGTH_SEMANTICS")]),s._v(" "),t("td",[s._v("BYTE")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_COMP")]),s._v(" "),t("td",[s._v("BINARY")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_DUAL_CURRENCY")]),s._v(" "),t("td",[s._v("$")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_TIMESTAMP_TZ_FORMAT")]),s._v(" "),t("td",[s._v("DD-MON-RR HH.MI.SSXFF AM TZR")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_TIME_TZ_FORMAT")]),s._v(" "),t("td",[s._v("HH.MI.SSXFF AM TZR")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_TIMESTAMP_FORMAT")]),s._v(" "),t("td",[s._v("DD-MON-RR HH.MI.SSXFF AM")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_TIME_FORMAT")]),s._v(" "),t("td",[s._v("HH.MI.SSXFF AM")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_SORT")]),s._v(" "),t("td",[s._v("BINARY")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_DATE_LANGUAGE")]),s._v(" "),t("td",[s._v("AMERICAN")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_DATE_FORMAT")]),s._v(" "),t("td",[s._v("DD-MON-RR")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_CALENDAR")]),s._v(" "),t("td",[s._v("GREGORIAN")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_NUMERIC_CHARACTERS")]),s._v(" "),t("td",[s._v(".,")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_NCHAR_CHARACTERSET")]),s._v(" "),t("td",[s._v("AL16UTF16")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_CHARACTERSET")]),s._v(" "),t("td",[s._v("AL32UTF8")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_ISO_CURRENCY")]),s._v(" "),t("td",[s._v("AMERICA")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_CURRENCY")]),s._v(" "),t("td",[s._v("$")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_TERRITORY")]),s._v(" "),t("td",[s._v("AMERICA")])]),s._v(" "),t("tr",[t("td",[s._v("NLS_LANGUAGE")]),s._v(" "),t("td",[s._v("AMERICAN")])])])]),s._v(" "),t("p",[s._v("修改编码")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("sqlplus "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nolog\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" conn "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" sysdba\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("shutdown")]),s._v(" immediate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" startup mount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENABLE")]),s._v(" RESTRICTED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SESSION")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" JOB_QUEUE_PROCESSES"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" SYSTEM "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" AQ_TM_PROCESSES"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("database")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARACTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" ZHS16GBK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    ORA"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12712")]),s._v(": new "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("character")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" must be a superset "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("of")]),s._v(" old "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("character")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--提示我们的字符集：新字符集必须为旧字符集的超集，这时我们可以跳过超集的检查做更改：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("character")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" INTERNAL_USE ZHS16GBK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--我们看到这个过程和之前ALTER DATABASE CHARACTER SET操作的内部过程是完全相同的，也就是说INTERNAL_USE提供的帮助就是使Oracle数据库绕过了子集与超集的校验.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" v$nls_parameters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("shutdown")]),s._v(" immediate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" startup\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" v$nls_parameters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h2",{attrs:{id:"备份恢复"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#备份恢复"}},[s._v("#")]),s._v(" 备份恢复")]),s._v(" "),t("h3",{attrs:{id:"sqlplus"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sqlplus"}},[s._v("#")]),s._v(" sqlplus")]),s._v(" "),t("p",[s._v("根据SID登录（直接登陆查看设置SID时笔记）")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sqlplus sys/oracle@orclcdb as sysdba"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("也可以根据 PDB 来登陆，需使用SID登录后查询"),t("code",[s._v("show pdbs")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("SQL> show pdbs;\n\n    CON_ID CON_NAME\t\t\t  OPEN MODE  RESTRICTED\n---------- ------------------------------ ---------- ----------\n\t 2 PDB$SEED\t\t\t  READ ONLY  NO\n\t 3 ORCLPDB1\t\t\t  READ WRITE NO\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sqlplus sys/oracle@orclpdb1 as sysdba"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("登陆后可以切换用户")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("conn sys"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oracle"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@orclcdb")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" sysdba"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("查看当前 session 的 CDB 或 PDB")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" con_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nCON_NAME\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--------------PDB----------------")]),s._v("\nORCLPDB1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" con_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nCON_NAME\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--------------CDB----------------")]),s._v("\nCDB$ROOT\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("设置并启动PDB数据库（上述连接PDB后好像不用执行该步）")]),s._v(" "),t("div",{staticClass:"language-SQL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("session")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" container"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ORCLPDB1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("使用JDBC连接 PDB 时需要设置如下的URL")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("jdbc:oracle:thin:@192.168.214.101:1521/orclpdb1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("连接 CDB 设置如下")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("jdbc:oracle:thin:192.168.214.101:1521:orclcdb\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"表空间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#表空间"}},[s._v("#")]),s._v(" 表空间")]),s._v(" "),t("p",[s._v("查看表空间")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" v$datafile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("查看临时表空间")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" v$tempfile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("在 CDB 容器下创建的用户属于公有用户，尽量在 PDB 下创建")]),s._v(" "),t("div",{staticClass:"language-SQL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLESPACE")]),s._v(" HTDMS3\nDATAFILE "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/opt/oracle/oradata/ORCLCDB/ORCLPDB1/htdms3.dbf'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 容器中推荐使用上面查询到的路径，如上")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("---若写为 DATAFILE './HTDMS3.DBF',则会存在/u01/app/oracle/product/12.1.0.2/dbhome_1/dbs/htdms3.dbf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- DATAFILE 'E:\\oralce_data\\HTDMS3.DBF' -- Windows下")]),s._v("\nSIZE "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("M\nAUTOEXTEND "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("NEXT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("M \nMAXSIZE UNLIMITED"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("删除表空间")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tablespace")]),s._v(" HTDMS3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 可能没把文件删除，可以采用下面命令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tablespace")]),s._v(" HTDMS3 INCLUDING CONTENTS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" DATAFILES"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户"}},[s._v("#")]),s._v(" 用户")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("删除原有用户（不删除表空间）")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" htdms3 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("cascade")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("若提示"),t("code",[s._v("ORA-01940: 无法删除当前连接的用户")]),s._v("，则需要查看用户的连接状况")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("serial")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# from v$session where username='htdms3';")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-----或-----")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" saddr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("sid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("serial")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#,paddr,username,status from v$session where username ='ODI_SRC';")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("根据用户的"),t("code",[s._v("sid")]),s._v("和"),t("code",[s._v("serial")]),s._v("删除")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" system "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("kill")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("session")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'7,85'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("创建用户（12c在CDB容器下创建用户需要在前添加C##；PDB容器下不需要）")]),s._v(" "),t("div",{staticClass:"language-SQL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" htdms3\nIDENTIFIED "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("111111")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLESPACE")]),s._v(" htdms3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("授权")]),s._v(" "),t("div",{staticClass:"language-SQL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("all")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" HTDMS3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" dba "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" HTDMS3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("---------------------------")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" sysdba "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" HTDMS3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])])]),s._v(" "),t("h3",{attrs:{id:"备份恢复-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#备份恢复-2"}},[s._v("#")]),s._v(" 备份恢复")]),s._v(" "),t("p",[s._v("根据需要将SID换为PDB")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("恢复数据（指定表）")]),s._v(" "),t("div",{staticClass:"language-SQL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("imp HTDMS3"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("111111")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@192.168.1.108")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oradb "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("file")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("D:"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DataBase")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bjtrq3"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_backup"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("htdms3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dmp "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ignore")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("y "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FULL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Y\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("备份数据（指定表）")]),s._v(" "),t("p",[s._v("owner是当前用户时可以不指定，否则报错")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("exp htdms3"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("111111")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@192.168.1.108")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oradb "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("file")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("D:"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DataBase")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bjtrq3"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_backup"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("HTDMS_1225"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dmp log"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("D:"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DataBase")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bjtrq3"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_backup"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("HTDMS_1225"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tables")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DMS_GRP_DOC_TYPE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" owner"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("htdms3 \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 不指定owner如下：")]),s._v("\n  Connected "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(": Oracle "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Database")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("c Enterprise Edition "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Release")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.2")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("bit Production\n  Export done "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("in")]),s._v(" ZHS16GBK "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("character")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" AL16UTF16 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("NCHAR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("character")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v("\n\n  About "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" export specified users "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting pre"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("schema")]),s._v(" procedural objects "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" actions\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("foreign")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" library names "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" DMSZYGD \n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PUBLIC")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" synonyms\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting private "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" synonyms\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting object "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" definitions "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" DMSZYGD \n  About "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" export DMSZYGD"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s objects ...\n  . exporting database links\n  . exporting sequence numbers\n  . exporting cluster definitions\n  . about to export DMSZYGD'")]),s._v("s "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tables")]),s._v(" via Conventional Path "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v("                    APP_DMS_DOC         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("86")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(" exported\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting synonyms\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting views\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting stored procedures\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting operators\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting referential integrity constraints\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting triggers\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting indextypes\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting bitmap"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" functional "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" extensible indexes\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting posttables actions\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting materialized views\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("snapshot")]),s._v(" logs\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting job queues\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting refresh groups "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" children\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting dimensions\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting post"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("schema")]),s._v(" procedural objects "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" actions\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" exporting "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("statistics")]),s._v("\n  Export "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("terminated")]),s._v(" successfully without "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("warnings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br")])])])]),s._v(" "),t("h2",{attrs:{id:"数据泵"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据泵"}},[s._v("#")]),s._v(" 数据泵")]),s._v(" "),t("p",[s._v("在Oracle10g中exp imp 被重新设计为Oracle Data Pump（保留了原有的 exp imp工具），数据泵与传统导出导入的区别：")]),s._v(" "),t("ul",[t("li",[s._v("exp 和 imp 是客户端工具，他们既可以在客户端使用，也可以在服务端使用。")]),s._v(" "),t("li",[s._v("expdp 和impdp 是服务端工具，只能在 Oracle 服务端使用。（不一定，参考下面代码）")]),s._v(" "),t("li",[s._v("imp 只适用于 exp 导出文件，impdp 只适用于 expdp 导出文件。")])]),s._v(" "),t("p",[s._v("如下笔记参考了 https://www.cnblogs.com/chinas/p/8300955.html")]),s._v(" "),t("h3",{attrs:{id:"expdp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#expdp"}},[s._v("#")]),s._v(" expdp")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("为输出路径建立一个数据库的directory对象（"),t("code",[s._v("dp_data")]),s._v("需自行填写）")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 需在服务器创建该目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("or")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("replace")]),s._v(" directory dp_data "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" 'D:\\app\\Administrator\\dp_data\\'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("查看是否创建成功")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" dba_directories"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("给将要进行数据导出的用户授权访问")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("read")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("write")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" directory dp_data "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" htdms"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("导出")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("expdp htdms/bjtrqTXGL2018sc@10.168.52.133/orcl "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("schemas")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("htdms "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("directory")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dp_data "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dumpfile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("htdms3_dp_1128.dmp "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("logfile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("htdms3_dp_1128.log\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[s._v("full=y")]),s._v("： 全量导出数据库")]),s._v(" "),t("li",[t("code",[s._v("tablespace")]),s._v("： 按表空间导出")]),s._v(" "),t("li",[t("code",[s._v("schemas")]),s._v("： 按用户导出")]),s._v(" "),t("li",[t("code",[s._v("tables=t1,t2")]),s._v("： 按表导出")]),s._v(" "),t("li",[t("code",[s._v("tables=table1='where number=1234'")]),s._v("： 按查询条件导")])])])]),s._v(" "),t("h3",{attrs:{id:"impdp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#impdp"}},[s._v("#")]),s._v(" impdp")]),s._v(" "),t("p",[s._v("确保数据库directory目录已提前建好（参考expdp）， 提前将源库导出的数据文件传递到目标库的备份目录下 ， 给将要进行数据导入的用户授权访问")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("read")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("write")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" directory dp_data "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" htdms3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("导入")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("impdp htdms3/bjtrqTXGL2018sc@10.168.52.133/orcl "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("schemas")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("htdms "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REMAP_SCHEMA")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("htdms:htdms3 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REMAP_TABLESPACE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("htdms:htdms3 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("directory")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dp_data "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dumpfile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("htdms3_dp_1128.dmp "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("logfile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("htdms3_dp_1128.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[t("p",[t("code",[s._v("full=y")]),s._v("： 全量导入数据库")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("tablespace")]),s._v("： 按表空间导入，可指定"),t("code",[s._v("REMAP_TABLESPACE")])]),s._v(" "),t("p",[s._v("将表空间TBS01、TBS02、TBS03导入到表空间A_TBS，将用户B的数据导入到A，并生成新的oid防止冲突；")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("impdp A/passwd "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("directory")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("data_dir "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dumpfile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("expdp.dmp "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("logfile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("impdp.log  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("remap_tablespace")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("TBS01:A_TBS,TBS02:A_TBS,TBS03:A_TBS "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("remap_schema")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("B:A "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("FULL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Y "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("transform")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("oid:n \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[t("code",[s._v("schemas")]),s._v("： 按用户导入")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("若导入的用户名同名，可以不用指定"),t("code",[s._v("REMAP_SCHEMA")])])]),s._v(" "),t("li",[t("p",[s._v("否则需要指定映射关系"),t("code",[s._v("REMAP_SCHEMA=htdms:htdms3")])])])])]),s._v(" "),t("li",[t("p",[t("code",[s._v("tables=t1,t2")]),s._v("： 按表导入")]),s._v(" "),t("p",[s._v("从A用户中把表table1和table2导入到B用户中")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("impdp B/passwd "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tables")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("A.table1,A.table2 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("remap_schema")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("A:B "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("directory")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dp_data "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dumpfile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("expdp.dmp "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("logfile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("impdp.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("追加数据")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("impdp sys/passwd "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("directory")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("data_dir "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dumpfile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("expdp.dmp "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("schemas")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("system "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("logfile")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("impdp.log "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("table_exists_action")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("replace\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("table_exists_action")]),s._v("导入对象已存在时执行的操作。可传指：END,REPLACE和TRUNCATE")])])]),s._v(" "),t("p",[s._v("测试")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("impdp htdms3"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("111111")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@127.0.0.1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("xe SCHEMAS"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("htdms3 DIRECTORY"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bak "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DUMPFILE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("full")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dmp LOGFILE"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("full")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log remap_tablespace"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'htdms'")]),s._v(":"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'htdms3'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"恢复某一时间数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#恢复某一时间数据"}},[s._v("#")]),s._v(" 恢复某一时间数据")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("查询执行的SQL语句。可以看到SQL_TEXT、LAST_LOAD_TIME")]),s._v(" "),t("div",{staticClass:"language-SQL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" sql_text"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("last_load_time "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" v$"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sql")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" sql_text "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%update%'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" last_load_time "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("desc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("将数据回滚到需要的时间点")]),s._v(" "),t("div",{staticClass:"language-SQL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" $tablename$ "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("enable")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("row")]),s._v(" movement"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflashback "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" $tablename$ "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("timestamp")]),s._v(" to_timestamp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxx-xx-xx xx:xx:xx'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'yyyy-mm-dd hh24:mi:ss'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])]),s._v(" "),t("h2",{attrs:{id:"修改列类型（已有数据）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改列类型（已有数据）"}},[s._v("#")]),s._v(" 修改列类型（已有数据）")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" DMS_DOC_REVISION_RECORD "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add")]),s._v(" ARC_IDS_TEMP number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" DMS_DOC_REVISION_RECORD "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" ARC_IDS_TEMP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ARC_ID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("ARC_ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" DMS_DOC_REVISION_RECORD "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("modify")]),s._v(" ARC_ID VARCHAR2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" DMS_DOC_REVISION_RECORD "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" ARC_ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("to_char"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ARC_IDS_TEMP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("ARC_IDS_TEMP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" DMS_DOC_REVISION_RECORD "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" ARC_IDS_TEMP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);