(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{599:function(s,e,t){s.exports=t.p+"assets/img/image-20210326235723206.6dfa94f5.png"},600:function(s,e,t){s.exports=t.p+"assets/img/image-20210327001035164.d9628b37.png"},601:function(s,e,t){s.exports=t.p+"assets/img/image-20210327001414792.91332627.png"},602:function(s,e,t){s.exports=t.p+"assets/img/image-20210327001656092.5f91c00e.png"},603:function(s,e,t){s.exports=t.p+"assets/img/image-20210327002039853.cd681014.png"},759:function(s,e,t){"use strict";t.r(e);var a=t(11),v=Object(a.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"å“¨å…µ-sentinel-æ•…éšœè‡ªåŠ¨åˆ‡æ¢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å“¨å…µ-sentinel-æ•…éšœè‡ªåŠ¨åˆ‡æ¢"}},[s._v("#")]),s._v(" å“¨å…µ Sentinelâ€”æ•…éšœè‡ªåŠ¨åˆ‡æ¢")]),s._v(" "),a("h2",{attrs:{id:"master-å®•æœº"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#master-å®•æœº"}},[s._v("#")]),s._v(" master å®•æœº")]),s._v(" "),a("h3",{attrs:{id:"è¡¥æ•‘æªæ–½"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è¡¥æ•‘æªæ–½"}},[s._v("#")]),s._v(" è¡¥æ•‘æªæ–½")]),s._v(" "),a("p",[s._v("master å®•æœºåï¼Œæˆ‘ä»¬éœ€è¦åšå¦‚ä¸‹æ“ä½œï¼š")]),s._v(" "),a("ul",[a("li",[s._v("å°†å®•æœºçš„ master ä¸‹çº¿")]),s._v(" "),a("li",[s._v("æ‰¾ä¸€ä¸ª slave ä½œä¸º master")]),s._v(" "),a("li",[s._v("é€šçŸ¥æ‰€æœ‰çš„ slave è¿æ¥æ–°çš„ master")]),s._v(" "),a("li",[s._v("å¯åŠ¨æ–°çš„ master å’Œ slave")]),s._v(" "),a("li",[s._v("æœ‰å¯èƒ½ä¼šå…¨é‡å¤åˆ¶ x N + éƒ¨åˆ†å¤åˆ¶ x N")])]),s._v(" "),a("p",[s._v("é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("è°æ¥ç¡®è®¤ master å®•æœºäº†ï¼Œæ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿ")]),s._v(" "),a("li",[s._v("å¦‚ä½•ä»ä¼—å¤š slave ä¸­æ‰¾ä¸€ä¸ª masterï¼Œè§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ")]),s._v(" "),a("li",[s._v("ä¿®æ”¹é…ç½®åï¼ŒåŸæœ‰çš„ master æ¢å¤äº†æ€ä¹ˆç‰ˆï¼Ÿ")])]),s._v(" "),a("h3",{attrs:{id:"å“¨å…µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å“¨å…µ"}},[s._v("#")]),s._v(" å“¨å…µ")]),s._v(" "),a("p",[s._v("å“¨å…µï¼ˆSentinelï¼‰ æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç”¨äºå¯¹"),a("strong",[s._v("ä¸»ä»ç»“æ„ä¸­çš„æ¯å°æœåŠ¡å™¨")]),s._v("è¿›è¡Œ"),a("strong",[s._v("ç›‘æ§")]),s._v("ï¼Œå½“å‡ºç°æ•…éšœæ—¶é€šè¿‡"),a("strong",[s._v("æŠ•ç¥¨æœºåˆ¶")]),s._v("é€‰æ‹©æ–°çš„ master å¹¶å°†æ‰€æœ‰ slave è¿æ¥åˆ°æ–°çš„ masterã€‚")]),s._v(" "),a("p",[s._v("å…¶ä½œç”¨æœ‰ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("ç›‘æ§ï¼š")]),s._v(" "),a("p",[s._v("ä¸æ–­çš„æ£€æŸ¥masterå’Œslaveæ˜¯å¦æ­£å¸¸è¿è¡Œã€‚ masterå­˜æ´»æ£€æµ‹ã€masterä¸slaveè¿è¡Œæƒ…å†µæ£€æµ‹ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("é€šçŸ¥ï¼ˆæé†’ï¼‰")]),s._v(" "),a("p",[s._v("å½“è¢«ç›‘æ§çš„æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼Œå‘å…¶ä»–ï¼ˆå“¨å…µé—´ï¼Œå®¢æˆ·ç«¯ï¼‰å‘é€é€šçŸ¥ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("è‡ªåŠ¨æ•…éšœè½¬ç§»")]),s._v(" "),a("p",[s._v("æ–­å¼€masterä¸slaveè¿æ¥ï¼Œé€‰å–ä¸€ä¸ªslaveä½œä¸ºmasterï¼Œå°†å…¶ä»–slaveè¿æ¥åˆ°æ–°çš„masterï¼Œå¹¶å‘ŠçŸ¥å®¢æˆ·ç«¯æ–°çš„æœåŠ¡å™¨åœ°å€")])])]),s._v(" "),a("p",[s._v("æ³¨æ„ï¼š"),a("strong",[s._v("å“¨å…µä¹Ÿæ˜¯ä¸€å°redisæœåŠ¡å™¨")]),s._v("ï¼Œåªæ˜¯"),a("strong",[s._v("ä¸æä¾›æ•°æ®æœåŠ¡")]),s._v("ã€‚é€šå¸¸å“¨å…µé…ç½®æ•°é‡ä¸º"),a("strong",[s._v("å•æ•°ï¼ï¼ï¼")])]),s._v(" "),a("h2",{attrs:{id:"é…ç½®å“¨å…µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®å“¨å…µ"}},[s._v("#")]),s._v(" é…ç½®å“¨å…µ")]),s._v(" "),a("h3",{attrs:{id:"ç®€ä»‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç®€ä»‹"}},[s._v("#")]),s._v(" ç®€ä»‹")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("é…ç½®ä¸€æ‹–äºŒçš„ä¸»ä»ç»“æ„")])]),s._v(" "),a("li",[a("p",[s._v("é…ç½®ä¸‰ä¸ªå“¨å…µï¼ˆé…ç½®ç›¸åŒï¼Œç«¯å£ä¸åŒï¼‰ã€‚å‚çœ‹ Redis ä¸­çš„ "),a("code",[s._v("sentinel.conf")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cat sentinel.conf | grep -v '#' | grep -v '^$'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('port 26379\ndaemonize no\npidfile /var/run/redis-sentinel.pid\nlogfile ""\ndir /tmp\n\nsentinel monitor mymaster 127.0.0.1 6379 2\nsentinel down-after-milliseconds mymaster 30000\nacllog-max-len 128\nsentinel parallel-syncs mymaster 1\nsentinel failover-timeout mymaster 180000\nsentinel deny-scripts-reconfig yes\nSENTINEL resolve-hostnames no\nSENTINEL announce-hostnames no\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("æç¤ºï¼šå¤åˆ¶å¹¶ä¿®æ”¹æ–‡ä»¶ä¸­"),a("strong",[s._v("ç«¯å£")]),s._v("æ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨ "),a("code",[s._v("sed")]),s._v(" å‘½ä»¤ï¼ï¼ï¼")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sed 's/26379/26380/g' sentinel-26379.conf > sentinel-26380.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("å¯åŠ¨å“¨å…µ")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("redis-sentinel sentinel-ç«¯å£å·.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"é…ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®"}},[s._v("#")]),s._v(" é…ç½®")]),s._v(" "),a("p",[s._v("ä¸Šé¢5ä¸ªå°±ä¸å¤šè¯´äº†ã€‚ä¹Ÿæ— éœ€æ”¹å˜ï¼ˆç‰¹åˆ«æ˜¯ daemonize æ— éœ€åå°è¿è¡Œï¼‰ã€‚ä¸€èˆ¬åªæ”¹ port ï¼ï¼ï¼")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("é…ç½®é¡¹")]),s._v(" "),a("th",[s._v("èŒƒä¾‹")]),s._v(" "),a("th",[s._v("è¯´æ˜")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("sentinel monitor <master-name> <ip> <redis-port> <quorum>")]),s._v(" "),a("td",[s._v("sentinel monitor mymaster 127.0.0.1 6379 2")]),s._v(" "),a("td",[s._v("è®¾ç½®å“¨å…µç›‘å¬çš„"),a("strong",[s._v("ä¸»æœåŠ¡å™¨ä¿¡æ¯")]),s._v("ï¼Œæœ€åçš„å‚æ•°å†³å®šäº†æœ€ç»ˆ"),a("strong",[s._v("å‚ä¸é€‰ä¸¾çš„æœåŠ¡å™¨æ•°é‡")]),s._v("ï¼ˆå³å¤šåŠï¼‰")])]),s._v(" "),a("tr",[a("td",[s._v("sentinel down-after-milliseconds <master-name> <milliseconds>")]),s._v(" "),a("td",[s._v("sentinel down-after-milliseconds mymaster 30000")]),s._v(" "),a("td",[s._v("æŒ‡å®šå“¨å…µåœ¨ç›‘æ§RedisæœåŠ¡æ—¶ï¼Œ"),a("strong",[s._v("åˆ¤å®šmasteræœåŠ¡å™¨æŒ‚æ‰çš„æ—¶é—´å‘¨æœŸ")]),s._v("ï¼Œé»˜è®¤30ç§’ (30000)ï¼Œä¹Ÿæ˜¯ä¸»ä»åˆ‡æ¢çš„å¯åŠ¨æ¡ä»¶ä¹‹ä¸€")])]),s._v(" "),a("tr",[a("td",[s._v("sentinel parallel-syncs <master-name> <numreplicas>")]),s._v(" "),a("td",[s._v("sentinel parallel-syncs mymaster 1")]),s._v(" "),a("td",[s._v("æŒ‡å®š"),a("strong",[s._v("åŒæ—¶è¿›è¡Œä¸»ä»çš„slaveæ•°é‡")]),s._v("ï¼Œæ•°å€¼è¶Šå¤§ï¼Œè¦æ±‚ç½‘ç»œèµ„æºè¶Šé«˜ï¼Œè¦æ±‚çº¦å°ï¼ŒåŒæ­¥æ—¶é—´çº¦é•¿")])]),s._v(" "),a("tr",[a("td",[s._v("sentinel failover-timeout <master-name> <milliseconds>")]),s._v(" "),a("td",[s._v("sentinel failover-timeout mymaster 180000")]),s._v(" "),a("td",[s._v("æŒ‡å®šå‡ºç°æ•…éšœåï¼Œ"),a("strong",[s._v("æ•…éšœåˆ‡æ¢çš„æœ€å¤§è¶…æ—¶æ—¶é—´")]),s._v("ï¼Œè¶…è¿‡è¯¥å€¼ï¼Œè®¤å®šåˆ‡æ¢å¤±è´¥ï¼Œ é»˜è®¤3åˆ†é’Ÿ")])]),s._v(" "),a("tr",[a("td",[s._v("sentinel notification-script <master-name> <script-path>")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("æœåŠ¡å™¨æ— æ³•æ­£å¸¸è”é€šæ—¶ï¼Œè®¾å®šçš„æ‰§è¡Œè„šæœ¬ï¼Œé€šå¸¸è°ƒè¯•ä½¿ç”¨")])])])]),s._v(" "),a("h2",{attrs:{id:"å“¨å…µå·¥ä½œåŸç†-ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å“¨å…µå·¥ä½œåŸç†-ğŸ”¥"}},[s._v("#")]),s._v(" å“¨å…µå·¥ä½œåŸç† ğŸ”¥")]),s._v(" "),a("h3",{attrs:{id:"ç›‘æ§é˜¶æ®µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç›‘æ§é˜¶æ®µ"}},[s._v("#")]),s._v(" ç›‘æ§é˜¶æ®µ")]),s._v(" "),a("img",{staticStyle:{zoom:"33%"},attrs:{src:t(599),alt:"image-20210326235723206"}}),s._v(" "),a("p",[s._v("ç”¨äºåŒæ­¥å„ä¸ªèŠ‚ç‚¹")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("è·å–å„ä¸ªsentinelçš„çŠ¶æ€(æ˜¯å¦åœ¨çº¿)")])]),s._v(" "),a("li",[a("p",[s._v("è·å–masterçš„çŠ¶æ€")]),s._v(" "),a("ul",[a("li",[s._v("masterå±æ€§ï¼šrunidã€role:master ç­‰")]),s._v(" "),a("li",[s._v("å„ä¸ªslaveçš„è¯¦ç»†ä¿¡æ¯")])])]),s._v(" "),a("li",[a("p",[s._v("è·å–æ‰€æœ‰slaveçš„çŠ¶æ€(æ ¹æ®masterä¸­çš„slaveä¿¡æ¯è·å–)")]),s._v(" "),a("ul",[a("li",[s._v("slaveå±æ€§ï¼šrunidã€role:slaveã€master_hostã€master_portã€offset")])])])]),s._v(" "),a("h3",{attrs:{id:"é€šçŸ¥é˜¶æ®µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é€šçŸ¥é˜¶æ®µ"}},[s._v("#")]),s._v(" é€šçŸ¥é˜¶æ®µ")]),s._v(" "),a("p",[a("img",{attrs:{src:t(600),alt:"image-20210327001035164"}})]),s._v(" "),a("h3",{attrs:{id:"æ•…éšœè½¬ç§»é˜¶æ®µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ•…éšœè½¬ç§»é˜¶æ®µ"}},[s._v("#")]),s._v(" æ•…éšœè½¬ç§»é˜¶æ®µ")]),s._v(" "),a("p",[s._v("ä¼— sentinel è§‚å¯Ÿå¹¶ç¡®è®¤ master æ˜¯å¦ä¸‹çº¿")]),s._v(" "),a("p",[a("img",{attrs:{src:t(601),alt:"image-20210327001414792"}})]),s._v(" "),a("p",[s._v("æ¨é€‰ä¸€ä¸ªä¸» sentinel")]),s._v(" "),a("p",[a("img",{attrs:{src:t(602),alt:"image-20210327001656092"}})]),s._v(" "),a("p",[s._v("ä¸» sentinel æ¥ä» slave ä¸­é€‰ master")]),s._v(" "),a("p",[a("img",{attrs:{src:t(603),alt:"image-20210327002039853"}})]),s._v(" "),a("p",[s._v("æœåŠ¡å™¨åˆ—è¡¨ä¸­æŒ‘é€‰å¤‡é€‰masterè§„åˆ™ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("å¿…é¡»æ˜¯åœ¨çº¿çš„")])]),s._v(" "),a("li",[a("p",[s._v("pass å“åº”æ…¢çš„")])]),s._v(" "),a("li",[a("p",[s._v("pass ä¸åŸmasteræ–­å¼€æ—¶é—´ä¹…çš„")])]),s._v(" "),a("li",[a("p",[s._v("ä¼˜å…ˆåŸåˆ™")]),s._v(" "),a("ul",[a("li",[s._v("ä¼˜å…ˆçº§")]),s._v(" "),a("li",[s._v("offsetï¼Œå°çš„å°±ä¼šè¢«è®¤ä¸ºæ•°æ®ä¸å¤Ÿ")]),s._v(" "),a("li",[s._v("runidï¼Œå°çš„ä¼˜å…ˆï¼ˆè€å‘˜å·¥ï¼‰")])])])]),s._v(" "),a("p",[s._v("å‘é€æŒ‡ä»¤(sentinel)ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("å‘æ–°çš„masterå‘é€slaveof no one")]),s._v(" "),a("li",[s._v("å‘å…¶ä»–slaveå‘é€slaveof æ–°masterIPç«¯å£")])]),s._v(" "),a("h3",{attrs:{id:"æ€»ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[s._v("#")]),s._v(" æ€»ç»“")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("ç›‘æ§")]),s._v(" "),a("ul",[a("li",[s._v("åŒæ­¥ä¿¡æ¯")])])]),s._v(" "),a("li",[a("p",[s._v("é€šçŸ¥")]),s._v(" "),a("ul",[a("li",[s._v("ä¿æŒè”é€š")])])]),s._v(" "),a("li",[a("p",[s._v("æ•…éšœè½¬ç§»")]),s._v(" "),a("ul",[a("li",[s._v("å‘ç°é—®é¢˜")]),s._v(" "),a("li",[s._v("ç«é€‰è´Ÿè´£äºº")]),s._v(" "),a("li",[s._v("ä¼˜é€‰æ–°master")]),s._v(" "),a("li",[s._v("æ–°masterä¸Šä»»ï¼Œå…¶ä»–slaveåˆ‡æ¢masterï¼ŒåŸmasterä½œä¸ºslaveæ•…éšœå›å¤åè¿æ¥")])])])])])}),[],!1,null,null,null);e.default=v.exports}}]);