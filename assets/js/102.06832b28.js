(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{723:function(s,t,a){"use strict";a.r(t);var n=a(11),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"çº¿ç¨‹å®‰å…¨ç†è®º"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹å®‰å…¨ç†è®º"}},[s._v("#")]),s._v(" çº¿ç¨‹å®‰å…¨ç†è®º")]),s._v(" "),a("h2",{attrs:{id:"å¦‚ä½•ç¼–å†™çº¿ç¨‹å®‰å…¨çš„ä»£ç -ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•ç¼–å†™çº¿ç¨‹å®‰å…¨çš„ä»£ç -ğŸ”¥"}},[s._v("#")]),s._v(" å¦‚ä½•ç¼–å†™çº¿ç¨‹å®‰å…¨çš„ä»£ç  ğŸ”¥")]),s._v(" "),a("p",[s._v("æ ¸å¿ƒåœ¨äºå¯¹"),a("strong",[s._v("å…±äº«")]),s._v("çš„ã€"),a("strong",[s._v("å¯å˜")]),s._v("çš„"),a("strong",[s._v("çŠ¶æ€ï¼ˆæˆå‘˜å˜é‡ï¼ŒåŒ…æ‹¬é™æ€çš„ï¼‰è®¿é—®æ“ä½œ")]),s._v("è¿›è¡Œ"),a("strong",[s._v("ç®¡ç†")])]),s._v(" "),a("ul",[a("li",[s._v("å…±äº«ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®")]),s._v(" "),a("li",[s._v("å¯å˜ï¼šå˜é‡çš„å€¼åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…å¯å˜")]),s._v(" "),a("li",[s._v("è®¿é—®æ“ä½œï¼šåªæœ‰åœ¨"),a("strong",[s._v("ä¸€æˆ–å¤šä¸ª")]),s._v("çº¿ç¨‹å‘è¿™äº›èµ„æºåšäº†"),a("strong",[s._v("å†™æ“ä½œ")]),s._v("æ—¶æ‰æœ‰å¯èƒ½å‘ç”Ÿ")]),s._v(" "),a("li",[s._v("ç®¡ç†ï¼šä½¿ç”¨åŒæ­¥æœºåˆ¶ååŒçº¿ç¨‹å¯¹å˜é‡çš„è®¿é—®ã€‚å¯ä½¿ç”¨å¦‚ï¼šsynchronizedã€volatileã€Lockã€åŸå­å˜é‡ç­‰")])]),s._v(" "),a("p",[s._v("æ³¨æ„ï¼š"),a("strong",[s._v("æ— çŠ¶æ€å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„")]),s._v("ï¼ˆæ²¡æœ‰ç®¡ç†çš„ä¸»ä½“äº†ï¼Œå½“ç„¶çº¿ç¨‹å®‰å…¨ï¼‰ã€‚å¦‚ï¼šå¤§å¤šæ•° Servlet ç­‰ã€‚")]),s._v(" "),a("h2",{attrs:{id:"åŸå­æ€§-ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŸå­æ€§-ğŸ”¥"}},[s._v("#")]),s._v(" åŸå­æ€§ ğŸ”¥")]),s._v(" "),a("h3",{attrs:{id:"ç«æ€æ¡ä»¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç«æ€æ¡ä»¶"}},[s._v("#")]),s._v(" ç«æ€æ¡ä»¶")]),s._v(" "),a("p",[s._v("å¤šä¸ªçº¿ç¨‹ä»¥"),a("strong",[s._v("éäº’æ–¥")]),s._v("çš„æ–¹å¼è¿›å…¥"),a("strong",[s._v("ä¸´ç•ŒåŒº")]),s._v("ï¼Œå½“æŸä¸ªè®¡ç®—çš„æ­£ç¡®æ€§å–å†³äºå¤šä¸ªçº¿ç¨‹çš„äº¤æ›¿æ‰§è¡Œ"),a("strong",[s._v("æ—¶åº")]),s._v("æ—¶ï¼Œå°±ä¼šå‘ç”Ÿç«æ€æ¡ä»¶")]),s._v(" "),a("p",[s._v("å¸¸è§çš„ç«æ€æ¡ä»¶ç±»å‹ï¼š")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("å…ˆæ£€æŸ¥åæ‰§è¡Œ")]),s._v("ï¼ˆCheck-Then-Actï¼‰ï¼Œå³åŸºäºä¸€ä¸ª"),a("strong",[s._v("å¯èƒ½å¤±æ•ˆçš„è§‚å¯Ÿç»“æœæ¥")]),s._v("ä½œå‡º"),a("strong",[s._v("åˆ¤æ–­æˆ–æ‰§è¡ŒæŸä¸ªè®¡ç®—")]),s._v("ã€‚\nå¦‚ï¼šå»¶è¿Ÿåˆå§‹åŒ–"),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@NotThreadSafe")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LazyInitRace")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExpensiveObject")]),s._v(" instance "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExpensiveObject")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            instance "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExpensiveObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])]),s._v(" "),a("li",[a("strong",[s._v("è¯»å–-ä¿®æ”¹-å†™å…¥")]),s._v("ï¼šåŸºäºå¯¹è±¡ä¹‹å‰çš„çŠ¶æ€æ¥å®šä¹‰å¯¹è±¡çŠ¶æ€çš„è½¬æ¢ã€‚\nå¦‚ï¼šé€’å¢è¿ç®—ï¼Œ"),a("code",[s._v("i++")])])]),s._v(" "),a("h3",{attrs:{id:"å¤åˆæ“ä½œ-vs-åŸå­æ“ä½œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¤åˆæ“ä½œ-vs-åŸå­æ“ä½œ"}},[s._v("#")]),s._v(" å¤åˆæ“ä½œ VS åŸå­æ“ä½œ")]),s._v(" "),a("p",[s._v("å¸¸è§çš„ç«æ€æ¡ä»¶ç±»å‹å…¶"),a("strong",[s._v("åŸå› ")]),s._v("åœ¨äºå¤åˆæ“ä½œï¼Œ"),a("strong",[s._v("éåŸå­æ“ä½œ")]),s._v("ï¼")]),s._v(" "),a("ul",[a("li",[s._v("å½“åœ¨æ— çŠ¶æ€çš„ç±»ï¼ˆæœ¬èº«ç»å¯¹çº¿ç¨‹å®‰å…¨ï¼‰ä¸­æ·»åŠ "),a("strong",[s._v("ä¸€ä¸ªçŠ¶æ€")]),s._v("æ—¶ï¼Œå¦‚æœ"),a("strong",[s._v("è¯¥çŠ¶æ€ç”±çº¿ç¨‹å®‰å…¨çš„å¯¹è±¡ç®¡ç†")]),s._v("ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»è¿˜æ˜¯çº¿ç¨‹å®‰å…¨çš„")]),s._v(" "),a("li",[s._v("ä½†æ˜¯ï¼Œå½“æ·»åŠ å¤šä¸ªçŠ¶æ€æ—¶ï¼Œå°±æ¯”è¾ƒå¤æ‚äº†")])]),s._v(" "),a("h2",{attrs:{id:"åŠ é”æœºåˆ¶-äº’æ–¥é”-åŸå­æ€§-ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŠ é”æœºåˆ¶-äº’æ–¥é”-åŸå­æ€§-ğŸ”¥"}},[s._v("#")]),s._v(" åŠ é”æœºåˆ¶â€”äº’æ–¥é”â€”åŸå­æ€§ ğŸ”¥")]),s._v(" "),a("h3",{attrs:{id:"monitorï¼ˆç›‘è§†å™¨ã€ç®¡ç¨‹ï¼‰"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#monitorï¼ˆç›‘è§†å™¨ã€ç®¡ç¨‹ï¼‰"}},[s._v("#")]),s._v(" Monitorï¼ˆç›‘è§†å™¨ã€ç®¡ç¨‹ï¼‰")]),s._v(" "),a("ul",[a("li",[s._v("ä¹Ÿç§°ä½œIntrinsic Lockï¼Œå†…ç½®é”ã€‚Java ä¸­å¯ä»¥ä½¿ç”¨"),a("strong",[s._v("åŒæ­¥ä»£ç å—")]),s._v("æœºåˆ¶å®ç°Monitorï¼Œæ”¯æŒåŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§ã€‚")]),s._v(" "),a("li",[s._v("æ¯ä¸ªJavaå¯¹è±¡éƒ½å¯ä»¥åšä¸€ä¸ªå®ç°åŒæ­¥çš„é”ã€‚çº¿ç¨‹åœ¨"),a("strong",[s._v("è¿›å…¥åŒæ­¥ä»£ç å—ä¹‹å‰è‡ªåŠ¨è·å¾—é”")]),s._v("ï¼Œå¹¶åœ¨"),a("strong",[s._v("é€€å‡ºåŒæ­¥ä»£ç å—æ—¶è‡ªåŠ¨é‡Šæ”¾é”")]),s._v("ï¼ˆæ— è®ºé€šè¿‡æ­£å¸¸æ§åˆ¶è·¯å¾„é€€å‡ºï¼Œè¿˜æ˜¯é€šè¿‡ä»£ç ä¸­æŠ›å‡ºå¼‚å¸¸é€€å‡ºï¼‰")]),s._v(" "),a("li",[a("strong",[s._v("è·å¾—é”")]),s._v("çš„å”¯ä¸€é€”å¾„å°±æ˜¯"),a("strong",[s._v("è¿›å…¥ç”±è¿™ä¸ªé”ä¿æŠ¤çš„åŒæ­¥ä»£ç å—æˆ–æ–¹æ³•")])])]),s._v(" "),a("h3",{attrs:{id:"å¯é‡å…¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¯é‡å…¥"}},[s._v("#")]),s._v(" å¯é‡å…¥")]),s._v(" "),a("ul",[a("li",[s._v("å½“æŸä¸ªçº¿ç¨‹è¯·æ±‚ç”±å…¶ä»–çº¿ç¨‹æŒæœ‰çš„é”æ—¶ï¼Œå‘å‡ºè¯·æ±‚çš„çº¿ç¨‹ä¼šé˜»å¡ã€‚ä½†æ˜¯ç”±äºMonitoræ˜¯å¯é‡å…¥çš„ï¼Œæ‰€ä»¥å¦‚æœ"),a("strong",[s._v("æŸä¸ªçº¿ç¨‹è§†å›¾è·å–ä¸€ä¸ªå·²ç»ç”±å®ƒè‡ªå·±æŒæœ‰çš„é”æ—¶")]),s._v("ï¼Œè¯¥è¯·æ±‚å°±ä¼š"),a("strong",[s._v("æˆåŠŸ")])]),s._v(" "),a("li",[s._v("é‡å…¥æ„å‘³ç€è·å–é”çš„"),a("strong",[s._v("æ“ä½œç²’åº¦æ˜¯çº¿ç¨‹")]),s._v("ï¼Œè€Œä¸æ˜¯è°ƒç”¨")])]),s._v(" "),a("p",[s._v("é‡å…¥é”ä¸€ç§å®ç°æ–¹å¼ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ä¸ºæ¯ä¸ªé”å…³è”ä¸€ä¸ª"),a("strong",[s._v("è·å–è®¡æ•°å€¼")]),s._v("ã€ä¸€ä¸ª"),a("strong",[s._v("æ‰€æœ‰è€…çº¿ç¨‹")]),s._v("ã€‚")]),s._v(" "),a("li",[s._v("å½“"),a("strong",[s._v("è®¡æ•°å€¼ä¸º0ï¼Œåˆ™è¯¥é”æ²¡æœ‰è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰")])]),s._v(" "),a("li",[s._v("å½“ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚ä¸€ä¸ªæœªè¢«æŒæœ‰çš„é”æ—¶ï¼Œ"),a("strong",[s._v("JVMå°†è®°å½•ä¸‹é”çš„æŒæœ‰è€…çº¿ç¨‹ã€è®¡æ•°å€¼ç½®ä¸º1")]),s._v("\nåŒä¸€ä¸ªçº¿ç¨‹å†æ¬¡è·å–é”ï¼Œåˆ™è®¡æ•°å€¼é€’å¢ã€‚å½“çº¿ç¨‹é€€å‡ºåŒæ­¥ä»£ç æ—¶ï¼Œè®¡æ•°å€¼é€’å‡")]),s._v(" "),a("li",[s._v("å½“"),a("strong",[s._v("è®¡æ•°å€¼ä¸º0ï¼Œåˆ™è¯¥é”è¢«é‡Šæ”¾")])])]),s._v(" "),a("h3",{attrs:{id:"æ´»è·ƒæ€§-æ€§èƒ½"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ´»è·ƒæ€§-æ€§èƒ½"}},[s._v("#")]),s._v(" æ´»è·ƒæ€§ & æ€§èƒ½")]),s._v(" "),a("p",[s._v("å¸¸è§çš„==é”™è¯¯==ï¼š==åªæœ‰åœ¨å†™å…¥å…±äº«å˜é‡æ—¶æ‰éœ€è¦ä½¿ç”¨åŒæ­¥é”==ï¼ï¼ï¼")]),s._v(" "),a("p",[s._v("å½“æ‰§è¡Œæ—¶é—´è¾ƒé•¿çš„è®¡ç®—æˆ–è€…å¯èƒ½æ— æ³•å¿«é€Ÿå®Œæˆçš„æ“ä½œæ—¶ï¼ˆä¾‹å¦‚ï¼Œç½‘ç»œIOæˆ–æ§åˆ¶å°IOï¼‰ï¼Œä¸€å®šä¸è¦æŒæœ‰é”ï¼ï¼ï¼")]),s._v(" "),a("h2",{attrs:{id:"å¯¹è±¡å…±äº«-å¯è§æ€§-ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¯¹è±¡å…±äº«-å¯è§æ€§-ğŸ”¥"}},[s._v("#")]),s._v(" å¯¹è±¡å…±äº«â€”å¯è§æ€§ ğŸ”¥")]),s._v(" "),a("h3",{attrs:{id:"ä»‹ç»-ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä»‹ç»-ğŸ”¥"}},[s._v("#")]),s._v(" ä»‹ç» ğŸ”¥")]),s._v(" "),a("ul",[a("li",[s._v("ä¹Ÿå«å†…å­˜å¯è§æ€§ï¼ˆMemory Visibilityï¼‰")]),s._v(" "),a("li",[s._v("æˆ‘ä»¬"),a("strong",[s._v("å¸Œæœ›")]),s._v("ï¼š\n"),a("ul",[a("li",[a("strong",[s._v("åŸå­æ€§")]),s._v("ï¼šé˜²æ­¢æŸä¸ªçº¿ç¨‹æ­£åœ¨ä½¿ç”¨å¯¹è±¡çŠ¶æ€ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹åœ¨åŒæ—¶ä¿®æ”¹çŠ¶æ€ï¼")]),s._v(" "),a("li",[a("strong",[s._v("å¯è§æ€§")]),s._v("ï¼šç¡®ä¿å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å¯¹è±¡çŠ¶æ€åï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°å‘ç”Ÿçš„çŠ¶æ€å˜åŒ–ï¼")])])])]),s._v(" "),a("h3",{attrs:{id:"é—®é¢˜-ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é—®é¢˜-ğŸ”¥"}},[s._v("#")]),s._v(" é—®é¢˜ ğŸ”¥")]),s._v(" "),a("ul",[a("li",[s._v("å•çº¿ç¨‹ä¸­ï¼Œå½“è¯»æ“ä½œå’Œå†™æ“ä½œåœ¨ä¸åŒçš„çº¿ç¨‹ä¸­æ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬æ— æ³•ç¡®ä¿æ‰§è¡Œè¯»æ“ä½œçš„çº¿ç¨‹èƒ½å¤Ÿå®æ—¶çš„çœ‹åˆ°å…¶ä»–çº¿ç¨‹å†™å…¥çš„å€¼")]),s._v(" "),a("li",[s._v("ä¸ºäº†ç¡®ä¿å¤šä¸ªçº¿ç¨‹ä¹‹é—´å¯¹å†…å­˜å†™å…¥æ“ä½œçš„å¯è§æ€§ï¼Œå¿…é¡»ä½¿ç”¨åŒæ­¥æœºåˆ¶")]),s._v(" "),a("li",[s._v("åœ¨"),a("strong",[s._v("æ²¡æœ‰åŒæ­¥")]),s._v("çš„æƒ…å†µä¸‹ï¼Œ"),a("strong",[s._v("å¤„ç†å™¨ã€ç¼–è¯‘å™¨ã€è¿è¡Œæ—¶éƒ½å¯èƒ½å¯¹æ“ä½œçš„æ‰§è¡Œé¡ºåºè¿›è¡Œè°ƒæ•´")]),s._v("ï¼ï¼ï¼è¯¥æ“ä½œèƒ½ä½¿JVMå……åˆ†åˆ©ç”¨ç°ä»£å¤šæ ¸å¤„ç†å™¨çš„å¼ºå¤§æ€§èƒ½ã€‚å¦‚ï¼š\n"),a("ul",[a("li",[s._v("æœªä½¿ç”¨åŒæ­¥æ—¶ï¼Œ"),a("strong",[s._v("JMMå…è®¸ç¼–è¯‘å™¨")]),s._v("å¯¹æ“ä½œè¿›è¡Œ"),a("strong",[s._v("é‡æ’åº")]),s._v("ï¼Œå°†æ•°å€¼"),a("strong",[s._v("ç¼“å­˜")]),s._v("åœ¨"),a("strong",[s._v("å¯„å­˜å™¨")]),s._v("ä¸­ã€‚")]),s._v(" "),a("li",[s._v("æœªä½¿ç”¨åŒæ­¥æ—¶ï¼Œ"),a("strong",[s._v("JMMå…è®¸CPU")]),s._v("å¯¹æ“ä½œè¿›è¡Œ"),a("strong",[s._v("é‡æ’åº")]),s._v("ï¼Œå°†æ•°å€¼"),a("strong",[s._v("ç¼“å­˜")]),s._v("åœ¨"),a("strong",[s._v("å¤„ç†å™¨ç‰¹å®šçš„ç¼“å­˜")]),s._v("ä¸­ã€‚")])])])]),s._v(" "),a("h3",{attrs:{id:"éåŸå­çš„64ä½æ“ä½œ-ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#éåŸå­çš„64ä½æ“ä½œ-ğŸ”¥"}},[s._v("#")]),s._v(" éåŸå­çš„64ä½æ“ä½œ ğŸ”¥")]),s._v(" "),a("ul",[a("li",[s._v("å½“çº¿ç¨‹åœ¨æ²¡æœ‰åŒæ­¥çš„æƒ…å†µä¸‹è¯»å–å˜é‡æ—¶ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ª"),a("strong",[s._v("å¤±æ•ˆå€¼")]),s._v("ï¼ˆä¹‹å‰è®¾ç½®çš„ï¼Œééšæœºå€¼ï¼‰ï¼Œè¿™ç§ç§°ä¸º"),a("strong",[s._v("æœ€ä½å®‰å…¨æ€§")]),s._v("ã€‚")]),s._v(" "),a("li",[a("strong",[s._v("JMMè¦æ±‚å˜é‡çš„è¯»å–å’Œå†™å…¥æ“ä½œéƒ½å¿…é¡»æ˜¯åŸå­æ“ä½œ")]),s._v("ï¼")]),s._v(" "),a("li",[s._v("ä½†æ˜¯å¯¹äº"),a("strong",[s._v("évolatileç±»å‹çš„64ä½æ•°å€¼å˜é‡ï¼ˆdoubleå’Œlongï¼‰")]),s._v("ï¼ŒJVMå…è®¸å°†64ä½è¯»æˆ–å†™æ“ä½œåˆ†è§£ä¸º2ä¸ª32ä½çš„æ“ä½œï¼ˆä¸»è¦åŸå› åœ¨äºç¼–å†™Javaè™šæ‹Ÿæœºè§„èŒƒæ—¶ï¼Œè®¸å¤šä¸»æµå¤„ç†å™¨æ¶æ„è¿˜ä¸èƒ½æœ‰æ•ˆåœ°æä¾›64ä½æ•°å€¼çš„åŸå­æ“ä½œï¼‰")])]),s._v(" "),a("h3",{attrs:{id:"é”ä¸åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§-ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é”ä¸åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§-ğŸ”¥"}},[s._v("#")]),s._v(" é”ä¸åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§ ğŸ”¥")]),s._v(" "),a("ul",[a("li",[s._v("ç®¡ç¨‹é”å®šè§„åˆ™ï¼š"),a("strong",[s._v("ä¸€ä¸ªunlockæ“ä½œHappend Beforeå¯¹åŒä¸€ä¸ªé”çš„lockæ“ä½œ")]),s._v("ã€‚")]),s._v(" "),a("li",[s._v("å³ä¸€ä¸ªçº¿ç¨‹unlockå‰çš„æ“ä½œï¼Œå¦ä¸€ä¸ªlockçº¿ç¨‹éƒ½å¯ä»¥çœ‹åˆ°")])]),s._v(" "),a("h3",{attrs:{id:"volatile-ä¸å¯è§æ€§ã€æœ‰åºæ€§ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#volatile-ä¸å¯è§æ€§ã€æœ‰åºæ€§ğŸ”¥"}},[s._v("#")]),s._v(" volatile ä¸å¯è§æ€§ã€æœ‰åºæ€§ğŸ”¥")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("ç¨å¼±çš„åŒæ­¥æœºåˆ¶ï¼Œç”¨äºç¡®ä¿"),a("strong",[s._v("å°†å˜é‡çš„æ›´æ–°æ“ä½œé€šçŸ¥åˆ°å…¶ä»–çº¿ç¨‹")]),s._v("ï¼")])]),s._v(" "),a("li",[a("p",[s._v("å˜é‡å£°æ˜ä¸ºvolatileåï¼Œç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶ä¼šæ³¨æ„åˆ°è¿™ä¸ªå˜é‡æ˜¯å…±äº«çš„")]),s._v(" "),a("ul",[a("li",[s._v("volatileå˜é‡"),a("strong",[s._v("ä¸ä¼šè¢«ç¼“å­˜åœ¨å¯„å­˜å™¨æˆ–è€…å¯¹å…¶ä»–å¤„ç†å™¨ä¸å¯è§çš„åœ°æ–¹")])]),s._v(" "),a("li",[a("strong",[s._v("ä¸ä¼š")]),s._v("å°†è¯¥å˜é‡ä¸Šçš„æ“ä½œä¸å…¶ä»–å†…å­˜æ“ä½œä¸€èµ·"),a("strong",[s._v("é‡æ’åº")])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("ä¸å»ºè®®è¿‡åº¦ä¾èµ–volatileçš„å¯è§æ€§")]),s._v("ï¼ï¼ï¼")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("ä»…å½“volatileå˜é‡èƒ½ç®€åŒ–ä»£ç çš„å®ç°ä»¥åŠå¯¹åŒæ­¥ç­–ç•¥çš„éªŒè¯æ—¶")]),s._v("ï¼Œæ‰è¯¥ä½¿ç”¨ï¼å¦‚æœåœ¨éªŒè¯æ­£ç¡®æ€§æ—¶éœ€è¦å¯¹å¯è§æ€§è¿›è¡Œå¤æ‚çš„åˆ¤æ–­ï¼Œåˆ™ä¸è¦ä½¿ç”¨")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("æ­£ç¡®ä½¿ç”¨æ–¹å¼")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("ç¡®ä¿"),a("strong",[s._v("å®ƒä»¬è‡ªèº«çŠ¶æ€çš„å¯è§æ€§")])])]),s._v(" "),a("li",[a("p",[s._v("ç¡®ä¿"),a("strong",[s._v("å®ƒä»¬æ‰€å¼•ç”¨å¯¹è±¡çš„çŠ¶æ€çš„å¯è§æ€§")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("æ ‡è¯†ä¸€äº›é‡è¦çš„ç¨‹åºç”Ÿå‘½å‘¨æœŸäº‹ä»¶")]),s._v("ï¼Œå¦‚åˆå§‹åŒ–ã€å…³é—­")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("æ£€æŸ¥æŸä¸ªæ ‡è®°ä»¥åˆ¤æ–­æ˜¯å¦é€€å‡ºå¾ªç¯")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("volatile")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" asleep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("asleep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("doSomeThing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("å½“ä¸”ä»…å½“æ»¡è¶³ä»¥ä¸‹æ‰€æœ‰æ¡ä»¶æ—¶ï¼Œæ‰åº”è¯¥ä½¿ç”¨volatileå˜é‡")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("å¯¹å˜é‡çš„å†™å…¥æ“ä½œä¸ä¾èµ–å˜é‡çš„å½“å‰å€¼ï¼Œæˆ–è€…ä½ èƒ½ç¡®ä¿åªæœ‰å•ä¸ªçº¿ç¨‹æ›´æ–°å˜é‡çš„å€¼")])]),s._v(" "),a("li",[a("strong",[s._v("è¯¥å˜é‡ä¸ä¼šä¸å…¶ä»–çŠ¶æ€å˜é‡ä¸€èµ·çº³å…¥ä¸å˜æ€§æ¡ä»¶ä¸­")])]),s._v(" "),a("li",[a("strong",[s._v("åœ¨è®¿é—®å˜é‡æ—¶ä¸éœ€è¦åŠ é”")])])])])]),s._v(" "),a("p",[s._v("è°ƒè¯•æŠ€å·§ï¼š")]),s._v(" "),a("p",[s._v("å¯¹ä¸æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼Œæ— è®ºæ˜¯å¼€å‘ã€æµ‹è¯•é˜¶æ®µï¼Œå¯åŠ¨JVMæ—¶ä¸€å®šè¦æŒ‡å®š"),a("code",[s._v("-server")]),s._v("å‘½ä»¤è¡Œé€‰é¡¹ï¼Œæ¯”"),a("code",[s._v("-client")]),s._v("æ¨¡å¼ï¼ŒJVMå°†è¿›è¡Œæ›´å¤šä¼˜åŒ–ã€‚å¦‚ï¼šå°†å¾ªç¯ä¸­æœªè¢«ä¿®æ”¹çš„å˜é‡æå‡åˆ°å¾ªç¯å¤–éƒ¨ï¼Œå› æ­¤åœ¨"),a("code",[s._v("-client")]),s._v("ä¸­å¯ä»¥æ‰§è¡Œçš„ä»£ç ï¼Œåœ¨"),a("code",[s._v("-server")]),s._v("å¯èƒ½è¿è¡Œå¤±è´¥ã€‚")]),s._v(" "),a("h2",{attrs:{id:"å¯¹è±¡å…±äº«-å‘å¸ƒä¸é€¸å‡º"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¯¹è±¡å…±äº«-å‘å¸ƒä¸é€¸å‡º"}},[s._v("#")]),s._v(" å¯¹è±¡å…±äº«â€”å‘å¸ƒä¸é€¸å‡º")]),s._v(" "),a("h3",{attrs:{id:"ç®€ä»‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç®€ä»‹"}},[s._v("#")]),s._v(" ç®€ä»‹")]),s._v(" "),a("ul",[a("li",[s._v("å‘å¸ƒï¼šä½¿"),a("strong",[s._v("å¯¹è±¡èƒ½å¤Ÿåœ¨å½“å‰ä½œç”¨åŸŸä¹‹å¤–çš„ä»£ç ä¸­ä½¿ç”¨")]),s._v("ã€‚å¦‚ï¼š\n"),a("ul",[a("li",[s._v("å°†å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°ä¸€ä¸ªå…¬æœ‰çš„é™æ€å˜é‡ä¸­ï¼Œä»¥ä¾¿ä»»ä½•ç±»å’Œçº¿ç¨‹éƒ½èƒ½çœ‹åˆ°è¯¥å¯¹è±¡")])])]),s._v(" "),a("li",[s._v("é€¸å‡ºï¼šæŸä¸ª"),a("strong",[s._v("ä¸åº”è¯¥å‘å¸ƒ")]),s._v("çš„å¯¹è±¡è¢«å‘å¸ƒæ—¶çš„æƒ…å†µ")])]),s._v(" "),a("h3",{attrs:{id:"æ„é€ å‡½æ•°ä¸­é€¸å‡º"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ„é€ å‡½æ•°ä¸­é€¸å‡º"}},[s._v("#")]),s._v(" æ„é€ å‡½æ•°ä¸­é€¸å‡º")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ThisEscape")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ThisEscape")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventSource")]),s._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("registerListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("onEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("doSomething")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("doSomething")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventSource")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("registerListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventListener")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventListener")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("onEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[s._v("ThisEscape æ„é€ å‡½æ•°ä¸­"),a("code",[s._v("doSomething")]),s._v("å…¶å®æ˜¯"),a("code",[s._v("this.doSomething")]),s._v("ï¼Œåœ¨è¿˜æœªæ„é€ å®Œæ—¶ï¼Œå³å‘å¸ƒäº†ä¸€ä¸ªå°šæœªæ„é€ å®Œæˆçš„å¯¹è±¡ï¼å³ä½¿å‘å¸ƒå¯¹è±¡çš„è¯­å¥ä½äºæ„é€ å‡½æ•°æœ€åä¸€è¡Œï¼ä¸è¦åœ¨æ„é€ å‡½æ•°ä¸­ä½¿thiså¼•ç”¨é€¸å‡ºï¼ï¼ï¼")]),s._v(" "),a("p",[s._v("åªæœ‰å½“æ„é€ å‡½æ•°è¿”å›æ—¶ï¼ˆæ‰§è¡Œå®Œæ¯•ï¼‰ï¼Œthiså¼•ç”¨æ‰åº”è¯¥ä»çº¿ç¨‹ä¸­é€¸å‡ºï¼")]),s._v(" "),a("p",[s._v("é‡‡ç”¨å·¥å‚æ–¹æ³•æ”¹é€ åçš„ï¼š")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SafeListener")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventListener")]),s._v(" listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SafeListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        listener "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("onEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("doSomething")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SafeListener")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("newInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventSource")]),s._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SafeListener")]),s._v(" safe "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SafeListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("registerListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("safe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("listener"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" safe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("doSomething")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventSource")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("registerListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventListener")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EventListener")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("onEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Event")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])]),a("h2",{attrs:{id:"é¿å…åŒæ­¥-å¯¹è±¡ä¸å…±äº«ã€çº¿ç¨‹å°é—­"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é¿å…åŒæ­¥-å¯¹è±¡ä¸å…±äº«ã€çº¿ç¨‹å°é—­"}},[s._v("#")]),s._v(" é¿å…åŒæ­¥â€”å¯¹è±¡ä¸å…±äº«ã€çº¿ç¨‹å°é—­")]),s._v(" "),a("h3",{attrs:{id:"ç®€ä»‹-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç®€ä»‹-2"}},[s._v("#")]),s._v(" ç®€ä»‹")]),s._v(" "),a("p",[s._v("è®¿é—®å…±äº«çš„å¯å˜æ•°æ®æ—¶ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨åŒæ­¥ï¼Œä¸€ç§é¿å…ä½¿ç”¨åŒæ­¥çš„æ–¹å¼å°±æ˜¯ä¸å…±äº«æ•°æ®ï¼")]),s._v(" "),a("p",[s._v("å¦‚æœ"),a("strong",[s._v("ä»…åœ¨å•çº¿ç¨‹å†…è®¿é—®æ•°æ®")]),s._v("ï¼Œå°±ä¸éœ€è¦åŒæ­¥ï¼Œè¯¥æŠ€æœ¯ç§°ä¸º"),a("strong",[s._v("çº¿ç¨‹å°é—­")]),s._v("ï¼å®ƒæ˜¯"),a("strong",[s._v("å®ç°çº¿ç¨‹å®‰å…¨æ€§æœ€ç®€å•æ–¹æ³•ä¹‹ä¸€")]),s._v("ï¼")]),s._v(" "),a("p",[s._v("å¦‚JDBCè§„èŒƒå¹¶ä¸è¦æ±‚Connectionå¯¹è±¡å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯åœ¨æœåŠ¡å™¨åº”ç”¨ä¸­ï¼Œç”±äºå¤§å¤šæ•°è¯·æ±‚ï¼ˆå¦‚Servletï¼‰éƒ½æ˜¯ç”±å•ä¸ªçº¿ç¨‹é‡‡ç”¨åŒæ­¥çš„æ–¹å¼æ¥å¤„ç†ï¼Œå¹¶ä¸”åœ¨Connectionå¯¹è±¡è¿”å›ä¹‹å‰ï¼Œè¿æ¥æ± éƒ½ä¸ä¼šæŠŠå®ƒåˆ†é…ç»™å…¶ä»–çº¿ç¨‹ã€‚å› æ­¤è¿™ç§ç®¡ç†æ¨¡å¼éšå«åœ°å°†Connectionå¯¹è±¡å°é—­åœ¨çº¿ç¨‹ä¸­ã€‚")]),s._v(" "),a("h3",{attrs:{id:"æ ˆå°é—­-å±€éƒ¨å˜é‡-ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ ˆå°é—­-å±€éƒ¨å˜é‡-ğŸ”¥"}},[s._v("#")]),s._v(" æ ˆå°é—­â€”å±€éƒ¨å˜é‡ ğŸ”¥")]),s._v(" "),a("p",[s._v("åœ¨å°é—­æ ˆä¸­ï¼Œåªèƒ½é€šè¿‡å±€éƒ¨å˜é‡æ‰èƒ½è®¿é—®å¯¹è±¡ï¼Œå› æ­¤çº¿ç¨‹é—´ä¸å­˜åœ¨å¯¹è±¡å…±äº«")]),s._v(" "),a("h3",{attrs:{id:"threadlocal-ğŸ”¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#threadlocal-ğŸ”¥"}},[s._v("#")]),s._v(" ThreadLocal ğŸ”¥")]),s._v(" "),a("p",[s._v("ThreadLocalèƒ½ä½¿"),a("strong",[s._v("çº¿ç¨‹")]),s._v("ä¸­çš„æŸä¸ªå€¼ä¸"),a("strong",[s._v("ä¿å­˜å€¼çš„å¯¹è±¡")]),s._v("å…³è”èµ·æ¥ã€‚å¸¸ç”¨äºé˜²æ­¢å¯¹å¯å˜çš„å•å®ä¾‹å˜é‡æˆ–"),a("strong",[s._v("å…¨å±€å˜é‡è¿›è¡Œå…±äº«")]),s._v("ï¼")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConnectionDispenser")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" DB_URL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jdbc:mysql://localhost/mydatabase"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ThreadLocal")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Connection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" connectionHolder\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ThreadLocal")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Connection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Connection")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DriverManager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getConnection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DB_URL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SQLException")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RuntimeException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Unable to acquire Connection, e"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Connection")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getConnection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" connectionHolder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h2",{attrs:{id:"æ»¡è¶³åŒæ­¥-ä¸å˜æ€§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ»¡è¶³åŒæ­¥-ä¸å˜æ€§"}},[s._v("#")]),s._v(" æ»¡è¶³åŒæ­¥â€”ä¸å˜æ€§")]),s._v(" "),a("p",[a("strong",[s._v("çº¿ç¨‹å®‰å…¨")]),s._v("æ€§æ˜¯ä¸å¯å˜å¯¹è±¡çš„"),a("strong",[s._v("å›ºæœ‰å±æ€§")]),s._v("ä¹‹ä¸€ï¼å³"),a("strong",[s._v("ä¸å¯å˜å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨")]),s._v("çš„ï¼")]),s._v(" "),a("p",[s._v("ä½†æ˜¯"),a("strong",[s._v("å³ä½¿")]),s._v("å¯¹è±¡ä¸­æ‰€æœ‰çš„"),a("strong",[s._v("åŸŸéƒ½æ˜¯finalç±»å‹")]),s._v("çš„ï¼Œè¿™ä¸ªå¯¹è±¡ä¹Ÿ"),a("strong",[s._v("å¯èƒ½æ˜¯å¯å˜")]),s._v("çš„ï¼"),a("strong",[s._v("ä¸å˜å¯¹è±¡çš„åŸŸä¸­ä¿å­˜çš„æ˜¯å¯å˜å¯¹è±¡çš„å¼•ç”¨")]),s._v("ï¼")]),s._v(" "),a("p",[s._v("ä¾‹å¦‚ä½¿ç”¨ volatile å‘å¸ƒä¸å¯å˜å¯¹è±¡ï¼ˆ"),a("strong",[s._v("å¯¹è±¡çš„å°è£…å¯ä»¥æ›´å¥½æ›´æ–¹ä¾¿ä¿éšœåŸå­æ€§")]),s._v("ï¼‰")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * OneValueCache\n * <p/>\n * Immutable holder for caching a number and its factors\n *\n * @author Brian Goetz and Tim Peierls\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Immutable")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OneValueCache")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),s._v(" lastNumber"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" lastFactors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OneValueCache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                         "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" factors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        lastNumber "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        lastFactors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("copyOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("factors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" factors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getFactors")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lastNumber "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("lastNumber"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("copyOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lastFactors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lastFactors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * VolatileCachedFactorizer\n * <p/>\n * Caching the last result using a volatile reference to an immutable holder object\n *\n * @author Brian Goetz and Tim Peierls\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@ThreadSafe")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("VolatileCachedFactorizer")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GenericServlet")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Servlet")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("volatile")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OneValueCache")]),s._v(" cache "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OneValueCache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletRequest")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletResponse")]),s._v(" resp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("extractFromRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" factors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getFactors")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("factors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            factors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("factor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            cache "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OneValueCache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" factors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("encodeIntoResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" factors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("encodeIntoResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletResponse")]),s._v(" resp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" factors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("extractFromRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletRequest")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("factor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Doesn't really factor")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("h2",{attrs:{id:"å®‰å…¨å‘å¸ƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®‰å…¨å‘å¸ƒ"}},[s._v("#")]),s._v(" å®‰å…¨å‘å¸ƒ")]),s._v(" "),a("p",[s._v("å¦‚ä½•ä¿éšœä½¿ç”¨å¯¹è±¡çš„çº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°è¯¥å¯¹è±¡å¤„äºå·²å‘å¸ƒçŠ¶æ€ï¼Ÿåˆ™"),a("strong",[s._v("å¯¹è±¡çš„å¼•ç”¨")]),s._v("å’Œ"),a("strong",[s._v("å¯¹è±¡çš„çŠ¶æ€")]),s._v("å¿…é¡»éƒ½å¯¹å…¶ä»–çº¿ç¨‹"),a("strong",[s._v("å¯è§")]),s._v("ï¼å¸¸ç”¨æ¨¡å¼ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("é™æ€åˆå§‹åŒ–å‡½æ•°ä¸­åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨")])]),s._v(" "),a("p",[a("strong",[s._v("é™æ€åˆå§‹åŒ–å‡½æ•°")]),s._v("ç”±"),a("strong",[s._v("JVMåœ¨ç±»åˆå§‹åŒ–é˜¶æ®µæ‰§è¡Œ")]),s._v("ï¼Œç”±äºJVMå†…éƒ¨çš„åŒæ­¥æœºåˆ¶ï¼Œè¯¥åˆå§‹åŒ–æ–¹æ³•çš„å¯¹è±¡"),a("strong",[s._v("å¿…å®šè¢«å®‰å…¨å‘å¸ƒ")]),s._v("ï¼")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Holder")]),s._v(" holder "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Holder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("å°†å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°"),a("strong",[s._v("volatileç±»å‹çš„åŸŸ")]),s._v("æˆ–"),a("strong",[s._v("AtomicReferanceå¯¹è±¡")]),s._v("ä¸­")])]),s._v(" "),a("li",[a("p",[s._v("å°†å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°æŸä¸ª"),a("strong",[s._v("æ­£ç¡®æ„é€ å¯¹è±¡çš„finalç±»å‹åŸŸ")]),s._v("ä¸­ã€‚å¦‚ä¸Šé¢çš„ä¸å˜æ€§")])]),s._v(" "),a("li",[a("p",[s._v("å°†å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°ä¸€ä¸ª"),a("strong",[s._v("ç”±é”ä¿æŠ¤çš„åŸŸä¸­")])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);