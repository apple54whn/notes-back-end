(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{739:function(s,a,e){"use strict";e.r(a);var t=e(11),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"mysql-运维"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql-运维"}},[s._v("#")]),s._v(" MySQL 运维")]),s._v(" "),e("h2",{attrs:{id:"mysql-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql-安装"}},[s._v("#")]),s._v(" MySQL 安装")]),s._v(" "),e("p",[s._v("可通过安装程序、Docker 等安装")]),s._v(" "),e("p",[s._v("可参考：")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://juejin.cn/book/6844733802426662926/section/6844733802607017991",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL Installer"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("Docker（可参考 Docker 笔记）")])]),s._v(" "),e("h2",{attrs:{id:"重要文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重要文件"}},[s._v("#")]),s._v(" 重要文件")]),s._v(" "),e("h3",{attrs:{id:"文件夹"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#文件夹"}},[s._v("#")]),s._v(" 文件夹")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("C:\\Program Files\\MySQL\\MySQL Server 8.0："),e("strong",[s._v("DBMS管理程序")])])]),s._v(" "),e("li",[e("p",[s._v("C:\\ProgramData\\MySQL\\MySQL Server 8.0\\data："),e("strong",[s._v("DBMS数据库文件")]),s._v("（卸载MySQL时不会删除）")]),s._v(" "),e("p",[s._v("每个目录表示一个数据库，MySQl8的每个数据库目录下会有0~N个扩展名为ibd的table文件")])])]),s._v(" "),e("p",[s._v("同样的，5.7版本的如下：")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("C:\\Program Files\\MySQL\\MySQL Server 5.7")])]),s._v(" "),e("li",[e("p",[s._v("C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Data")])])]),s._v(" "),e("h3",{attrs:{id:"bin目录下的可执行文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bin目录下的可执行文件"}},[s._v("#")]),s._v(" bin目录下的可执行文件")]),s._v(" "),e("p",[s._v("如下为5.7的")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(".\n├── mysql.exe\n├── mysqladmin.exe\n├── mysqlbinlog.exe\n├── mysqlcheck.exe\n├── mysqld.exe\n├── mysqldump.exe\n├── mysqlimport.exe\n├── mysqlpump.exe\n... (省略其他文件)\n0 directories, 32 files\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("p",[s._v("可以将该"),e("code",[s._v("bin")]),s._v("目录的路径加入到环境变量"),e("code",[s._v("Path")]),s._v("中")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("C:\\Program Files\\MySQL\\MySQL Server 8.0\\bin\\ "),e("strong",[s._v("mysqld")]),s._v(".exe："),e("strong",[s._v("服务器程序")]),s._v("，必须先启动它")])]),s._v(" "),e("li",[e("p",[s._v("C:\\Program Files\\MySQL\\MySQL Server 8.0\\bin\\ "),e("strong",[s._v("mysql")]),s._v(".exe："),e("strong",[s._v("客户端程序")]),s._v("操作服务器，服务器需先开启")]),s._v(" "),e("p",[s._v("mysqld 是 MySQL 的主程序，服务器端。mysql 是 MySQL 的命令行工具，客户端。")])])]),s._v(" "),e("h3",{attrs:{id:"其他文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其他文件"}},[s._v("#")]),s._v(" 其他文件")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("C:\\ProgramData\\MySQL\\MySQL Server 8.0\\ "),e("strong",[s._v("my.ini")]),s._v("："),e("strong",[s._v("服务器配置文件")]),s._v("，之前版本放在安装目录中bin下")]),s._v(" "),e("ul",[e("li",[s._v("配置MySQL的端口："),e("strong",[s._v("默认为3306")]),s._v("（一般不建议修改，本电脑MySQL5为3306、MySQL8为3308端口）")]),s._v(" "),e("li",[s._v("配置字符编码：（一般不建议修改）\n"),e("ul",[e("li",[s._v("[mysql]下配置默认客户端编码：default-character-set=gbk")]),s._v(" "),e("li",[s._v("[mysqld]下配置默认服务器编码：character-set-server=utf8")])])]),s._v(" "),e("li",[s._v("配置二进制数据大小上限：（一般不建议修改）\n"),e("ul",[e("li",[s._v("在[mysqld]下配置：max_allowed_packet=8M")])])])])])]),s._v(" "),e("h2",{attrs:{id:"服务器程序和客户端程序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#服务器程序和客户端程序"}},[s._v("#")]),s._v(" 服务器程序和客户端程序")]),s._v(" "),e("h3",{attrs:{id:"服务器程序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#服务器程序"}},[s._v("#")]),s._v(" 服务器程序")]),s._v(" "),e("blockquote",[e("p",[s._v("我的服务名称为mysql8")])]),s._v(" "),e("p",[s._v("通过服务启动")]),s._v(" "),e("ul",[e("li",[s._v("开启服务器(必须保证mysql为windows服务)："),e("strong",[e("code",[s._v("net start mysql8")])]),s._v("，mysqld.exe进程存在")]),s._v(" "),e("li",[s._v("关闭服务器(必须保证mysql为windows服务)："),e("strong",[e("code",[s._v("net stop mysql8")])]),s._v("，mysqld.exe进程不存在")])]),s._v(" "),e("p",[s._v("当然也可以通过 mysqld 启动")]),s._v(" "),e("p",[s._v("在使用"),e("code",[s._v("mysqld")]),s._v("可执行文件启动MySQL服务器程序时，它默认并不会将路径设置为"),e("code",[s._v("数据目录")]),s._v("的路径，这时就需要我们在启动MySQL服务器时显式地指定一个称之为"),e("code",[s._v("datadir")]),s._v("的参数，该参数就代表着"),e("code",[s._v("数据目录")]),s._v("的路径，所以使用下边的命令启动MySQL服务器就不会报错了：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('mysqld --datadir="C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Data"\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果我们想查看在使用"),e("code",[s._v("mysqld")]),s._v("可执行文件启动MySQL服务器的过程中输出的日志信息，可以在上述命令后边加上"),e("code",[s._v("--console")]),s._v("，就像这样：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('mysqld --datadir="C:\\ProgramData\\MySQL\\MySQL Server 5.7\\Data" --console\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"客户端操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#客户端操作"}},[s._v("#")]),s._v(" 客户端操作")]),s._v(" "),e("p",[s._v("在服务器程序启动之后（不管是使用"),e("code",[s._v("mysqld")]),s._v("可执行文件启动的还是使用Windows服务的方式启动的），就可以接着启动客户端程序来连接到这个服务器喽。"),e("code",[s._v("bin")]),s._v("目录下有许多客户端程序，比方说"),e("code",[s._v("mysqladmin")]),s._v("、"),e("code",[s._v("mysqldump")]),s._v("、"),e("code",[s._v("mysqlcheck")]),s._v("等等等等（好多呢，就不一一列举了）。这里我们重点要关注的是可执行文件"),e("code",[s._v("mysql")]),s._v("，通过这个可执行文件可以让我们和服务器程序进程交互，也就是发送请求以及接收服务器的处理结果。启动这个可执行文件时一般需要一些参数，格式如下：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("mysql -h主机名  -u用户名 -p密码\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("各个参数的意义如下：")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[s._v("参数名")]),s._v(" "),e("th",[s._v("含义")])])]),s._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[s._v("-h")]),s._v(" "),e("td",[s._v("表示启动服务器程序的计算机的域名或者IP地址，如果服务器程序就运行在本机的话，可以省略这个参数，也可以填"),e("code",[s._v("localhost")]),s._v("或者"),e("code",[s._v("127.0.0.1")]),s._v("。也可以写作 "),e("code",[s._v("--host=主机")]),s._v("的形式。")])]),s._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[s._v("-P")]),s._v(" "),e("td",[s._v("大写的P，端口号，不写默认为3306")])]),s._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[s._v("-u")]),s._v(" "),e("td",[s._v("表示用户名，我们刚刚安装完，作为超级管理员的我们的用户名是"),e("code",[s._v("root")]),s._v("。也可以写作 "),e("code",[s._v("--user=用户名")]),s._v("的形式。")])]),s._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[s._v("-p")]),s._v(" "),e("td",[s._v("表示密码。也可以写作 "),e("code",[s._v("--password=密码")]),s._v("的形式。")])])])]),s._v(" "),e("p",[s._v("比如我这样执行下边这个可执行文件(用户名密码按你的实际情况填写)，就可以启动"),e("code",[s._v("MySQL")]),s._v("客户端，并且连接到服务器了。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql -hlocalhost -uroot -p123456\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("也可以这么写：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql --host=localhost --user=root --password=123456\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("我们看一下连接成功后的界面：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql: [Warning] Using a password on the command line interface can be insecure.\n\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 2\nServer version: 5.7.27 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql>\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v("最后一行的"),e("code",[s._v("mysql>")]),s._v("是一个客户端的提示符，之后客户端发送给服务器的命令都需要写在这个提示符后边。")]),s._v(" "),e("p",[s._v("如果我们想断开客户端与服务器的连接并且关闭客户端的话，可以在"),e("code",[s._v("mysql>")]),s._v("提示符后输入下边任意一个命令：")]),s._v(" "),e("ol",[e("li",[e("code",[s._v("quit")])]),s._v(" "),e("li",[e("code",[s._v("exit")])]),s._v(" "),e("li",[e("code",[s._v("\\q")])])]),s._v(" "),e("p",[s._v("比如我们输入"),e("code",[s._v("quit")]),s._v("试试：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> quit\nBye\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("输出了"),e("code",[s._v("Bye")]),s._v("说明客户端程序已经关掉了。注意注意注意，这是关闭客户端程序的方式，不是关闭服务器程序的方式")]),s._v(" "),e("p",[s._v("如果你愿意，你可以多打开几个黑框框，每个黑框框都使用可以执行"),e("code",[s._v("mysql -hlocalhost -uroot -p123456")]),s._v("命令，从而达到运行多个客户端程序的效果，每个客户端程序都是互不影响的。如果你有多个电脑，也可以试试把它们用局域网连起来，在一个电脑上启动"),e("code",[s._v("MySQL")]),s._v("服务器程序，在另一个电脑上执行"),e("code",[s._v("mysql")]),s._v("命令时使用"),e("code",[s._v("IP")]),s._v("地址作为主机名来连接到服务器。")]),s._v(" "),e("h3",{attrs:{id:"连接注意事项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#连接注意事项"}},[s._v("#")]),s._v(" 连接注意事项")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("最好不要在一行命令中输入密码。")]),s._v(" "),e("p",[s._v("我们直接在黑框框里把密码敲出去被别人看到咋办，这和你当别人的面输入银行卡密码没啥区别，所以我们在执行"),e("code",[s._v("mysql")]),s._v("连接服务器的时候可以不显式的写出密码，就像这样：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql -hlocalhost -uroot -p\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("点击回车之后才会提示你输入密码：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("Enter password:\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("不过这回你输入的密码不会被显示出来，心怀不轨的人也就看不到了，输入完成点击回车就成功连接到了服务器。")])]),s._v(" "),e("li",[e("p",[s._v("如果你非要在显式的把密码输出来，那"),e("strong",[s._v("密码值和"),e("code",[s._v("-p")]),s._v("之间不能有空白字符")]),s._v("，"),e("strong",[s._v("其他参数名之间可以有空白字符")]),s._v("，就像这样：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql -h localhost -u root -p123456\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果加上了空白字符就是错误的，比如这样：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql -h localhost -u root -p 123456\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[e("code",[s._v("mysql")]),s._v("的各个参数的摆放顺序没有硬性规定，也就是说你也可以这么写：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql -p  -u root -h localhost\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("如果你的服务器和客户端安装在同一台机器上，"),e("code",[s._v("-h")]),s._v("参数可以省略，就像这样：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql -u root -p  \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("如果你使用的是类Unix系统，并且省略"),e("code",[s._v("-u")]),s._v("参数后，会把你登陆操作系统的用户名当作"),e("code",[s._v("MySQL")]),s._v("的用户名去处理。")]),s._v(" "),e("p",[s._v("比方说我用登录操作系统的用户名是"),e("code",[s._v("xiaohaizi")]),s._v("，那么在我的机器上下边这两条命令是等价的：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql -u xiaohaizi -p\nmysql -p\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("对于Windows系统来说，"),e("strong",[s._v("默认的用户名是"),e("code",[s._v("ODBC")])]),s._v("，你可以通过设置环境变量"),e("code",[s._v("USER")]),s._v("来添加一个默认用户名。")])])]),s._v(" "),e("h2",{attrs:{id:"参数设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参数设置"}},[s._v("#")]),s._v(" 参数设置")]),s._v(" "),e("h3",{attrs:{id:"启动选项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动选项"}},[s._v("#")]),s._v(" 启动选项")]),s._v(" "),e("ul",[e("li",[s._v("命令行")]),s._v(" "),e("li",[s._v("配置文件中")]),s._v(" "),e("li",[s._v("区别")])]),s._v(" "),e("h3",{attrs:{id:"系统变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#系统变量"}},[s._v("#")]),s._v(" 系统变量")]),s._v(" "),e("p",[s._v("MySQL服务器在运行过程中会用到的影响程序行为的变量，如允许同事连入的客户端数量"),e("code",[s._v("max_connections")]),s._v("等")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("查看系统变量")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" VARIABLES "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("LIKE")]),s._v(" 匹配的模式"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" VARIABLES "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("LIKE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%character%'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动项设置系统变量")])]),s._v(" "),e("li",[e("p",[s._v("服务器运行过程中设置系统变量")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SET [GLOBAL | SESSION] 系统变量名 = 值;\nSET [@@(GLOBAL | SESSION).]系统变量名 = 值;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"状态变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#状态变量"}},[s._v("#")]),s._v(" 状态变量")]),s._v(" "),e("p",[s._v("如 "),e("code",[s._v("Threads_connected")]),s._v(" 表示当前有多少客户端与服务器建立了连接")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("查看状态变量")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GLOBAL")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SESSION")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("STATUS")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("LIKE")]),s._v(" 匹配的模式"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("不能设置哦")])])]),s._v(" "),e("h2",{attrs:{id:"字符集和乱码问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#字符集和乱码问题"}},[s._v("#")]),s._v(" 字符集和乱码问题")]),s._v(" "),e("h3",{attrs:{id:"客户端和服务端通信过程中使用的字符集"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#客户端和服务端通信过程中使用的字符集"}},[s._v("#")]),s._v(" 客户端和服务端通信过程中使用的字符集")]),s._v(" "),e("h4",{attrs:{id:"_1、客户端发送请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、客户端发送请求"}},[s._v("#")]),s._v(" 1、客户端发送请求")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("类 UNIX 系统根据 "),e("code",[s._v("LC_ALL")]),s._v(" > "),e("code",[s._v("LC_CTYPE")]),s._v(" > "),e("code",[s._v("LANG")]),s._v(" 三个环境变量来决定使用哪个字符集，优先级按照从大到小排序")]),s._v(" "),e("p",[s._v("可通过 "),e("code",[s._v("echo $LC_ALL")]),s._v(" 等查看。底层调用系统函数 "),e("code",[s._v("nl_langinfo(CODESET)")])])]),s._v(" "),e("li",[e("p",[s._v("Win 根据代码页（code page）决定，一个代码页与一个唯一的数字关联。如 936 代表 GBK 字符集；65001 代表 UTF-8 字符集。在 win 命令行窗口即可看到代码页，cmd 默认为 936 即 GBK，也可以执行"),e("code",[s._v("chcp")]),s._v("命令查看。底层调用系统函数"),e("code",[s._v("GetConsoleCP")])]),s._v(" "),e("p",[s._v("但是在启动 mysql 客户端时若携带了 "),e("code",[s._v("default-character-set")]),s._v("启动项，则 mysql 客户端会按照该启动项指定的字符集进行编码（启动项不适用于类 UNIX）")])])]),s._v(" "),e("h4",{attrs:{id:"_2、服务端接收请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、服务端接收请求"}},[s._v("#")]),s._v(" 2、服务端接收请求")]),s._v(" "),e("p",[s._v("服务器接收到字节序列，并将其看作是使用系统变量"),e("code",[s._v("character_set_client")]),s._v("代表的字符集进行编码的字节序列。该系统变量是每个客户端与服务器建立连接后，"),e("strong",[s._v("服务器都会为该客户端维护")]),s._v("一个单独的"),e("code",[s._v("SESSION")]),s._v("级别的"),e("code",[s._v("character_set_client")]),s._v("变量。")]),s._v(" "),e("p",[s._v("也就是说"),e("strong",[s._v("客户端实际使用")]),s._v("的字符集与"),e("strong",[s._v("服务端认为")]),s._v("该客户端发送的字节序列使用的编码字符集是独立不同的。一般情况下，需要保持这两个字符集一致！")]),s._v(" "),e("p",[s._v("可以使用"),e("code",[s._v("SET character_set_client = ascii")]),s._v("命令修改，当其不能解析请求的字节序列时，服务器会发出警告。如客户端实际使用 UTF-8，而 character_set_client 为 ASCII：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> select '我';\n+---------+\n|   ???   |\n+---------+\n|   ???   |\n+---------+\n1 row in set, 1 warning (0.00 sec)\n\nmysql> show warnings\\G\n**************** 1. row ****************\n  Level: Warning\n   Code: 1300\nMessage: Invalid ascii character string: '\\xE6\\x88\\x91'\n1 row in set (0.00 sec)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v('上述可以看出，"我"对应的 UTF-8 编码"0xE68891"无法通过 ASCII 来解码')]),s._v(" "),e("h4",{attrs:{id:"_3、服务端处理请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、服务端处理请求"}},[s._v("#")]),s._v(" 3、服务端处理请求")]),s._v(" "),e("p",[s._v("虽然服务器会将请求的字节序列当做采用 "),e("code",[s._v("character_set_client")]),s._v(" 对应的字符集进行编码的字节序列，但是在真正处理请求时会将其"),e("strong",[s._v("转换")]),s._v("为使用 SESSION 级别的系统变量 "),e("code",[s._v("character_set_connection")]),s._v("对应的字符集进行编码的字节序列。同样可以使用"),e("code",[s._v("SET character_set_connection = gbk")]),s._v("命令修改")]),s._v(" "),e("p",[s._v("这个主要用于比较、排序（配合 collation_connection 校对集），比如是否与大小相关等")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> select 'a' = 'A';\n+---------+\n|'a' = 'A'|\n+---------+\n|1        |\n+---------+\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("并且"),e("strong",[s._v("列的字符集和排序规则优于")]),s._v("上述系统变量设置的")]),s._v(" "),e("h4",{attrs:{id:"_4、服务端生成响应"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、服务端生成响应"}},[s._v("#")]),s._v(" 4、服务端生成响应")]),s._v(" "),e("p",[s._v("服务器在查询完数据后，会将期转换为"),e("code",[s._v("character_set_result")]),s._v("系统变量对应的字符集编码后的字节序列，然后发送给客户端。当然也可以通过"),e("code",[s._v("SET character_set_result = gbk")]),s._v("来修改")]),s._v(" "),e("h4",{attrs:{id:"_5、客户端接收响应"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、客户端接收响应"}},[s._v("#")]),s._v(" 5、客户端接收响应")]),s._v(" "),e("ul",[e("li",[s._v("类UNIX系统会根据系统默认字符集来解析")]),s._v(" "),e("li",[s._v("Win系统会根据命令行如cmd（默认为GBK）来解析，当然还会根据"),e("code",[s._v("default-character-set")]),s._v("启动项解析")])]),s._v(" "),e("h3",{attrs:{id:"三个系统变量总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三个系统变量总结"}},[s._v("#")]),s._v(" 三个系统变量总结")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("系统变量")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("character_set_client")]),s._v(" "),e("td",[s._v("服务器"),e("strong",[s._v("认为")]),s._v("请求是按照该系统变量指定的字符集进行编码的，实际可能不是")])]),s._v(" "),e("tr",[e("td",[s._v("character_set_connection")]),s._v(" "),e("td",[s._v("服务器在处理请求时，会把请求字节序列从character_set_client "),e("strong",[s._v("转换")]),s._v("为 character_set_connection，用于比较排序等")])]),s._v(" "),e("tr",[e("td",[s._v("character_set_result")]),s._v(" "),e("td",[s._v("服务器采用该系统变量指定的字符集对"),e("strong",[s._v("返回")]),s._v("给客户端的字符串进行编码")])])])]),s._v(" "),e("p",[s._v("上述三个系统变量的作用范围都是 SESSION 级别。")]),s._v(" "),e("p",[s._v("每个mysql客户端都维护着一个客户端默认字符集，客户端在启动时自动检测所在操作系统当前使用的字符集（环境变量等），并按照一定规则映射成mysql支持的字符集，然后将该字符集作为客户端默认的字符集。特殊情况是操作系统使用 ascii 字符集时会被映射为 latin1 字符集。且当mysql 不支持操作系统当前使用的字符集时，会设置为mysql 默认的字符集。MySQL5.7以及之前的版本中，默认字符集为 latin1，自8.0版本开始改为 utf8mb4。当然启动客户端时设置了"),e("code",[s._v("default-character-set")]),s._v("启动选项，则按该值作为字符集。")]),s._v(" "),e("p",[s._v("在"),e("strong",[s._v("连接服务器")]),s._v("时，客户端将默认的字符集信息与用户名密码等信息一起发送给服务器，服务器在收到后会将上述3个系统变量的值"),e("strong",[s._v("初始化")]),s._v("为客户端的默认"),e("strong",[s._v("字符集")]),s._v("。")]),s._v(" "),e("p",[s._v("连接成功后，可通过 set 命令一个个修改，也可以通过"),e("code",[s._v("set names gbk")]),s._v('来一次性全部修改（没有"="哦）')]),s._v(" "),e("h3",{attrs:{id:"校对集-排序规则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#校对集-排序规则"}},[s._v("#")]),s._v(" 校对集—排序规则")]),s._v(" "),e("p",[s._v("一个字符集可以有若干种比较规则，其中有一个默认的比较规则。一个比较规则必须对应一个字符集。")]),s._v(" "),e("p",[s._v("创建数据库、表时需要填写的校对集（排序规则）")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("无标题"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARACTER")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" utf8mb4 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COLLATE")]),s._v(" utf8mb4_general_ci "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("InnoDB")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARACTER")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8mb4 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COLLATE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8mb4_general_ci ROW_FORMAT "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Dynamic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"常用命令总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常用命令总结"}},[s._v("#")]),s._v(" 常用命令总结")]),s._v(" "),e("h4",{attrs:{id:"查看支持的字符集"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看支持的字符集"}},[s._v("#")]),s._v(" 查看支持的字符集")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SHOW (CHARACTER SET | CHARSET) [LIKE 匹配的模式]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> show character set;\n+----------+---------------------------------+---------------------+--------+\n| Charset  | Description                     | Default collation   | Maxlen |\n+----------+---------------------------------+---------------------+--------+\n| armscii8 | ARMSCII-8 Armenian              | armscii8_general_ci |      1 |\n| ascii    | US ASCII                        | ascii_general_ci    |      1 |\n| big5     | Big5 Traditional Chinese        | big5_chinese_ci     |      2 |\n| binary   | Binary pseudo charset           | binary              |      1 |\n| cp1250   | Windows Central European        | cp1250_general_ci   |      1 |\n| cp1251   | Windows Cyrillic                | cp1251_general_ci   |      1 |\n| cp1256   | Windows Arabic                  | cp1256_general_ci   |      1 |\n| cp1257   | Windows Baltic                  | cp1257_general_ci   |      1 |\n| cp850    | DOS West European               | cp850_general_ci    |      1 |\n| cp852    | DOS Central European            | cp852_general_ci    |      1 |\n| cp866    | DOS Russian                     | cp866_general_ci    |      1 |\n| cp932    | SJIS for Windows Japanese       | cp932_japanese_ci   |      2 |\n| dec8     | DEC West European               | dec8_swedish_ci     |      1 |\n| eucjpms  | UJIS for Windows Japanese       | eucjpms_japanese_ci |      3 |\n| euckr    | EUC-KR Korean                   | euckr_korean_ci     |      2 |\n| gb18030  | China National Standard GB18030 | gb18030_chinese_ci  |      4 |\n| gb2312   | GB2312 Simplified Chinese       | gb2312_chinese_ci   |      2 |\n| gbk      | GBK Simplified Chinese          | gbk_chinese_ci      |      2 |\n| geostd8  | GEOSTD8 Georgian                | geostd8_general_ci  |      1 |\n| greek    | ISO 8859-7 Greek                | greek_general_ci    |      1 |\n| hebrew   | ISO 8859-8 Hebrew               | hebrew_general_ci   |      1 |\n| hp8      | HP West European                | hp8_english_ci      |      1 |\n| keybcs2  | DOS Kamenicky Czech-Slovak      | keybcs2_general_ci  |      1 |\n| koi8r    | KOI8-R Relcom Russian           | koi8r_general_ci    |      1 |\n| koi8u    | KOI8-U Ukrainian                | koi8u_general_ci    |      1 |\n| latin1   | cp1252 West European            | latin1_swedish_ci   |      1 |\n| latin2   | ISO 8859-2 Central European     | latin2_general_ci   |      1 |\n| latin5   | ISO 8859-9 Turkish              | latin5_turkish_ci   |      1 |\n| latin7   | ISO 8859-13 Baltic              | latin7_general_ci   |      1 |\n| macce    | Mac Central European            | macce_general_ci    |      1 |\n| macroman | Mac West European               | macroman_general_ci |      1 |\n| sjis     | Shift-JIS Japanese              | sjis_japanese_ci    |      2 |\n| swe7     | 7bit Swedish                    | swe7_swedish_ci     |      1 |\n| tis620   | TIS620 Thai                     | tis620_thai_ci      |      1 |\n| ucs2     | UCS-2 Unicode                   | ucs2_general_ci     |      2 |\n| ujis     | EUC-JP Japanese                 | ujis_japanese_ci    |      3 |\n| utf16    | UTF-16 Unicode                  | utf16_general_ci    |      4 |\n| utf16le  | UTF-16LE Unicode                | utf16le_general_ci  |      4 |\n| utf32    | UTF-32 Unicode                  | utf32_general_ci    |      4 |\n| utf8     | UTF-8 Unicode                   | utf8_general_ci     |      3 |\n| utf8mb4  | UTF-8 Unicode                   | utf8mb4_0900_ai_ci  |      4 |\n+----------+---------------------------------+---------------------+--------+\n41 rows in set (0.10 sec)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br")])]),e("h4",{attrs:{id:"查看支持的比较规则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看支持的比较规则"}},[s._v("#")]),s._v(" 查看支持的比较规则")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SHOW COLLATION [LIKE 匹配的模式]\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("太多了，自己看吧")]),s._v(" "),e("h4",{attrs:{id:"查询系统各个属性字符集-🔥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查询系统各个属性字符集-🔥"}},[s._v("#")]),s._v(" 查询系统各个属性字符集 🔥")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> show variables like '%character%';\n+------------------------+------------------------------+\n|Variable_name           |Value                         |\n+------------------------+------------------------------+\n|character_set_client    |utf8mb4                       |\n|character_set_connection|utf8mb4                       |\n|character_set_database  |utf8mb4                       |\n|character_set_filesystem|binary                        |\n|character_set_results   |utf8mb4                       |\n|character_set_server    |utf8mb4                       |\n|character_set_system    |utf8                          |\n|character_sets_dir      |/usr/share/mysql-8.0/charsets/|\n+------------------------+------------------------------+\n8 rows in set (0.00 sec)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v("上面的代码显示是绝对可以保证不乱码。但是一旦遇到如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> show variables like '%character%';\n+------------------------+------------------------------+\n|Variable_name           |Value                         |\n+------------------------+------------------------------+\n|character_set_client    |gbk                           |\n|character_set_connection|gbk                           |\n|character_set_database  |utf8mb4                       |\n|character_set_filesystem|binary                        |\n|character_set_results   |gbk                           |\n|character_set_server    |utf8mb4                       |\n|character_set_system    |utf8                          |\n|character_sets_dir      |/usr/share/mysql-8.0/charsets/|\n+------------------------+------------------------------+\n8 rows in set (0.00 sec)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("ul",[e("li",[s._v("客户端即 character_set_client 是 gbk编码")]),s._v(" "),e("li",[s._v("服务端即 character_set_server 是 utf8mb4")]),s._v(" "),e("li",[s._v("返回结果即 character_set_results gbk")]),s._v(" "),e("li",[s._v("中间连接器即 character_set_connection 是 gbk。这个"),e("strong",[s._v("用来统一转换客户端和服务端的字节编码")]),s._v("，进行"),e("strong",[s._v("比较")]),s._v("（collation_connection）")])]),s._v(" "),e("p",[e("strong",[s._v("只要 character_set_client 和 character_set_results 一致，就基本不会乱码")]),s._v("。整个流程如下：")]),s._v(" "),e("p",[s._v("客户端 insert “男哥”，此时是 gbk，到达连接器时 转为 服务端需要的 utf8mb4 并存储。连接器只要不是选择特别小的字符集（如 ASCII 码）即可保证不会丢失数据，也会保证转换正常。")]),s._v(" "),e("p",[s._v("客户端查询时，需要返回的是 gbk 和 客户端编码（cmd默认为gbk）一致，所以不会乱码。")]),s._v(" "),e("h4",{attrs:{id:"修改字符集、比较规则-🔥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改字符集、比较规则-🔥"}},[s._v("#")]),s._v(" 修改字符集、比较规则 🔥")]),s._v(" "),e("p",[s._v("需要修改字符集只需执行如下操作即可")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> set character_set_client=gbk\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("若是要同时修改则执行如下操作")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mysql> set names gbk;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("修改比较规则略。还是推荐图形化修改吧")]),s._v(" "),e("h4",{attrs:{id:"创建表时需要填写的表字符集"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建表时需要填写的表字符集"}},[s._v("#")]),s._v(" 创建表时需要填写的表字符集")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("demo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("无标题"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARACTER")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" utf8mb4 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COLLATE")]),s._v(" utf8mb4_general_ci "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("`")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("InnoDB")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARACTER")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8mb4 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COLLATE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8mb4_general_ci ROW_FORMAT "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Dynamic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);