<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Servlet | conanan&#39;s blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/img/favicon.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.03260d1f.css" as="style"><link rel="preload" href="/assets/js/app.ac5e3ef4.js" as="script"><link rel="preload" href="/assets/js/2.d960b235.js" as="script"><link rel="preload" href="/assets/js/119.ede5fffc.js" as="script"><link rel="prefetch" href="/assets/js/10.949143aa.js"><link rel="prefetch" href="/assets/js/100.122fb3a2.js"><link rel="prefetch" href="/assets/js/101.88060c8d.js"><link rel="prefetch" href="/assets/js/102.06832b28.js"><link rel="prefetch" href="/assets/js/103.a0c17aef.js"><link rel="prefetch" href="/assets/js/104.b38ef641.js"><link rel="prefetch" href="/assets/js/105.603033e4.js"><link rel="prefetch" href="/assets/js/106.6b288074.js"><link rel="prefetch" href="/assets/js/107.1ffec4c0.js"><link rel="prefetch" href="/assets/js/108.c7b79afa.js"><link rel="prefetch" href="/assets/js/109.dda9fbee.js"><link rel="prefetch" href="/assets/js/11.326a1f58.js"><link rel="prefetch" href="/assets/js/110.920cbe6e.js"><link rel="prefetch" href="/assets/js/111.45bfe7f2.js"><link rel="prefetch" href="/assets/js/112.1f11c570.js"><link rel="prefetch" href="/assets/js/113.fab1cc04.js"><link rel="prefetch" href="/assets/js/114.21ea4ed6.js"><link rel="prefetch" href="/assets/js/115.96f65264.js"><link rel="prefetch" href="/assets/js/116.b324c49b.js"><link rel="prefetch" href="/assets/js/117.dc4d308c.js"><link rel="prefetch" href="/assets/js/118.8f152d6d.js"><link rel="prefetch" href="/assets/js/12.23122444.js"><link rel="prefetch" href="/assets/js/120.044161d7.js"><link rel="prefetch" href="/assets/js/121.453c745a.js"><link rel="prefetch" href="/assets/js/122.e3b088eb.js"><link rel="prefetch" href="/assets/js/123.d5a90d16.js"><link rel="prefetch" href="/assets/js/124.7731d89c.js"><link rel="prefetch" href="/assets/js/125.e64126c4.js"><link rel="prefetch" href="/assets/js/126.e46361b1.js"><link rel="prefetch" href="/assets/js/127.067ae046.js"><link rel="prefetch" href="/assets/js/128.59df2a2f.js"><link rel="prefetch" href="/assets/js/129.a2b82230.js"><link rel="prefetch" href="/assets/js/13.6780e0cd.js"><link rel="prefetch" href="/assets/js/130.c20833b9.js"><link rel="prefetch" href="/assets/js/131.da020742.js"><link rel="prefetch" href="/assets/js/132.e20ac455.js"><link rel="prefetch" href="/assets/js/133.f114b097.js"><link rel="prefetch" href="/assets/js/134.49de9e80.js"><link rel="prefetch" href="/assets/js/135.1a24633f.js"><link rel="prefetch" href="/assets/js/136.d5853212.js"><link rel="prefetch" href="/assets/js/137.3a1020dd.js"><link rel="prefetch" href="/assets/js/138.f194f86d.js"><link rel="prefetch" href="/assets/js/139.bf8c1ca0.js"><link rel="prefetch" href="/assets/js/14.08edf279.js"><link rel="prefetch" href="/assets/js/140.c800f5e0.js"><link rel="prefetch" href="/assets/js/141.47afa8e4.js"><link rel="prefetch" href="/assets/js/142.fda2db61.js"><link rel="prefetch" href="/assets/js/143.0224a2e5.js"><link rel="prefetch" href="/assets/js/144.4126fe8d.js"><link rel="prefetch" href="/assets/js/145.9fe0839a.js"><link rel="prefetch" href="/assets/js/146.89a9e1b2.js"><link rel="prefetch" href="/assets/js/147.56419b8e.js"><link rel="prefetch" href="/assets/js/148.03d2b50f.js"><link rel="prefetch" href="/assets/js/149.c1331b6d.js"><link rel="prefetch" href="/assets/js/15.f198e5b9.js"><link rel="prefetch" href="/assets/js/16.00e51c93.js"><link rel="prefetch" href="/assets/js/17.291d3ebc.js"><link rel="prefetch" href="/assets/js/18.017a098e.js"><link rel="prefetch" href="/assets/js/19.61ae84a4.js"><link rel="prefetch" href="/assets/js/20.2fed9841.js"><link rel="prefetch" href="/assets/js/21.0540e3f5.js"><link rel="prefetch" href="/assets/js/22.65f1eb05.js"><link rel="prefetch" href="/assets/js/23.fd9e2f2e.js"><link rel="prefetch" href="/assets/js/24.199ad75b.js"><link rel="prefetch" href="/assets/js/25.005a23bb.js"><link rel="prefetch" href="/assets/js/26.46587fdd.js"><link rel="prefetch" href="/assets/js/27.eaf61373.js"><link rel="prefetch" href="/assets/js/28.12bcc1aa.js"><link rel="prefetch" href="/assets/js/29.2ee78c15.js"><link rel="prefetch" href="/assets/js/3.aae4de15.js"><link rel="prefetch" href="/assets/js/30.5a13fad2.js"><link rel="prefetch" href="/assets/js/31.d559ae93.js"><link rel="prefetch" href="/assets/js/32.d5a38545.js"><link rel="prefetch" href="/assets/js/33.484dfc49.js"><link rel="prefetch" href="/assets/js/34.1a006a06.js"><link rel="prefetch" href="/assets/js/35.12b84d1e.js"><link rel="prefetch" href="/assets/js/36.b2cd4408.js"><link rel="prefetch" href="/assets/js/37.a5859cb8.js"><link rel="prefetch" href="/assets/js/38.96209f1d.js"><link rel="prefetch" href="/assets/js/39.71d70a82.js"><link rel="prefetch" href="/assets/js/4.0e4cf147.js"><link rel="prefetch" href="/assets/js/40.a59b859c.js"><link rel="prefetch" href="/assets/js/41.ebb72a6a.js"><link rel="prefetch" href="/assets/js/42.71f99aa2.js"><link rel="prefetch" href="/assets/js/43.092ff2c9.js"><link rel="prefetch" href="/assets/js/44.d70e216f.js"><link rel="prefetch" href="/assets/js/45.afb733d1.js"><link rel="prefetch" href="/assets/js/46.86c421f9.js"><link rel="prefetch" href="/assets/js/47.6d337ef6.js"><link rel="prefetch" href="/assets/js/48.157e1f1c.js"><link rel="prefetch" href="/assets/js/49.1aed4add.js"><link rel="prefetch" href="/assets/js/5.831f36ca.js"><link rel="prefetch" href="/assets/js/50.b495cbac.js"><link rel="prefetch" href="/assets/js/51.f4a8b763.js"><link rel="prefetch" href="/assets/js/52.beec293d.js"><link rel="prefetch" href="/assets/js/53.2ac4d785.js"><link rel="prefetch" href="/assets/js/54.342112cf.js"><link rel="prefetch" href="/assets/js/55.61e2bfb6.js"><link rel="prefetch" href="/assets/js/56.fa782548.js"><link rel="prefetch" href="/assets/js/57.41bc249e.js"><link rel="prefetch" href="/assets/js/58.c1d5fafb.js"><link rel="prefetch" href="/assets/js/59.4297a34f.js"><link rel="prefetch" href="/assets/js/6.54e4e793.js"><link rel="prefetch" href="/assets/js/60.634948c3.js"><link rel="prefetch" href="/assets/js/61.de4327e7.js"><link rel="prefetch" href="/assets/js/62.c6902476.js"><link rel="prefetch" href="/assets/js/63.737a0e11.js"><link rel="prefetch" href="/assets/js/64.cbe1b041.js"><link rel="prefetch" href="/assets/js/65.2df8f108.js"><link rel="prefetch" href="/assets/js/66.ee7de747.js"><link rel="prefetch" href="/assets/js/67.88edee59.js"><link rel="prefetch" href="/assets/js/68.c29f5efe.js"><link rel="prefetch" href="/assets/js/69.2fedc1f9.js"><link rel="prefetch" href="/assets/js/7.1c00f39e.js"><link rel="prefetch" href="/assets/js/70.0fe4782b.js"><link rel="prefetch" href="/assets/js/71.6c22c273.js"><link rel="prefetch" href="/assets/js/72.1fc7ddbd.js"><link rel="prefetch" href="/assets/js/73.25cb42eb.js"><link rel="prefetch" href="/assets/js/74.e922e1cc.js"><link rel="prefetch" href="/assets/js/75.f48393b6.js"><link rel="prefetch" href="/assets/js/76.72e96818.js"><link rel="prefetch" href="/assets/js/77.3df4edcb.js"><link rel="prefetch" href="/assets/js/78.73c6a652.js"><link rel="prefetch" href="/assets/js/79.22ba589c.js"><link rel="prefetch" href="/assets/js/8.b5f907d4.js"><link rel="prefetch" href="/assets/js/80.2d070db4.js"><link rel="prefetch" href="/assets/js/81.c0bc2539.js"><link rel="prefetch" href="/assets/js/82.4c6a47fa.js"><link rel="prefetch" href="/assets/js/83.a43f597f.js"><link rel="prefetch" href="/assets/js/84.8ce525d0.js"><link rel="prefetch" href="/assets/js/85.6b21aae0.js"><link rel="prefetch" href="/assets/js/86.f6ebabd9.js"><link rel="prefetch" href="/assets/js/87.9acaeb0d.js"><link rel="prefetch" href="/assets/js/88.99cdf592.js"><link rel="prefetch" href="/assets/js/89.58f63450.js"><link rel="prefetch" href="/assets/js/9.053d267f.js"><link rel="prefetch" href="/assets/js/90.1d59f40c.js"><link rel="prefetch" href="/assets/js/91.e8b2a5cd.js"><link rel="prefetch" href="/assets/js/92.b92bba74.js"><link rel="prefetch" href="/assets/js/93.688cad95.js"><link rel="prefetch" href="/assets/js/94.2c11a588.js"><link rel="prefetch" href="/assets/js/95.aa37d1df.js"><link rel="prefetch" href="/assets/js/96.fffa0e6e.js"><link rel="prefetch" href="/assets/js/97.04e9be9f.js"><link rel="prefetch" href="/assets/js/98.2672abca.js"><link rel="prefetch" href="/assets/js/99.c8de1c63.js">
    <link rel="stylesheet" href="/assets/css/0.styles.03260d1f.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/EB-logo.png" alt="conanan's blog" class="logo"> <span class="site-name can-hide">conanan's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/pages/4b56bd/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4b56bd/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/pages/724936/" aria-current="page" class="nav-link router-link-exact-active router-link-active">Java Web</a></li><li class="dropdown-item"><h4>工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/b18d09/" class="nav-link">Maven</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DataBase" class="dropdown-title"><a href="/pages/74cdda/" class="link-title">DataBase</a> <span class="title" style="display:none;">DataBase</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/74cdda/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/pages/4e9f47/" class="nav-link">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tool" class="dropdown-title"><a href="/pages/89d1e7/" class="link-title">Tool</a> <span class="title" style="display:none;">Tool</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/89d1e7/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/pages/2029ba/" class="nav-link">Vim</a></li><li class="dropdown-item"><!----> <a href="/pages/2029ba/" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/pages/f2d5fb/" class="nav-link">Docker</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200103123203.jpg"> <div class="blogger-info"><h3>Evan Xu</h3> <span>前端界的小学生</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/pages/4b56bd/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/4b56bd/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/pages/724936/" aria-current="page" class="nav-link router-link-exact-active router-link-active">Java Web</a></li><li class="dropdown-item"><h4>工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/b18d09/" class="nav-link">Maven</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DataBase" class="dropdown-title"><a href="/pages/74cdda/" class="link-title">DataBase</a> <span class="title" style="display:none;">DataBase</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/74cdda/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/pages/4e9f47/" class="nav-link">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tool" class="dropdown-title"><a href="/pages/89d1e7/" class="link-title">Tool</a> <span class="title" style="display:none;">Tool</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/89d1e7/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/pages/2029ba/" class="nav-link">Vim</a></li><li class="dropdown-item"><!----> <a href="/pages/2029ba/" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/pages/f2d5fb/" class="nav-link">Docker</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Jakarta EE</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/724936/" aria-current="page" class="active sidebar-link">Servlet</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/724936/#实现-servlet-的方式" class="sidebar-link">实现 Servlet 的方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/724936/#实现-servlet-接口" class="sidebar-link">实现 Servlet 接口</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#继承-genericservlet-抽象类" class="sidebar-link">继承 GenericServlet 抽象类</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#继承-httpservlet-抽象类" class="sidebar-link">继承 HttpServlet 抽象类</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/724936/#servletconfig" class="sidebar-link">ServletConfig</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#servletcontext" class="sidebar-link">ServletContext</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#servlet3-0" class="sidebar-link">Servlet3.0</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#request" class="sidebar-link">Request</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/724936/#request继承体系" class="sidebar-link">Request继承体系</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#获取请求消息数据" class="sidebar-link">获取请求消息数据</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#获取请求参数通用方式" class="sidebar-link">获取请求参数通用方式</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#请求转发" class="sidebar-link">请求转发</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#request域" class="sidebar-link">request域</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#用户登录案例需求" class="sidebar-link">用户登录案例需求</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/724936/#response" class="sidebar-link">Response</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/724936/#response继承体系" class="sidebar-link">Response继承体系</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#设置响应行中状态码" class="sidebar-link">设置响应行中状态码</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#设置响应头" class="sidebar-link">设置响应头</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#设置响应体" class="sidebar-link">设置响应体</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#重定向" class="sidebar-link">重定向</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#路径的写法" class="sidebar-link">路径的写法</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#输出字符数据到浏览器-乱码" class="sidebar-link">输出字符数据到浏览器—乱码</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#输出字节数据到浏览器" class="sidebar-link">输出字节数据到浏览器</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#验证码案例" class="sidebar-link">验证码案例</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/724936/#url编码" class="sidebar-link">URL编码</a></li><li class="sidebar-sub-header"><a href="/pages/724936/#文件下载案例" class="sidebar-link">文件下载案例</a></li></ul></li><li><a href="/pages/889cae/" class="sidebar-link">Servlet3</a></li><li><a href="/pages/cf018b/" class="sidebar-link">Filter</a></li><li><a href="/pages/625d5c/" class="sidebar-link">Listener</a></li><li><a href="/pages/f62788/" class="sidebar-link">JSP</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tomcat</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringMVC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringBoot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringDataJPA</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/pages/927e76/" class="sidebar-link">Test</a></li><li><a href="/pages/2ffe27/" class="sidebar-link">Shiro</a></li><li><a href="/pages/16f81e/" class="sidebar-link">Thymeleaf</a></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/categories/?category=Java%20Web" title="分类" data-v-1cd794fe>Java Web</a></li> <li data-v-1cd794fe><a href="/categories/?category=Jakarta%20EE" title="分类" data-v-1cd794fe>Jakarta EE</a></li> <!----></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/apple54whn" target="_blank" title="作者" class="beLink" data-v-1cd794fe>conanan</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2021-06-21</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          Servlet
        </h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><h1 id="servlet"><a href="#servlet" class="header-anchor">#</a> Servlet</h1> <p>Servlet（server applet）是运行在服务器端的小程序。是 Java EE 规范之一。是 <strong>JavaWeb 三大组件之一</strong>（Servlet、Filter、Listener），可以<strong>接收请求数据、处理请求、完成响应</strong>。</p> <p>Servlet 实质就是一个<strong>接口</strong>，定义了<strong>Java 类能被</strong>浏览器访问到（<strong>或者说被 Tomcat 等 Servlet 容器识别</strong>）的<strong>规则</strong>。那么浏览器如何访问Servlet？</p> <p>给 Servlet 指定一个<strong>路径</strong>，浏览器通过访问路径来访问，一般路径配置在<strong>web.xml</strong>中或直接<strong>注解</strong>（Servlet 3 后）</p> <h2 id="实现-servlet-的方式"><a href="#实现-servlet-的方式" class="header-anchor">#</a> 实现 Servlet 的方式</h2> <ol><li><p>实现<code>javax.servlet.Servlet</code>接口</p></li> <li><p>继承<code>javax.servlet.GenericServlet</code>抽象类</p></li> <li><p>继承<code>javax.servlet.http.HttpServlet</code>抽象类</p> <p>通常我们会去继承<code>HttpServlet</code>类来完成我们的Servlet，但学习还要从<code>javax.servlet.Servlet</code>接口开始</p></li></ol> <h3 id="实现-servlet-接口"><a href="#实现-servlet-接口" class="header-anchor">#</a> 实现 Servlet 接口</h3> <h4 id="实现-javax-servlet-servlet-接口"><a href="#实现-javax-servlet-servlet-接口" class="header-anchor">#</a> 实现 javax.servlet.Servlet 接口</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//初始化，在Servlet对象创建后马上执行，只执行一次</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">ServletConfig</span> servletConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;init...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//获取Servlet配置信息,</span>
<span class="token keyword">public</span> <span class="token class-name">ServletConfig</span> <span class="token function">getServletConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//服务，每次处理请求会被调用</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">service</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> servletRequest<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> servletResponse<span class="token punctuation">)</span> 
		<span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span>  <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;service...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		servletResponse<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;hello servlet.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//获取Servlet信息，如版本，作者等。一般不会去实现</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getServletInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//销毁，服务器正常关闭，在Servlet被销毁之前调用，只会被调用一次</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;destroy...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="配置web-xml"><a href="#配置web-xml" class="header-anchor">#</a> 配置web.xml</h4> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>//相同代号
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>cn.itcast01.AServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>//要访问的类，全类名
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>//相同代号
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/MyServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>//设置URL
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--  访问时：http://localhost:8080/MyServlet ，前提是IDEA中Application context配置的是“/” --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="执行原理"><a href="#执行原理" class="header-anchor">#</a> 执行原理</h4> <ol><li><p>当Tomcat服务器接受到客户端浏览器的请求后，会解析请求URL路径，获取访问的Servlet的资源路径</p></li> <li><p>查找web.xml文件，是否有对应的<code>&lt;url-pattern&gt;</code>标签体内容。</p></li> <li><p>如果有，则通过<code>&lt;servlet-name&gt;</code>找到对应的<code>&lt;servlet-class&gt;</code>全类名</p></li> <li><p>Tomcat会将字节码文件加载进内存，并且通过反射创建其对象，调用其方法</p> <p>即Servlet<strong>类</strong>由我们来写，但<strong>对象由服务器来创建</strong>，并且<strong>由服务器来调用相应的方法</strong></p></li></ol> <h4 id="生命周期方法"><a href="#生命周期方法" class="header-anchor">#</a> 生命周期方法</h4> <ul><li><p><code>void init(ServletConfig)</code>：<strong>创建Servlet对象后</strong>立即执行初始化方法（只1次）；</p> <ul><li><p>Servlet的<code>init</code>方法只执行一次，说明<strong>一个Servlet在内存中只存在一个对象(单例)</strong></p> <ul><li>多用户同时访问可能存在线程安全问题</li> <li>解决：尽量不要在Servlet中定义成员变量。即使定义了成员变量，也不要对其修改值</li></ul></li> <li><p>Servlet什么时候被创建？</p> <ol><li><strong>默认</strong>情况下，<strong>第一次被访问时</strong>，Servlet被创建。即<code>&lt;load-on-startup&gt;</code>的值默认为负数。</li> <li>可以<strong>配置</strong>执行Servlet的<strong>创建时机</strong>，在注解中配置<code>loadOnStartup</code>，给出一个<strong>非负整数</strong>即可，数字<strong>越小优先级越高</strong>。</li></ol></li></ul></li> <li><p><code>void service(ServletRequest request, ServletResponse response)</code>：<strong>每次处理请求</strong>时都会被调用；</p></li> <li><p><code>void destroy()</code>：服务器<strong>正常关闭</strong>，<strong>销毁Servlet对象前</strong>执行释放资源的方法（只1次）；</p></li></ul> <h3 id="继承-genericservlet-抽象类"><a href="#继承-genericservlet-抽象类" class="header-anchor">#</a> 继承 GenericServlet 抽象类</h3> <h4 id="继承javax-servlet-genericservlet抽象类"><a href="#继承javax-servlet-genericservlet抽象类" class="header-anchor">#</a> 继承javax.servlet.GenericServlet抽象类</h4> <ul><li><p><code>GenericServlet</code>是<code>Servlet</code>接口的<strong>实现类</strong>，但它是一个<strong>抽象类</strong>，它<strong>唯一的抽象方法就是<code>service()</code>方法</strong>，它将Servlet接口中的其他4个方法做了空实现。</p></li> <li><p>GenericServlet<strong>实现了ServletConfig接口</strong>（4个方法）</p></li> <li><p>GenericServlet<strong>添加了<code>init()</code>方法</strong>，该方法会<strong>被<code>init(ServletConfig)</code>方法调用</strong></p> <p>如果希望对Servlet进行初始化，那么<strong>应该重写<code>init()</code>方法</strong>，而不是<code>init(ServletConfig)</code>方法</p></li></ul> <h3 id="继承-httpservlet-抽象类"><a href="#继承-httpservlet-抽象类" class="header-anchor">#</a> 继承 HttpServlet 抽象类</h3> <h4 id="继承javax-servlet-http-httpservlet抽象类"><a href="#继承javax-servlet-http-httpservlet抽象类" class="header-anchor">#</a> 继承javax.servlet.http.HttpServlet抽象类</h4> <p><code>HttpServlet</code>是<code>GenericServlet</code>接口的实现类，但它也是一个<strong>抽象类</strong>。对HTTP协议的一种封装，简化操作</p> <h4 id="httpservlet处理请求顺序"><a href="#httpservlet处理请求顺序" class="header-anchor">#</a> HttpServlet处理请求顺序</h4> <ol><li>Tomcat<strong>调用HttpServlet继承的</strong>生命周期方法<code>service(ServletRequest sr, ServletResponse srr)</code>对参数进行<strong>强转</strong>为HTTP协议相关的参数类型</li> <li>然后<strong>调用HttpServlet本类的</strong><code>service(HttpServletRequest sr, HttpServletResponse srr)</code>方法</li> <li>获取请求方法，<strong>根据请求方式</strong>来调用<code>doGet()</code>或<code>doPost()</code>或其他，需自己<strong>重写</strong>，否则调用到该方法时返回<code>405</code></li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//注解的方式直接配置web.xml</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">&quot;/ServletAuto&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletAuto</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> 
     <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span><span class="token class-name">IOException</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> 
        <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;hello auto&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="servletconfig"><a href="#servletconfig" class="header-anchor">#</a> ServletConfig</h2> <ul><li><p>ServletConfig接口是Servlet中的<code>init()</code>方法的参数类型，服务器会在调用<code>init()</code>方法时传递ServletConfig对象给<code>init()</code></p> <p><strong>ServletConfig对象封装</strong>了Servlet在<code>web.xml</code>中的<strong>配置信息</strong>，它对应<code>&lt;servlet&gt;</code>元素</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>daihao1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>cn.itcast01.AServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>zhangsan<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>daihao1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/Aservlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p>API如下：</p> <ul><li>String <strong>getInitParameter</strong>(String name)：获取<strong>初始化参数</strong></li> <li>Enumeration <strong>getInitParameterNames</strong>()：获取<strong>所有初始化参数的名称</strong></li> <li>ServletContext <strong>getServletContext</strong>()：<strong>获取ServletContext对象</strong>，这个对象稍后介绍</li> <li>String getServletName()：获取Servlet配置名，即<code>&lt;servlet-name&gt;</code>的值；不常用</li></ul></li></ul> <h2 id="servletcontext"><a href="#servletcontext" class="header-anchor">#</a> ServletContext</h2> <ul><li><p>Java Web四大域对象（前三个为Servlet三大域对象）：</p> <ul><li>application(当前web应用)：<strong>ServletContext</strong></li> <li>session(一次会话)：<strong>HttpSession</strong></li> <li>request(一次请求)：<strong>ServletRequest</strong></li> <li>page(jsp有效)：<strong>PageContext</strong></li></ul></li> <li><p>ServletContext：<strong>代表整个web应用</strong>，可以<strong>和程序的容器</strong>(服务器)来<strong>通信</strong>，服务器会为每个应用/WEB站点创建一个ServletContext对象。<strong>创建在服务器启动后</strong>完成，<strong>销毁在服务器正常吃关闭前</strong>完成。<strong>一个项目只有一个ServletContext对象</strong>，我们可以在N多个Servlet中来获取这个唯一的对象，以传递数据</p></li> <li><p>获取</p> <ul><li>通过**<code>HttpServlet</code>**或<code>GenericServlet</code>获取：<code>this.getServletContext();</code></li> <li>通过**<code>request</code>**对象获取：<code>request.getServletContext();</code></li></ul></li> <li><p>功能：</p> <ol><li><p><strong>获取MIME类型</strong>：<code>String getMimeType(String file)</code></p> <ul><li>MIME类型：在互联网通信过程中定义的一种文件数据类型。格式：<code>大类型/小类型</code>，<code>text/html</code>、<code>image/jpeg</code></li></ul></li> <li><p><strong>域对象</strong>：<strong>共享数据</strong>。ServletContext对象范围是<strong>所有用户所有请求的数据</strong></p> <ul><li><code>getAttribute(String name)</code>：<strong>获取</strong>域对象中的数据</li> <li><code>setAttribute(String name,Object value)</code>：<strong>存储</strong>一个域属性</li> <li><code>removeAttribute(String name)</code>：<strong>移除</strong>域对象中的域属性，name指定域属性不存在时不变化</li> <li><code>Enumeration getAttributeNames()</code>：获取所有域属性的名称`</li></ul></li> <li><p>🔥获取<strong>文件的真实</strong>(服务器)<strong>路径</strong>：<code>String getRealPath(String path)</code>，即当前Web应用下的资源路径，例子如下：</p> <ul><li>web目录下资源访问：<code>getRealPath(&quot;/b.txt&quot;)</code></li> <li>WEB-INF目录下的资源访问：<code>getRealPath(&quot;/WEB-INF/c.txt&quot;)</code></li> <li>src目录下的资源访问：<code>getRealPath(&quot;/WEB-INF/classes/a.txt&quot;)</code>，由于src中的文件最终都会放在classes下</li></ul></li></ol></li> <li><p><strong>获取资源相关方法对比</strong></p> <ul><li><p><strong>获取真实(服务器)路径：<code>getRealPath(String path)</code></strong>，可查找范围最广泛</p></li> <li><p><strong>通过类加载器获取资源</strong>：<code>getResourceAsStream(String path);</code>，根据classes或src来判断路径</p> <ul><li><code>/WEB-INF/classes</code>（src中的文件最终都会放在classes下）和<code>/WEB-INF/lib</code>每个<strong>jar</strong>包！</li></ul></li> <li><p><strong>Class类获取资源</strong>：<code>InputStream getResourceAsStream(String path)</code>，</p> <ul><li>路径以<code>/</code>开头，相对classes路径；路径不以<code>/</code>开头，相对当前class文件路径</li></ul></li></ul></li> <li><p>网站访问量</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">ServletContext</span> servletContext <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Integer</span> count <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> servletContext<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    servletContext<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
    servletContext<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">,</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
count <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span> servletContext<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;invite:&quot;</span><span class="token operator">+</span>count<span class="token operator">+</span><span class="token string">&quot;times&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>获取应用/WEB站点初始化参数（getInitParameter()）</p> <ul><li>Servlet也可以获取初始化参数，但它是局部的参数(一个Servlet只能获取自己的初始化参数，不能获取别人的，即初始化参数只为一个Servlet准备)</li> <li>可以配置<strong>应用的初始化参数</strong>，为所有Servlet而用！这需要使用ServletContext才能使用</li> <li>可以使用ServletContext来获取在web.xml文件中配置的<strong>应用初始化参数</strong>！注意，应用初始化参数与Servlet初始化参数不同（Spring中有使用）</li></ul></li></ul> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-param</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>zhangsan<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-param</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">ServletContext</span> servletContext <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> msg <span class="token operator">=</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>servletContext<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="servlet3-0"><a href="#servlet3-0" class="header-anchor">#</a> Servlet3.0</h2> <blockquote><p>JavaEE 6.0 版本及之后的新版本都支持</p></blockquote> <ul><li><p>好处：</p> <ul><li>支持<strong>注解配置</strong>。可以<strong>不需要web.xml了</strong>。</li></ul></li> <li><p>步骤：</p> <ol><li><p>创建JavaEE项目，选择Servlet的版本3.0以上，可以不创建web.xml</p></li> <li><p>定义一个类，实现Servlet接口并重写方法</p></li> <li><p>在类上使用<code>@WebServlet</code>注解，进行配置。<code>@WebServlet(&quot;资源路径&quot;)</code>，可以省略<code>value</code>或<code>urlPatterns</code></p> <div class="language-JAVA line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">WebServlet</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span><span class="token comment">//相当于&lt;Servlet-name&gt;</span>

    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//代表urlPatterns()属性配置</span>

    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">urlPatterns</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//相当于&lt;url-pattern&gt;</span>

    <span class="token keyword">int</span> <span class="token function">loadOnStartup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//相当于&lt;load-on-startup&gt;</span>
    <span class="token class-name">WebInitParam</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">initParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> <span class="token function">asyncSupported</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">smallIcon</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">largeIcon</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">description</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">displayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ol></li> <li><p><strong>urlpartten</strong>：<strong>Servlet访问路径</strong>，用<strong>value</strong>替代了，所以可以不写</p> <ul><li><p><strong>一个Servlet</strong>可以定义<strong>多个访问路径</strong> ： <code>@WebServlet({&quot;/d4&quot;,&quot;/dd4&quot;,&quot;/ddd4&quot;})</code></p></li> <li><p><strong>路径定义规则</strong>：</p> <ul><li><p><strong><code>/</code></strong>：<strong>仅不会匹配.jsp</strong>，需要<strong>释放静态资源</strong>，（查看Tomcat中web.xml中介绍）</p> <ul><li>它的<strong>优先级最低</strong>，如果一个请求没有人处理，会执行该DefaultServlet！其实我们在访问index.html时也是在执行该DefaultServlet。</li> <li><strong>不会重写其他Servlet</strong>：即不匹配JSP是因为任何URL后缀为jsp的访问，都会执行名为jsp的Servlet</li></ul></li> <li><p><strong><code>/*</code></strong>：带通配符（匹配所有<strong>路径型和后缀型</strong>URL，包括.html、.jsp等），<strong>不建议使用</strong>，<strong>除非用在Filter中</strong></p> <ul><li><strong>会重写其他Servlet</strong>：在访问jsp时会报404</li></ul></li> <li><p><code>/xxx</code>：路径匹配</p></li> <li><p><code>/xxx/xxx</code>：多层路径，称之为目录结构</p></li> <li><p><code>*.do</code>：扩展名匹配，*前不能有/，否则报错</p></li></ul></li></ul></li></ul> <h2 id="request"><a href="#request" class="header-anchor">#</a> Request</h2> <h3 id="request继承体系"><a href="#request继承体系" class="header-anchor">#</a> Request继承体系</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>ServletRequest 接口
      |
     继承
      |
HttpServletRequest 接口
      |
     实现
      |
org.apache.catalina.connector.RequestFacade 类，由 Tomcat 提供，若是其他容器则不一样
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>以上体系Response也适用</p> <h3 id="获取请求消息数据"><a href="#获取请求消息数据" class="header-anchor">#</a> 获取请求消息数据</h3> <ul><li><p>获取<strong>请求行</strong>数据：如<code>GET /day14/login?name=zhangsan HTTP/1.1</code></p> <ul><li>获取请求方式：<code>String getMethod()</code>，如<code>GET</code> 。HttpServlet已经在内部使用了，以后用不到</li> <li>获取<strong>请求URL</strong>：<code>StringBuffer getRequestURL()</code>，如<code>http://localhost/day14/login/a.html</code>。<strong>统一资源定位符</strong></li> <li>获取<strong>请求URI</strong>：<code>String getRequestURI()</code>，如<code>/day14/login</code>。<strong>统一资源标识符</strong>，它<strong>包括URL</strong></li> <li>获取<strong>虚拟目录</strong>：<code>String getContextPath()</code>，如<code>/day14</code></li> <li>获取Servlet路径：<code>String getServletPath()</code>，如<code>/login</code></li> <li>获取get方式请求参数：<code>String getQueryString()</code>，如<code>name=zhangsan</code>，以后用不到</li> <li>获取协议及版本：<code>String getProtocol()</code>，如<code>HTTP/1.1</code></li> <li>获取客户机的<strong>IP地址</strong>：<code>String getRemoteAddr()</code></li></ul></li> <li><p>获取<strong>请求头</strong>数据</p> <ul><li>通过<strong>请求头的名称获取请求头的值</strong>：<code>String getHeader(String name)</code>，不区分大小写。如User-Agent、Referer</li> <li>获取所有的请求头名称：<code>Enumeration&lt;String&gt; getHeaderNames()</code>：</li></ul></li> <li><p>获取<strong>请求体</strong>数据（只有POST请求方式，才有请求体，在请求体中封装了POST请求的请求参数）。步骤：</p> <ol><li><p><strong>获取流对象</strong></p> <ul><li><code>BufferedReader getReader()</code>：获取<strong>字符输入流</strong>，只能操作字符数据</li> <li><code>ServletInputStream getInputStream()</code>：获取<strong>字节输入流</strong>，可以操作所有类型数据。继承了InputStream。在<strong>文件上传</strong>知识点后讲解</li></ul></li> <li><p><strong>再从流对象中拿数据</strong></p></li></ol></li></ul> <h3 id="获取请求参数通用方式"><a href="#获取请求参数通用方式" class="header-anchor">#</a> 获取<strong>请求参数通用方</strong>式</h3> <ul><li><p>获取<strong>请求参数通用方</strong>式（不论get还是post请求方式都可以使用）</p> <ul><li><p><strong><code>String getParameter(String name)</code></strong>：==根据<strong>参数名称获取参数值</strong>==    username=zs&amp;password=123</p></li> <li><p><code>String[] getParameterValues(String name)</code>：根据参数名称获取参数值的<strong>数组</strong> hobby=xx&amp;hobby=game</p></li> <li><p><strong><code>Map&lt;String,String[]&gt; getParameterMap()</code></strong>：==获取<strong>所有参数的map集合</strong>==</p></li> <li><p><code>Enumeration&lt;String&gt; getParameterNames()</code>：获取所有请求的参数名称</p></li> <li><p><strong>中文乱码问题</strong>：</p> <ul><li>GET方式：Tomcat 8及以上版本已经将get方式乱码问题解决了</li> <li>POST方式：会乱码。在获取参数前，<strong>设置request的编码<code>request.setCharacterEncoding(&quot;utf-8&quot;);</code></strong></li></ul></li> <li><p>获取的<strong>参数封装为JavaBean</strong>可以利用 Spring 或其他提供的 BeanUtils 工具类，<strong>简化数据封装</strong></p> <ul><li><p>JavaBean：标准的Java类，功能为封装数据。要求如下：</p> <ol><li><p><strong>类</strong>必须被<strong>public</strong>修饰</p></li> <li><p>必须提供<strong>公有的空参的构造器</strong></p></li> <li><p>属性一般使用private修饰</p></li> <li><p>对属性提供<strong>公共get(或is)和set方法</strong>，若只有get方法或set方法，那么这个属性是只读或只写属性！</p> <ul><li><strong>属性</strong>：<strong>setter和getter方法截取后的产物，与成员变量名无关</strong>。getName() --&gt; Name--&gt; name</li></ul></li></ol></li> <li><p>方法</p> <ul><li><p><code>setProperty(Object bean, String propName)</code></p></li> <li><p><code>getProperty(Object bean,String propName,String propValue)</code>：操作的是<strong>属性</strong></p></li> <li><p><strong><code>populate(Object obj , Map map)</code></strong>：将<strong>map</strong>集合的键值对信息，封装到对应的<strong>JavaBean</strong>对象中</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Map</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> map <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">populate</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//populate需要try...catch。spring的beanutils可能不一样</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul></li></ul></li></ul></li></ul> <h3 id="请求转发"><a href="#请求转发" class="header-anchor">#</a> 请求转发</h3> <ul><li><p><strong>请求转发</strong>：一种在服务器<strong>内部</strong>的资源跳转方式</p> <ul><li><p>步骤：</p> <ol><li><p><strong>request获取请求转发器对象</strong>：<strong><code>RequestDispatcher getRequestDispatcher(String path)</code></strong>，<strong>Servlet路径</strong></p></li> <li><p>使用RequestDispatcher对象来进行<strong>转发</strong>：<code>forward(ServletRequest request, ServletResponse response)</code></p> <ul><li><p>请求包含：<code>include(request,response)</code></p> <blockquote><p>请求转发：由下一个Servlet完成响应体！当前Servlet可以设置响应头！（<span style="font-family:monaco;color:red;font-weight:bold;">留头不留体</span>）
请求包含：由两个Servlet共同未完成响应体！（<span style="font-family:monaco;color:red;font-weight:bold;">都留</span>）</p></blockquote></li></ul></li></ol></li> <li><p>特点：</p> <ol><li>浏览器<strong>地址栏路径不发生变化</strong></li> <li>转发是<strong>一次请求一次响应</strong>，使用同一个request和response！</li> <li>只能转发到<strong>当前服务器内部资源</strong>中。</li></ol></li></ul></li></ul> <h3 id="request域"><a href="#request域" class="header-anchor">#</a> request域</h3> <ul><li><p>域对象：一个有作用范围的对象，可以在范围内共享数据</p></li> <li><p><strong>request域</strong>：代表<strong>一次请求的范围</strong>，一般用于<strong>请求转发</strong>的多个资源中<strong>共享数据</strong></p> <ul><li><p>方法：</p> <ol><li><strong><code>void setAttribute(String name,Object obj)</code></strong>：存储数据</li> <li><strong><code>Object getAttitude(String name)</code></strong>：通过键获取值</li> <li><strong><code>void removeAttribute(String name)</code></strong>：通过键移除键值对</li></ol></li></ul></li></ul> <h3 id="用户登录案例需求"><a href="#用户登录案例需求" class="header-anchor">#</a> 用户登录案例需求</h3> <ul><li><p>编写login.html登录页面：username &amp; password 两个输入框</p> <p>login.html中form表单的action路径的写法：<strong>虚拟目录+Servlet的资源路径</strong></p></li> <li><p>使用Druid数据库连接池技术,操作mysql，day14数据库中user表</p></li> <li><p>使用JdbcTemplate技术封装JDBC</p></li> <li><p>登录成功跳转到SuccessServlet展示：登录成功！用户名,欢迎您</p></li> <li><p>登录失败跳转到FailServlet展示：登录失败，用户名或密码错误</p></li></ul> <h2 id="response"><a href="#response" class="header-anchor">#</a> Response</h2> <h3 id="response继承体系"><a href="#response继承体系" class="header-anchor">#</a> Response继承体系</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code></code></pre> <div class="line-numbers-wrapper"></div></div><p><code>ServletResponse</code>           —— 接口
|	继承
<code>HttpServletResponse</code>	  —— 接口
|	实现
<code>org.apache.catalina.connector.ResponseFacade</code>  ——类  (Tomcat编写的)</p> <h3 id="设置响应行中状态码"><a href="#设置响应行中状态码" class="header-anchor">#</a> 设置响应行中状态码</h3> <ul><li><p><strong><span style="background:yellow;">setStatus(int sc)</span></strong> --&gt; <strong>设置此响应的状态码</strong>，可以用来发送302、200或者404、500等</p> <ul><li>sendError(int sc [,String msg]) --&gt; 发送错误状态码，还可以带一个错误信息！</li></ul></li></ul> <h3 id="设置响应头"><a href="#设置响应头" class="header-anchor">#</a> 设置响应头</h3> <p>头就是一个<strong>键值对</strong>！可能会存在一个头（一个名称，一个值），也可能会存在一个头（一个名称，多个值！）</p> <ul><li><p><strong><span style="background:yellow;">setHeader(String n, String val)</span></strong>：适用于<span style="background:yellow;"><strong>单值</strong></span>的响应头，例如：response.setHeader(&quot;aaa&quot;, &quot;AAA&quot;)</p> <ul><li><p>addHeader(String name, String value)：适用于多值的响应头，为每个值分别调用</p></li> <li><p><code>&lt;meta&gt;</code><strong>标签代替响应头</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html; charset=UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p><strong>Refresh案例</strong>（3秒后跳转至另一个页面）也可以理解为定时重定向</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;after 3s ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//url也可以改为www.baidu.com，若不设置这个参数，就跳转至当前页面</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Refresh&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;3,url='DServlet'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p><strong>禁用浏览器缓存</strong>(Cache-Control、pragma、expires)</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Cache-Control&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;no-cache&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Pragma&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;no-cache&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//编译指示</span>
response<span class="token punctuation">.</span><span class="token function">setDateHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Expires&quot;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//失效时间</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <h3 id="设置响应体"><a href="#设置响应体" class="header-anchor">#</a> 设置响应体</h3> <blockquote><p>response的两个流，用来向客户端发送数据（不能同时使用，否则抛<strong>IllegalStateException</strong>异常）</p></blockquote> <ul><li><strong>ServletOutputStream（字节输出流）：<code>resopnse.getOutputStream()</code></strong></li> <li><strong>PrintWriter（字符输出流，需要设置编码）：<code>response.getWriter()</code></strong>，不需要刷新缓冲区</li></ul> <h3 id="重定向"><a href="#重定向" class="header-anchor">#</a> 重定向</h3> <ul><li><p><strong>重定向</strong>：<strong>资源跳转的方式</strong></p></li> <li><p>设置<strong>状态码</strong>为302，设置<strong>响应头</strong><code>Location</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">302</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;location&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/day15/responseDemo2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>简单的重定向方法：<strong><code>response.sendRedirect()</code></strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>response<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span><span class="token string">&quot;/day15/responseDemo2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><strong>forward和redirect的区别</strong></p> <ul><li><p>转发的特点：forward</p> <ol><li><strong>地址栏路径不变</strong></li> <li>转发是<strong>一次请求</strong>，可以<strong>使用request域</strong>来共享数据</li> <li>转发只能<strong>访问当前服务器下的资源</strong></li></ol></li> <li><p>重定向的特点：redirect</p> <ol><li><strong>地址栏</strong>发生<strong>变</strong>化</li> <li>重定向是<strong>两次请求</strong>。<strong>不能使用request域</strong>来共享数据</li> <li>重定向<strong>可以访问其他站点</strong>(服务器)的资源</li></ol></li></ul></li></ul> <h3 id="路径的写法"><a href="#路径的写法" class="header-anchor">#</a> 路径的写法</h3> <ul><li><p><strong>相对路径</strong>：通过相对路径不可以确定唯一资源，以**<code>./</code>开头（或不写它）的路径**。如：<code>./index.html</code></p> <ul><li>规则：找到当前资源所属目录和目标资源所属目录之间的相对位置关系。<code>./</code>：当前目录；<code>../</code>:后退一级目录</li></ul></li> <li><p><strong>绝对路径</strong>：通过绝对路径可以确定唯一资源，以**<code>/</code>开头的路径**。如：<code>/day15/responseDemo2</code></p> <ul><li><p>规则：判断定义的路径是<strong>给谁用</strong>的？<strong>判断将来请求从哪儿发出</strong></p> <ul><li><p><strong>给客户端浏览器使用</strong>：需要<strong>加虚拟目录</strong>(项目的访问路径)，建议<strong>动态获取：<code>request.getContextPath()</code></strong></p> <ul><li><code>&lt;a&gt;</code>，<code>&lt;form&gt;</code>，<code>redirect路径</code>。。。</li></ul></li> <li><p><strong>给服务器使用</strong>：<strong>不需要加虚拟目录</strong></p> <ul><li><code>forward路径</code></li></ul></li></ul></li></ul></li></ul> <h3 id="输出字符数据到浏览器-乱码"><a href="#输出字符数据到浏览器-乱码" class="header-anchor">#</a> 输出字符数据到浏览器—乱码</h3> <p>由于浏览器默认使用 GBK 或 GB2312 或 UTF-8，而服务器获取的<strong>流</strong>默认使用 ISO8859-1（应该是使用的 Servlet 容器如 Tomcat 设置的），不支持中文。且编码解码不同，必乱码。</p> <p>可通过如下代码查到服务器获取的<strong>流</strong>的编码</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>response<span class="token punctuation">.</span><span class="token function">getCharacterEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如何解决中文乱码呢？</p> <p><strong>获取字符输出流之前</strong>设置该<strong>流的默认编码</strong>，告诉浏览器<strong>响应体使用的编码</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getCharacterEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ISO-8859-1</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getContentType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// null</span>

<span class="token comment">// response.setCharacterEncoding(&quot;UTF-8&quot;);</span>

<span class="token comment">// 设置 setContentType 后会自动设置 CharacterEncoding</span>
<span class="token comment">// response.setHeader(&quot;Content-type&quot;,&quot;text/html;charset=utf-8&quot;);// setHeader 封装后的方法如下</span>
response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/json;charset=utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 纯文本也可以设置为 text/plain;charset=utf-8</span>

<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getCharacterEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// UTF-8</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getContentType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// application/json;charset=utf-8</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="输出字节数据到浏览器"><a href="#输出字节数据到浏览器" class="header-anchor">#</a> 输出字节数据到浏览器</h3> <ul><li><code>getBytes()</code>，获取字节输出流外，其他和输出字符数据没什么区别</li></ul> <h3 id="验证码案例"><a href="#验证码案例" class="header-anchor">#</a> 验证码案例</h3> <blockquote><p>本质：图片
目的：<strong>防止恶意表单注册</strong></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//1.创建验证码图片对象</span>
<span class="token class-name">BufferedImage</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedImage</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token class-name">BufferedImage</span><span class="token punctuation">.</span>TYPE_INT_RGB<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//2.美化图片</span>
<span class="token comment">//2.1 填充背景色</span>
<span class="token class-name">Graphics</span> g <span class="token operator">=</span> image<span class="token punctuation">.</span><span class="token function">getGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//画笔对象</span>
g<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">.</span>PINK<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置画笔颜色</span>
g<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>width<span class="token punctuation">,</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//2.2画边框</span>
g<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">.</span>BLUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
g<span class="token punctuation">.</span><span class="token function">drawRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz0123456789&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//生成随机角标</span>
<span class="token class-name">Random</span> ran <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> index <span class="token operator">=</span> ran<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> ch <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//随机字符</span>
    g<span class="token punctuation">.</span><span class="token function">drawString</span><span class="token punctuation">(</span>ch<span class="token operator">+</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>width<span class="token operator">/</span><span class="token number">5</span><span class="token operator">*</span>i<span class="token punctuation">,</span>height<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//写验证码</span>
<span class="token punctuation">}</span>

<span class="token comment">//2.4画干扰线</span>
g<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">.</span>GREEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//随机生成坐标点</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> x1 <span class="token operator">=</span> ran<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> x2 <span class="token operator">=</span> ran<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> y1 <span class="token operator">=</span> ran<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> y2 <span class="token operator">=</span> ran<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
    g<span class="token punctuation">.</span><span class="token function">drawLine</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//3.将图片输出到页面展示</span>
<span class="token class-name">ImageIO</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span><span class="token string">&quot;jpg&quot;</span><span class="token punctuation">,</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//点击图片更换下一张</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;verifyCode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//加时间戳的毫秒值</span>
    <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;/day15/checkCodeServlet?&quot;</span> <span class="token operator">+</span> date<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="url编码"><a href="#url编码" class="header-anchor">#</a> URL编码</h2> <ul><li><p>表单的类型：Content-Type: application/x-www-form-urlencoded，就是把中文转换成%后面跟两位的16进制</p> <p>为什么要用它：在客户端和服务器之间传递中文时需要把它转换成网络适合的方式</p></li> <li><p><strong>它不是字符编码</strong>，它是用来在客户端与服务器之间传递参数用的一种方式</p></li> <li><p>URL编码需要先指定一种字符编码，把<strong>字符串解码后，得到byte[]，然后把小于0的字节+256，再转换成16进制。前面再添加一个%</strong></p></li> <li><p><strong>POST</strong>请求默认就使用URL编码！tomcat会自动使用URL解码</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token class-name">URLEncoder</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//URL编码：</span>
<span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token class-name">URLDecoder</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//URL解码：</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>最后我们需要把链接中的中文参数，使用url来编码！学了jsp就可以</p></li></ul> <h2 id="文件下载案例"><a href="#文件下载案例" class="header-anchor">#</a> 文件下载案例</h2> <ul><li><p>文件下载需求：</p> <ol><li>页面显示超链接</li> <li>点击超链接后弹出下载提示框</li> <li>完成图片文件下载</li></ol></li> <li><p>分析：</p> <ol><li>超链接指向的资源如果能够被浏览器解析，则在浏览器中展示，如果不能解析，则弹出下载提示框。不满足需求</li> <li>要求任何资源都必须弹出下载提示框</li> <li>使用响应头设置资源的打开方式：<code>content-disposition:attachment;filename=xxx</code></li></ol></li> <li><p>步骤：</p> <ol><li>定义页面，编辑超链接href属性，指向Servlet，<strong>传递资源名称<code>?filename=xxx</code></strong></li> <li>定义Servlet
3. 获取文件名称
4. 使用字节输入流加载文件进内存
5. 指定response的响应头： <code>content-disposition:attachment;filename=xxx</code>6. 将数据写出到response输出流</li></ol></li> <li><p>中文文件名问题</p> <ul><li><p>解决思路：</p> <ol><li>获取客户端使用的浏览器版本信息</li> <li>根据不同的版本信息，设置filename的编码方式不同</li></ol></li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//1.获取请求参数，文件名称</span>
<span class="token class-name">String</span> filename <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;filename&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//2.使用字节输入流加载文件进内存</span>
<span class="token comment">//2.1找到文件服务器路径</span>
<span class="token class-name">String</span> realPath <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token string">&quot;/img/&quot;</span> <span class="token operator">+</span> filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//2.2用字节流关联</span>
<span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>realPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//3.设置response的响应头</span>
<span class="token comment">//3.1设置响应头类型：content-type</span>
<span class="token class-name">String</span> mimeType <span class="token operator">=</span> servletContext<span class="token punctuation">.</span><span class="token function">getMimeType</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取文件的mime类型</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;content-type&quot;</span><span class="token punctuation">,</span>mimeType<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//3.2设置响应头打开方式:content-disposition</span>

<span class="token comment">//解决中文文件名问题</span>
<span class="token comment">//1.获取user-agent请求头、</span>
<span class="token class-name">String</span> agent <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;user-agent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//2.使用工具类方法编码文件名即可</span>
filename <span class="token operator">=</span> <span class="token class-name">DownLoadUtils</span><span class="token punctuation">.</span><span class="token function">getFileName</span><span class="token punctuation">(</span>agent<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;content-disposition&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;attachment;filename=&quot;</span><span class="token operator">+</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//4.将输入流的数据写出到输出流中</span>
<span class="token class-name">ServletOutputStream</span> sos <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> fis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buff<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    sos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buff<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div></li></ul></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/xugaoyi/vuepress-theme-vdoing/edit/master/docs/200.Java Web/100.Jakarta EE/101.Servlet.md" target="_blank" rel="noopener noreferrer">编辑</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/06/21, 15:45:42</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/889cae/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Servlet3</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/889cae/">Servlet3</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/7fcc72/"><div>线程生命周期</div></a> <span>07-06</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/a4ef99/"><div>线程安全理论</div></a> <span>06-24</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/890a0b/"><div>并发简史</div></a> <span>06-24</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:894072666@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/xugaoyi" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2021
    <span>Evan Xu | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.ac5e3ef4.js" defer></script><script src="/assets/js/2.d960b235.js" defer></script><script src="/assets/js/119.ede5fffc.js" defer></script>
  </body>
</html>